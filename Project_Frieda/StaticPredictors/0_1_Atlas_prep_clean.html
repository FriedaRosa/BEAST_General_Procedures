<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Friederike Wölke">
<meta name="dcterms.date" content="2024-03-15">

<title>Atlas Data Prep</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="0_1_Atlas_prep_clean_files/libs/clipboard/clipboard.min.js"></script>
<script src="0_1_Atlas_prep_clean_files/libs/quarto-html/quarto.js"></script>
<script src="0_1_Atlas_prep_clean_files/libs/quarto-html/popper.min.js"></script>
<script src="0_1_Atlas_prep_clean_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="0_1_Atlas_prep_clean_files/libs/quarto-html/anchor.min.js"></script>
<link href="0_1_Atlas_prep_clean_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="0_1_Atlas_prep_clean_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="0_1_Atlas_prep_clean_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="0_1_Atlas_prep_clean_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="0_1_Atlas_prep_clean_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#predicting-temporal-change-from-static-patterns" id="toc-predicting-temporal-change-from-static-patterns" class="nav-link active" data-scroll-target="#predicting-temporal-change-from-static-patterns"><span class="header-section-number">1</span> <strong><em>Predicting temporal change from static patterns</em></strong></a></li>
  <li><a href="#libraries" id="toc-libraries" class="nav-link" data-scroll-target="#libraries"><span class="header-section-number">2</span> Libraries</a></li>
  <li><a href="#data-paths" id="toc-data-paths" class="nav-link" data-scroll-target="#data-paths"><span class="header-section-number">3</span> Data Paths</a></li>
  <li><a href="#read-process-data" id="toc-read-process-data" class="nav-link" data-scroll-target="#read-process-data"><span class="header-section-number">4</span> Read &amp; Process Data</a>
  <ul class="collapse">
  <li><a href="#reduce-biases" id="toc-reduce-biases" class="nav-link" data-scroll-target="#reduce-biases"><span class="header-section-number">4.1</span> Reduce biases</a></li>
  </ul></li>
  <li><a href="#read-process-grids" id="toc-read-process-grids" class="nav-link" data-scroll-target="#read-process-grids"><span class="header-section-number">5</span> Read &amp; Process Grids</a></li>
  <li><a href="#calculate-variables" id="toc-calculate-variables" class="nav-link" data-scroll-target="#calculate-variables"><span class="header-section-number">6</span> Calculate variables</a>
  <ul class="collapse">
  <li><a href="#calculate-occupancy-aoo" id="toc-calculate-occupancy-aoo" class="nav-link" data-scroll-target="#calculate-occupancy-aoo"><span class="header-section-number">6.1</span> Calculate occupancy (AOO)</a></li>
  <li><a href="#occupancy-area-relationship-oar-d" id="toc-occupancy-area-relationship-oar-d" class="nav-link" data-scroll-target="#occupancy-area-relationship-oar-d"><span class="header-section-number">6.2</span> Occupancy-Area Relationship (OAR, D)</a></li>
  <li><a href="#telfer-index-of-change-not-static" id="toc-telfer-index-of-change-not-static" class="nav-link" data-scroll-target="#telfer-index-of-change-not-static"><span class="header-section-number">6.3</span> Telfer Index of change (not static)</a></li>
  <li><a href="#log-ratio-temporal-change-response" id="toc-log-ratio-temporal-change-response" class="nav-link" data-scroll-target="#log-ratio-temporal-change-response"><span class="header-section-number">6.4</span> Log Ratio (Temporal Change = Response)</a>
  <ul class="collapse">
  <li><a href="#make-wide-format" id="toc-make-wide-format" class="nav-link" data-scroll-target="#make-wide-format"><span class="header-section-number">6.4.1</span> Make wide-format</a></li>
  <li><a href="#calculate-log-ratio" id="toc-calculate-log-ratio" class="nav-link" data-scroll-target="#calculate-log-ratio"><span class="header-section-number">6.4.2</span> Calculate Log Ratio</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Atlas Data Prep</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Friederike Wölke </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">March 15, 2024</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="predicting-temporal-change-from-static-patterns" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> <strong><em>Predicting temporal change from static patterns</em></strong></h1>
<p>This first script is dedicated to work the atlas data and calculate AOO, OAR/D, Log response ratio, Telfer Index.</p>
<p>In parallel, the data is iteratively checked at each step to exclude errors in data processing (Script: <em><code>0_0_Double_Checking_DataProcessing.R</code></em>)</p>
</section>
<section id="libraries" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Libraries</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">gc</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          used (Mb) gc trigger (Mb) max used (Mb)
Ncells  577344 30.9    1319344 70.5   660420 35.3
Vcells 1058340  8.1    8388608 64.0  1770238 13.6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Spatial:</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf) </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sf_use_s2</span>(<span class="cn">FALSE</span>) <span class="co"># switch spherical geometry off</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Data handling:</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rstatix)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr) </span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr) </span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="co"># library(plyr) </span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="do">## plyr is required but produces some issues with dplyr. Thus it will be called in each function individually and is not required to load here.</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Telfer calculation:</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="do">## sparta is not on CRAN and cannot be updated as usual because there is another package called sparta from CRAN but we don't want this.</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="co"># library(devtools)</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a><span class="co"># install_github('biologicalrecordscentre/sparta')</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sparta) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="data-paths" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Data Paths</h1>
<p>This includes the folders to Git, the external predictor data and the atlases. We also set the desired order for the spatial grains so that they are in order from the smallest grain to the largest grain.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Folders</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>source_atlas <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"c:/Users/wolke/OneDrive - CZU v Praze/Datasets/Processed/Atlases/Replicated/"</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>source_predictors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"c:/Users/wolke/OneDrive - CZU v Praze/Dokumenty/PhD_Projects/StaticPredictors/Data/"</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>source_Git <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"c:/Users/wolke/OneDrive - CZU v Praze/Dokumenty/GitHub/BEAST_General_Procedures/Project_Frieda/StaticPredictors/"</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Folder paths to atlas data</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>source_paths <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">paste0</span>(source_atlas, <span class="st">"Birds_Atlas_Czechia/"</span>), </span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">paste0</span>(source_atlas, <span class="st">"Birds_Atlas_New_York/"</span>), </span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">paste0</span>(source_atlas, <span class="st">"Birds_atlas_Japan/"</span>), </span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">paste0</span>(source_atlas, <span class="st">"Birds_atlas_EBBA/"</span>))</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Folder path to output folder</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>out_path <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">paste0</span>(source_Git, <span class="st">"out/"</span>))</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Paths to data &amp; grids</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>data_paths <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">paste0</span>(source_paths[<span class="dv">1</span>],<span class="st">"Birds_Atlas_Czechia_beast_data.rds"</span>), </span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>                <span class="fu">paste0</span>(source_paths[<span class="dv">2</span>], <span class="st">"Birds_Atlas_New_York_beast_data.rds"</span>), </span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>                <span class="fu">paste0</span>(source_paths[<span class="dv">3</span>], <span class="st">"Birds_atlas_Japan_beast_data.rds"</span>),</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>                <span class="fu">paste0</span>(source_paths[<span class="dv">4</span>], <span class="st">"2Birds_atlas_EBBA_beast_data.rds"</span>))</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>grid_paths <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">paste0</span>(source_paths[<span class="dv">1</span>],<span class="st">"Birds_Atlas_Czechia_grid.gpkg"</span>), </span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>                <span class="fu">paste0</span>(source_paths[<span class="dv">2</span>], <span class="st">"Birds_Atlas_New_York_grid.gpkg"</span>), </span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>                <span class="fu">paste0</span>(source_paths[<span class="dv">3</span>], <span class="st">"Birds_atlas_Japan_grid.gpkg"</span>),</span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>                <span class="fu">paste0</span>(source_paths[<span class="dv">4</span>], <span class="st">"Birds_atlas_EBBA_grid.gpkg"</span>))</span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Vectors for loops:</span></span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>atlas_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Birds_Atlas_Czechia"</span>, <span class="st">"Birds_Atlas_New_York"</span>,<span class="st">"Birds_atlas_Japan"</span>, <span class="st">"Birds_atlas_EBBA"</span>)</span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>time_periods <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the desired order of factor levels</span></span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>desired_levels <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">"1"</span>, <span class="st">"2"</span>,<span class="st">"4"</span>, <span class="st">"8"</span>, <span class="st">"16"</span>, <span class="st">"32"</span>, <span class="st">"64"</span>, <span class="st">"128"</span>), <span class="at">ordered =</span> T,  </span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>                         <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"1"</span>, <span class="st">"2"</span>,<span class="st">"4"</span>, <span class="st">"8"</span>, <span class="st">"16"</span>, <span class="st">"32"</span>, <span class="st">"64"</span>, <span class="st">"128"</span>)) </span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a><span class="co"># list of crs in order of atlas_names</span></span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a>crs_list <span class="ot">&lt;-</span> <span class="fu">list</span>( <span class="st">"EPSG:5514"</span>, <span class="co"># CZ</span></span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"EPSG:32118"</span>, <span class="co"># NY</span></span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"EPSG:6668"</span>, <span class="co"># JP</span></span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"EPSG:3035"</span>) <span class="co"># EU</span></span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(crs_list) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"CZ"</span>, <span class="st">"NY"</span>, <span class="st">"JP"</span>, <span class="st">"EU"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="read-process-data" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Read &amp; Process Data</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Species data  =====================</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>presence_data <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(data_paths)){</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  pres_dat <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(data_paths[i])</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  sy <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">unique</span>(pres_dat<span class="sc">$</span>start_year))</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  pres_dat2 <span class="ot">&lt;-</span> pres_dat <span class="sc">%&gt;%</span>     </span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add time-period column</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">tp =</span> <span class="fu">case_when</span>(start_year <span class="sc">==</span> sy[<span class="dv">1</span>] <span class="sc">~</span> <span class="dv">1</span>, start_year <span class="sc">==</span> sy[<span class="dv">2</span>] <span class="sc">~</span> <span class="dv">2</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(tp <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Reorder spatial scales from small to large</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">reorder_levels</span>(cell_grouping, <span class="at">order=</span>desired_levels) <span class="sc">%&gt;%</span> </span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(dataset, tp, cell_grouping, </span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>           cell_label, cell_lat, cell_long, area, </span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>           verbatim_name) </span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>  presence_data[[i]] <span class="ot">&lt;-</span> pres_dat2</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge list of atlases together</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>presence_data2 <span class="ot">&lt;-</span> plyr<span class="sc">::</span><span class="fu">rbind.fill</span>(presence_data, <span class="at">fill=</span>T) <span class="sc">%&gt;%</span> </span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(dataset, tp, verbatim_name, cell_grouping, cell_label, <span class="at">.keep_all =</span> T)</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a><span class="co"># ========================== Data checks ======================================= #</span></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">is.na</span>(presence_data2))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      dataset            tp cell_grouping    cell_label      cell_lat 
            0             0             0             0             0 
    cell_long          area verbatim_name 
            0             0             0 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary sp and site numbers: Before reduction</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>presence_data2 <span class="sc">%&gt;%</span> </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(cell_grouping <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(dataset, tp) <span class="sc">%&gt;%</span> </span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n_sp =</span> <span class="fu">n_distinct</span>(verbatim_name),</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">n_sites =</span> <span class="fu">n_distinct</span>(cell_label))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'dataset'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 4
# Groups:   dataset [4]
  dataset                 tp  n_sp n_sites
  &lt;chr&gt;                &lt;dbl&gt; &lt;int&gt;   &lt;int&gt;
1 Birds_Atlas_Czechia      1   206     628
2 Birds_Atlas_Czechia      2   213     628
3 Birds_Atlas_New_York     1   242    5323
4 Birds_Atlas_New_York     2   248    5332
5 Birds_atlas_EBBA         1   511    3909
6 Birds_atlas_EBBA         2   617    5041
7 Birds_atlas_Japan        1   221    1095
8 Birds_atlas_Japan        2   227    1098</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>presence_data2 <span class="sc">%&gt;%</span> </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n_sp =</span> <span class="fu">n_distinct</span>(verbatim_name)) <span class="co"># 989 sp in total (before reduction)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  n_sp
1  989</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ==================== Save output &amp; clean up environment ===================== #</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="co"># saveRDS(presence_data2, paste0(out_path, "rds/presence_data_raw.rds"))</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(pres_dat, sy, pres_dat2)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="co"># ============================================================================= #</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="reduce-biases" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="reduce-biases"><span class="header-section-number">4.1</span> Reduce biases</h2>
<ul>
<li><p>remove cells (from the species data) that were only sampled once<br>
(Note: this is not identical to cells that have never been sampled. Those are generally excluded here)</p>
<table class="table">
<thead>
<tr class="header">
<th>Dataset</th>
<th>Repeated</th>
<th>Not repeated - thus removed from data</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Czechia</td>
<td>885</td>
<td>0</td>
</tr>
<tr class="even">
<td>New York</td>
<td>7269</td>
<td>20</td>
</tr>
<tr class="odd">
<td>EBBA</td>
<td>5532</td>
<td>1706</td>
</tr>
<tr class="even">
<td>Japan</td>
<td>1673</td>
<td>3</td>
</tr>
</tbody>
</table></li>
<li><p>remove species that were only sampled once in the cells that were sampled twice (because we don’t have change data for them anyway).</p>
<table class="table">
<thead>
<tr class="header">
<th>Dataset</th>
<th>Repeated</th>
<th>Not repeated - thus removed from data</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Czechia</td>
<td>200</td>
<td>19</td>
</tr>
<tr class="even">
<td>New York</td>
<td>237</td>
<td>16</td>
</tr>
<tr class="odd">
<td>EBBA</td>
<td>503</td>
<td>94</td>
</tr>
<tr class="even">
<td>Japan</td>
<td>208</td>
<td>32</td>
</tr>
</tbody>
</table></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Filter level 1: Cells sampled twice </span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>common_cells <span class="ot">&lt;-</span> presence_data2 <span class="sc">%&gt;%</span> </span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(dataset, cell_grouping, cell_label, tp) <span class="sc">%&gt;%</span> <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(dataset, cell_grouping, cell_label) <span class="sc">%&gt;%</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># How often each cell was sampled:</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">num_periods_cells =</span> <span class="fu">n_distinct</span>(tp)) <span class="sc">%&gt;%</span> </span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Dummy variable for easy filtering of cells that were sampled repeatedly</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">repeated =</span> <span class="fu">case_when</span>(</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>    num_periods_cells <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> <span class="dv">1</span>, </span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>    num_periods_cells <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>) <span class="sc">~</span> <span class="dv">0</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(dataset) <span class="sc">%&gt;%</span> </span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(dataset, cell_grouping, cell_label, num_periods_cells, repeated) <span class="sc">%&gt;%</span> </span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>()</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>presence_data_rep <span class="ot">&lt;-</span> <span class="fu">full_join</span>(presence_data2, common_cells)</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>excluded_cells <span class="ot">&lt;-</span> common_cells <span class="sc">%&gt;%</span> </span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(num_periods_cells <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(dataset, cell_grouping, cell_label)</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a><span class="co"># ========================== Data checks ======================================= #</span></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>common_cells <span class="sc">%&gt;%</span> </span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(num_periods_cells <span class="sc">==</span> <span class="dv">2</span> <span class="sc">&amp;</span> cell_grouping <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(dataset, cell_grouping) <span class="sc">%&gt;%</span> </span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n_distinct</span>(cell_label))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 3
# Groups:   dataset [4]
  dataset              cell_grouping     n
  &lt;chr&gt;                &lt;fct&gt;         &lt;int&gt;
1 Birds_Atlas_Czechia  1               628
2 Birds_Atlas_New_York 1              5320
3 Birds_atlas_EBBA     1              3792
4 Birds_atlas_Japan    1              1095</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(excluded_cells<span class="sc">$</span>dataset) <span class="co"># EBBA: 66 (1706?), JP: 3, NY = 20</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Birds_atlas_EBBA    Birds_atlas_Japan Birds_Atlas_New_York 
                1706                    3                   20 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ============================================================================= #</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Filter level 2: Species sampled twice in the remaining cells</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>common_sp <span class="ot">&lt;-</span> presence_data_rep <span class="sc">%&gt;%</span> <span class="fu">filter</span>(repeated <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> cell_grouping <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(dataset, verbatim_name) <span class="sc">%&gt;%</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">num_periods_sp =</span> <span class="fu">n_distinct</span>(tp)) <span class="sc">%&gt;%</span> </span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(dataset, num_periods_sp)</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>excluded_sp <span class="ot">&lt;-</span> common_sp <span class="sc">%&gt;%</span> </span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(num_periods_sp <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(dataset, verbatim_name)</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a><span class="co"># ========================== Data checks ======================================= #</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>common_sp <span class="sc">%&gt;%</span> </span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(num_periods_sp <span class="sc">==</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(dataset) <span class="sc">%&gt;%</span> </span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n_distinct</span>(verbatim_name))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 2
  dataset                  n
  &lt;chr&gt;                &lt;int&gt;
1 Birds_Atlas_Czechia    200
2 Birds_Atlas_New_York   237
3 Birds_atlas_EBBA       503
4 Birds_atlas_Japan      208</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(excluded_sp<span class="sc">$</span>dataset) <span class="co"># CZ: 19, EBBA = 14 (94?), JP = 32, NY = 16</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 Birds_Atlas_Czechia     Birds_atlas_EBBA    Birds_atlas_Japan 
                  19                   94                   32 
Birds_Atlas_New_York 
                  16 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ============================================================================= #</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Add Diversity Metris to data: </span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>presence_data3 <span class="ot">&lt;-</span> <span class="fu">full_join</span>(presence_data_rep, common_sp)  </span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Subset with only repeated cells</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>presence_data3_red <span class="ot">&lt;-</span> presence_data3 <span class="sc">%&gt;%</span> </span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(repeated <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> num_periods_sp <span class="sc">==</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span>  <span class="co"># Gamma is per atlas</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(dataset, tp, cell_grouping) <span class="sc">%&gt;%</span> </span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Gamma =</span> <span class="fu">n_distinct</span>(verbatim_name)) <span class="sc">%&gt;%</span> </span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Alpha and Beta are per cell</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(dataset, tp, cell_grouping, cell_label) <span class="sc">%&gt;%</span> </span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Alpha =</span> <span class="fu">mean</span>(<span class="fu">n_distinct</span>(verbatim_name))) <span class="sc">%&gt;%</span> </span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Beta =</span> Gamma <span class="sc">/</span> Alpha) <span class="sc">%&gt;%</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Mean Beta and Mean Alpha are per atlas</span></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(dataset, tp, cell_grouping) <span class="sc">%&gt;%</span>  </span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Mean_Alpha =</span> <span class="fu">mean</span>(Alpha),</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>           <span class="at">Mean_Beta =</span> Gamma <span class="sc">/</span> Mean_Alpha) <span class="sc">%&gt;%</span> </span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>()</span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a><span class="co"># ========================== Data checks ======================================= #</span></span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>presence_data3 <span class="sc">%&gt;%</span> </span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(cell_grouping <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(dataset, tp) <span class="sc">%&gt;%</span> </span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>  rstatix<span class="sc">::</span><span class="fu">get_summary_stats</span>(<span class="at">type =</span> <span class="st">"robust"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 56 × 6
   dataset                tp variable              n median    iqr
   &lt;chr&gt;               &lt;dbl&gt; &lt;fct&gt;             &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
 1 Birds_Atlas_Czechia     1 cell_label        65399  351   324   
 2 Birds_Atlas_Czechia     1 cell_lat          65399   49.8   0.9 
 3 Birds_Atlas_Czechia     1 cell_long         65399   15.2   2.5 
 4 Birds_Atlas_Czechia     1 area              65399  134.    2.45
 5 Birds_Atlas_Czechia     1 num_periods_cells 65399    2     0   
 6 Birds_Atlas_Czechia     1 repeated          65399    1     0   
 7 Birds_Atlas_Czechia     1 num_periods_sp    65399    2     0   
 8 Birds_Atlas_Czechia     2 cell_label        68631  353   330   
 9 Birds_Atlas_Czechia     2 cell_lat          68631   49.8   0.9 
10 Birds_Atlas_Czechia     2 cell_long         68631   15.2   2.5 
# ℹ 46 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>presence_data3_red <span class="sc">%&gt;%</span> </span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(cell_grouping <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(dataset, tp) <span class="sc">%&gt;%</span> </span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  rstatix<span class="sc">::</span><span class="fu">get_summary_stats</span>(</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(area, Gamma, Alpha, Beta, Mean_Alpha, Mean_Beta),</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">"robust"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 48 × 6
   dataset                tp variable       n median    iqr
   &lt;chr&gt;               &lt;dbl&gt; &lt;fct&gt;      &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
 1 Birds_Atlas_Czechia     1 area       65362 134.    2.45 
 2 Birds_Atlas_Czechia     1 Gamma      65362 200     0    
 3 Birds_Atlas_Czechia     1 Alpha      65362 109    25    
 4 Birds_Atlas_Czechia     1 Beta       65362   1.84  0.43 
 5 Birds_Atlas_Czechia     1 Mean_Alpha 65362 108.    0    
 6 Birds_Atlas_Czechia     1 Mean_Beta  65362   1.86  0    
 7 Birds_Atlas_Czechia     2 area       68508 134.    2.45 
 8 Birds_Atlas_Czechia     2 Gamma      68508 200     0    
 9 Birds_Atlas_Czechia     2 Alpha      68508 112    27    
10 Birds_Atlas_Czechia     2 Beta       68508   1.79  0.433
# ℹ 38 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ==================== Save output &amp; clean up environment ===================== #  </span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(presence_data3, <span class="fu">paste0</span>(out_path, <span class="st">"rds/presence_data_reduced.rds"</span>))</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(common_sp, presence_data_rep, presence_data2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="read-process-grids" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Read &amp; Process Grids</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># make list with names of layers so we can read them in below</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>layers_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(grid_paths)){</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  layers <span class="ot">&lt;-</span> <span class="fu">st_layers</span>(grid_paths[i])<span class="sc">$</span>name</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  layers_list[[i]] <span class="ot">&lt;-</span> layers</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(layers_list) <span class="ot">&lt;-</span> atlas_names</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a><span class="co"># read grids to list</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>grid_list2 <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (a <span class="cf">in</span> <span class="fu">seq_along</span>(grid_paths)) {</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>    grid_list <span class="ot">&lt;-</span> <span class="fu">sapply</span>(layers_list[[a]], <span class="cf">function</span>(i) {</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">st_read</span>(grid_paths[[a]], <span class="fu">paste</span>(i), <span class="at">quiet =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>        <span class="fu">st_transform</span>(<span class="at">crs =</span> crs_list[[a]]) <span class="sc">%&gt;%</span> </span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>        <span class="fu">reorder_levels</span>( cell_grouping, <span class="at">order=</span>desired_levels)</span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>      }, <span class="at">simplify =</span> <span class="cn">FALSE</span>)</span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>    grid_list2[[a]] <span class="ot">&lt;-</span> grid_list</span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a><span class="co"># clear space</span></span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(grid_list, a, layers, layers_list)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pdf</span>(<span class="at">file =</span> <span class="st">"out/figures/CellsSampledMaps.pdf"</span>, <span class="at">onefile =</span> T, <span class="at">paper =</span> <span class="st">"a4"</span>)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (a <span class="cf">in</span> <span class="fu">seq_along</span>(grid_list2)){</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (scale <span class="cf">in</span> <span class="fu">seq_along</span>(<span class="fu">length</span>(grid_list2[[a]]))){</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  t_common_cells <span class="ot">&lt;-</span> common_cells <span class="sc">%&gt;%</span> </span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(dataset <span class="sc">==</span> atlas_names[[a]] <span class="sc">&amp;</span> cell_grouping <span class="sc">==</span> scale) <span class="sc">%&gt;%</span> </span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">repeated =</span> <span class="fu">as.factor</span>(repeated))</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>  t_grid <span class="ot">&lt;-</span> grid_list2[[a]][[scale]]</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>  t_grid2 <span class="ot">&lt;-</span> <span class="fu">full_join</span>(t_grid, t_common_cells) <span class="sc">%&gt;%</span> </span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">repeated =</span> <span class="fu">case_when</span>(<span class="fu">is.na</span>(repeated) <span class="sc">~</span> <span class="st">"never"</span>,</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>                                repeated <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">"both"</span>,</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>                                repeated <span class="sc">==</span> <span class="dv">0</span> <span class="sc">~</span> <span class="st">"once"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">repeated =</span> <span class="fu">as.factor</span>(repeated)) <span class="sc">%&gt;%</span> </span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">reorder_levels</span>(repeated, <span class="at">order =</span> <span class="fu">c</span>(<span class="st">"never"</span>, <span class="st">"once"</span>, <span class="st">"both"</span>))</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(t_grid2[<span class="st">"repeated"</span>], <span class="at">pal =</span> <span class="fu">hcl.colors</span>(<span class="dv">3</span>, <span class="fu">hcl.pals</span>(<span class="at">type =</span> <span class="st">"divergingx"</span>)[<span class="dv">13</span>], <span class="at">alpha =</span> <span class="fl">0.7</span>))</span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>  <span class="co">#tmap::qtm(t_grid2, "repeated", style = "col_blind", fill = c("black"))</span></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(t_grid2 <span class="sc">%&gt;%</span> </span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(repeated <span class="sc">==</span> <span class="st">"both"</span> <span class="sc">&amp;</span> cell_grouping <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Total_area_sampled =</span> <span class="fu">sum</span>(area)) <span class="sc">%&gt;%</span> </span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">distinct</span>(Total_area_sampled))</span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(cell_grouping, cell_label)`</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  Total_area_sampled
1           83907.51</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(cell_grouping, cell_label)`</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  Total_area_sampled
1           133036.9</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(cell_grouping, cell_label)`</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  Total_area_sampled
1             448951</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(cell_grouping, cell_label)`</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  Total_area_sampled
1            9781678</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>png 
  2 </code></pre>
</div>
</div>
</section>
<section id="calculate-variables" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Calculate variables</h1>
<section id="calculate-occupancy-aoo" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="calculate-occupancy-aoo"><span class="header-section-number">6.1</span> Calculate occupancy (AOO)</h2>
<p>Here we calculate several predictors for the atlases:</p>
<ul>
<li><p>total sampled area per time period</p></li>
<li><p>total number of sampled cells per time period</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>pres_dat_full1 <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>pres_dat_full3 <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (n_atlas <span class="cf">in</span> <span class="fu">seq_along</span>(atlas_names)){</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>  atlas_name <span class="ot">&lt;-</span> atlas_names[n_atlas] <span class="co"># set variable for current run of the loop</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>  atlas <span class="ot">&lt;-</span> grid_list2[[n_atlas]] <span class="co"># subset list of atlases to one</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (grain <span class="cf">in</span> <span class="fu">seq_along</span>(atlas)){</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># set some variables for current run of the loop</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>    grain_a <span class="ot">&lt;-</span> <span class="fu">names</span>(atlas)[grain]</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>    grain_d <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">D"</span>, <span class="st">""</span>, grain_a)) <span class="co"># "\\D" = remove all non-numbers</span></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># subset atlas to one grain</span></span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>    atlas_1scale <span class="ot">&lt;-</span> atlas[[grain]] <span class="sc">%&gt;%</span> </span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(cell_grouping, cell_label, area, cell_long, cell_lat) <span class="sc">%&gt;%</span></span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>      <span class="fu">st_drop_geometry</span>()</span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate total sampled area per time period:</span></span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a>    atlas_1scale <span class="ot">&lt;-</span> atlas_1scale <span class="sc">%&gt;%</span> </span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a>      <span class="fu">group_by</span>(cell_grouping) <span class="sc">%&gt;%</span></span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">Total_area =</span> <span class="fu">sum</span>(atlas_1scale<span class="sc">$</span>area))</span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate total number of total cells sampled:</span></span>
<span id="cb38-24"><a href="#cb38-24" aria-hidden="true" tabindex="-1"></a>    Total_Ncells_samp <span class="ot">&lt;-</span> presence_data3_red <span class="sc">%&gt;%</span> </span>
<span id="cb38-25"><a href="#cb38-25" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(dataset <span class="sc">==</span> atlas_name <span class="sc">&amp;</span> cell_grouping <span class="sc">==</span> grain_d) <span class="sc">%&gt;%</span></span>
<span id="cb38-26"><a href="#cb38-26" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(dataset, cell_grouping, cell_label, area) <span class="sc">%&gt;%</span> <span class="fu">unique</span>() <span class="sc">%&gt;%</span> <span class="fu">na.omit</span>() <span class="sc">%&gt;%</span></span>
<span id="cb38-27"><a href="#cb38-27" aria-hidden="true" tabindex="-1"></a>      <span class="fu">group_by</span>(dataset, cell_grouping) <span class="sc">%&gt;%</span> <span class="fu">distinct</span>(cell_label, <span class="at">.keep_all =</span> T)<span class="sc">%&gt;%</span></span>
<span id="cb38-28"><a href="#cb38-28" aria-hidden="true" tabindex="-1"></a>      <span class="fu">summarise</span>(<span class="at">n_cells =</span> <span class="fu">n_distinct</span>(cell_label),</span>
<span id="cb38-29"><a href="#cb38-29" aria-hidden="true" tabindex="-1"></a>                <span class="at">area_samp =</span> <span class="fu">sum</span>(area)) <span class="sc">%&gt;%</span> </span>
<span id="cb38-30"><a href="#cb38-30" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb38-31"><a href="#cb38-31" aria-hidden="true" tabindex="-1"></a>      <span class="fu">distinct</span>(n_cells, area_samp)</span>
<span id="cb38-32"><a href="#cb38-32" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb38-33"><a href="#cb38-33" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate total number of total cells per atlas:</span></span>
<span id="cb38-34"><a href="#cb38-34" aria-hidden="true" tabindex="-1"></a>    Total_Ncells_atlas <span class="ot">&lt;-</span> atlas_1scale <span class="sc">%&gt;%</span></span>
<span id="cb38-35"><a href="#cb38-35" aria-hidden="true" tabindex="-1"></a>      <span class="fu">group_by</span>(cell_grouping) <span class="sc">%&gt;%</span></span>
<span id="cb38-36"><a href="#cb38-36" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">Total_Ncells =</span> <span class="fu">length</span>(<span class="fu">unique</span>(cell_label))) <span class="sc">%&gt;%</span></span>
<span id="cb38-37"><a href="#cb38-37" aria-hidden="true" tabindex="-1"></a>      <span class="fu">pull</span>(Total_Ncells) <span class="sc">%&gt;%</span></span>
<span id="cb38-38"><a href="#cb38-38" aria-hidden="true" tabindex="-1"></a>      <span class="fu">unique</span>()</span>
<span id="cb38-39"><a href="#cb38-39" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb38-40"><a href="#cb38-40" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb38-41"><a href="#cb38-41" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb38-42"><a href="#cb38-42" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Merge columns together</span></span>
<span id="cb38-43"><a href="#cb38-43" aria-hidden="true" tabindex="-1"></a>    atlas_1scale<span class="sc">$</span>Total_area_samp <span class="ot">&lt;-</span> Total_Ncells_samp<span class="sc">$</span>area_samp</span>
<span id="cb38-44"><a href="#cb38-44" aria-hidden="true" tabindex="-1"></a>    atlas_1scale<span class="sc">$</span>Total_Ncells_samp <span class="ot">&lt;-</span> Total_Ncells_samp<span class="sc">$</span>n_cells</span>
<span id="cb38-45"><a href="#cb38-45" aria-hidden="true" tabindex="-1"></a>    atlas_1scale<span class="sc">$</span>Total_Ncells_atlas <span class="ot">&lt;-</span> Total_Ncells_atlas</span>
<span id="cb38-46"><a href="#cb38-46" aria-hidden="true" tabindex="-1"></a>    map_atlas_1scale <span class="ot">&lt;-</span> atlas_1scale</span>
<span id="cb38-47"><a href="#cb38-47" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb38-48"><a href="#cb38-48" aria-hidden="true" tabindex="-1"></a>    <span class="co"># subset the presence/absence data to the current spatial grain:</span></span>
<span id="cb38-49"><a href="#cb38-49" aria-hidden="true" tabindex="-1"></a>    pres_data_1atlas <span class="ot">&lt;-</span> presence_data3_red <span class="sc">%&gt;%</span> </span>
<span id="cb38-50"><a href="#cb38-50" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(dataset <span class="sc">==</span> atlas_name) <span class="sc">%&gt;%</span></span>
<span id="cb38-51"><a href="#cb38-51" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(cell_grouping <span class="sc">==</span> grain_d) <span class="sc">%&gt;%</span></span>
<span id="cb38-52"><a href="#cb38-52" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(dataset, tp, verbatim_name, cell_label, cell_grouping, repeated)</span>
<span id="cb38-53"><a href="#cb38-53" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-54"><a href="#cb38-54" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Merge sampled and unsampled cells for calculations:</span></span>
<span id="cb38-55"><a href="#cb38-55" aria-hidden="true" tabindex="-1"></a>    pres_data_full_1atlas <span class="ot">&lt;-</span> <span class="fu">left_join</span>(map_atlas_1scale, pres_data_1atlas)</span>
<span id="cb38-56"><a href="#cb38-56" aria-hidden="true" tabindex="-1"></a>    pres_data_full_1atlas <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(verbatim_name))</span>
<span id="cb38-57"><a href="#cb38-57" aria-hidden="true" tabindex="-1"></a>    pres_data_full_1atlas<span class="sc">$</span>dataset <span class="ot">&lt;-</span> atlas_names[n_atlas]</span>
<span id="cb38-58"><a href="#cb38-58" aria-hidden="true" tabindex="-1"></a>    pres_dat_full1[[grain]] <span class="ot">&lt;-</span> pres_data_full_1atlas <span class="sc">%&gt;%</span> <span class="fu">unique</span>() <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(verbatim_name))</span>
<span id="cb38-59"><a href="#cb38-59" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb38-60"><a href="#cb38-60" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb38-61"><a href="#cb38-61" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-62"><a href="#cb38-62" aria-hidden="true" tabindex="-1"></a>  pres_dat_full2 <span class="ot">&lt;-</span> plyr<span class="sc">::</span><span class="fu">rbind.fill</span>(pres_dat_full1, <span class="at">fill=</span>T)</span>
<span id="cb38-63"><a href="#cb38-63" aria-hidden="true" tabindex="-1"></a>  pres_dat_full3[[n_atlas]] <span class="ot">&lt;-</span> pres_dat_full2</span>
<span id="cb38-64"><a href="#cb38-64" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-65"><a href="#cb38-65" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb38-66"><a href="#cb38-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-67"><a href="#cb38-67" aria-hidden="true" tabindex="-1"></a>pres_dat_full4 <span class="ot">&lt;-</span> plyr<span class="sc">::</span><span class="fu">rbind.fill</span>(pres_dat_full3, <span class="at">fill=</span>T)</span>
<span id="cb38-68"><a href="#cb38-68" aria-hidden="true" tabindex="-1"></a>pres_dat_full4[pres_dat_full4 <span class="sc">==</span> <span class="st">"&lt;NA&gt;"</span>] <span class="ot">=</span> <span class="cn">NA</span> <span class="co">#Fix NA issues in the data (takes a while.)</span></span>
<span id="cb38-69"><a href="#cb38-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-70"><a href="#cb38-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-71"><a href="#cb38-71" aria-hidden="true" tabindex="-1"></a>pres_dat_final <span class="ot">&lt;-</span> pres_dat_full4 <span class="sc">%&gt;%</span>  </span>
<span id="cb38-72"><a href="#cb38-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cell_grouping =</span> <span class="fu">factor</span>(cell_grouping,<span class="at">levels =</span> desired_levels),</span>
<span id="cb38-73"><a href="#cb38-73" aria-hidden="true" tabindex="-1"></a>        <span class="at">grain =</span> <span class="fu">case_when</span>(</span>
<span id="cb38-74"><a href="#cb38-74" aria-hidden="true" tabindex="-1"></a>          dataset <span class="sc">==</span> atlas_names[<span class="dv">1</span>] <span class="sc">~</span> <span class="st">"10"</span>,</span>
<span id="cb38-75"><a href="#cb38-75" aria-hidden="true" tabindex="-1"></a>          dataset <span class="sc">==</span> atlas_names[<span class="dv">2</span>] <span class="sc">~</span> <span class="st">"5"</span>,</span>
<span id="cb38-76"><a href="#cb38-76" aria-hidden="true" tabindex="-1"></a>          dataset <span class="sc">==</span> atlas_names[<span class="dv">3</span>] <span class="sc">~</span> <span class="st">"20"</span>, </span>
<span id="cb38-77"><a href="#cb38-77" aria-hidden="true" tabindex="-1"></a>          dataset <span class="sc">==</span> atlas_names[<span class="dv">4</span>] <span class="sc">~</span> <span class="st">"50"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb38-78"><a href="#cb38-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(verbatim_name))</span>
<span id="cb38-79"><a href="#cb38-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-80"><a href="#cb38-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-81"><a href="#cb38-81" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(pres_dat_final, <span class="fu">paste0</span>(out_path, <span class="st">"rds/presence_data_final.rds"</span>))</span>
<span id="cb38-82"><a href="#cb38-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-83"><a href="#cb38-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-84"><a href="#cb38-84" aria-hidden="true" tabindex="-1"></a><span class="do">### =============================================== </span><span class="al">###</span></span>
<span id="cb38-85"><a href="#cb38-85" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(pres_dat_full1, pres_dat_full2, pres_dat_full3, pres_dat_full4, pres_data_1atlas, pres_data_full_1atlas, map_atlas_1scale)</span>
<span id="cb38-86"><a href="#cb38-86" aria-hidden="true" tabindex="-1"></a><span class="do">### =============================================== </span><span class="al">###</span></span>
<span id="cb38-87"><a href="#cb38-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-88"><a href="#cb38-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-89"><a href="#cb38-89" aria-hidden="true" tabindex="-1"></a>occ_data <span class="ot">&lt;-</span> pres_dat_final <span class="sc">%&gt;%</span></span>
<span id="cb38-90"><a href="#cb38-90" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb38-91"><a href="#cb38-91" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(dataset, tp, cell_grouping, verbatim_name) <span class="sc">%&gt;%</span> <span class="fu">distinct</span>() <span class="sc">%&gt;%</span></span>
<span id="cb38-92"><a href="#cb38-92" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate Occupancy:</span></span>
<span id="cb38-93"><a href="#cb38-93" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">occupancy_area =</span> <span class="fu">sum</span>(area),</span>
<span id="cb38-94"><a href="#cb38-94" aria-hidden="true" tabindex="-1"></a>         <span class="at">mean_area =</span> <span class="fu">mean</span>(area)) <span class="sc">%&gt;%</span></span>
<span id="cb38-95"><a href="#cb38-95" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">occupancy_Ncells =</span> <span class="fu">n_distinct</span>(cell_label)) <span class="sc">%&gt;%</span></span>
<span id="cb38-96"><a href="#cb38-96" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate AOO:</span></span>
<span id="cb38-97"><a href="#cb38-97" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">AOO =</span> occupancy_area) <span class="sc">%&gt;%</span></span>
<span id="cb38-98"><a href="#cb38-98" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate relative Occupancy:</span></span>
<span id="cb38-99"><a href="#cb38-99" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">relative_occupancy_area =</span> occupancy_area<span class="sc">/</span>Total_area_samp) <span class="sc">%&gt;%</span></span>
<span id="cb38-100"><a href="#cb38-100" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">relative_occupancy_Ncells =</span> occupancy_Ncells<span class="sc">/</span>Total_Ncells_samp) <span class="sc">%&gt;%</span> <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb38-101"><a href="#cb38-101" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(dataset, tp, cell_grouping) <span class="sc">%&gt;%</span></span>
<span id="cb38-102"><a href="#cb38-102" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">total_SR_atlas_AOOcalc =</span> <span class="fu">n_distinct</span>(verbatim_name)) <span class="sc">%&gt;%</span></span>
<span id="cb38-103"><a href="#cb38-103" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove duplicated rows:</span></span>
<span id="cb38-104"><a href="#cb38-104" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() </span>
<span id="cb38-105"><a href="#cb38-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-106"><a href="#cb38-106" aria-hidden="true" tabindex="-1"></a>occ_data<span class="sc">$</span>cell_grouping2 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(occ_data<span class="sc">$</span>cell_grouping))</span>
<span id="cb38-107"><a href="#cb38-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-108"><a href="#cb38-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-109"><a href="#cb38-109" aria-hidden="true" tabindex="-1"></a><span class="co"># create scale column as a fraction of the full country:</span></span>
<span id="cb38-110"><a href="#cb38-110" aria-hidden="true" tabindex="-1"></a>occ_data_final <span class="ot">&lt;-</span> occ_data <span class="sc">%&gt;%</span> </span>
<span id="cb38-111"><a href="#cb38-111" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb38-112"><a href="#cb38-112" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(dataset) <span class="sc">%&gt;%</span></span>
<span id="cb38-113"><a href="#cb38-113" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">scale =</span> <span class="fu">ifelse</span>(dataset <span class="sc">%in%</span> <span class="fu">c</span>(atlas_names[<span class="dv">1</span>]) <span class="sc">&amp;</span> cell_grouping <span class="sc">==</span> <span class="st">"1"</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">64</span>, <span class="cn">NA</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb38-114"><a href="#cb38-114" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">scale =</span> <span class="fu">ifelse</span>(dataset <span class="sc">%in%</span> <span class="fu">c</span>(atlas_names[<span class="dv">1</span>]) <span class="sc">&amp;</span> cell_grouping <span class="sc">==</span> <span class="st">"2"</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">32</span>, scale)) <span class="sc">%&gt;%</span></span>
<span id="cb38-115"><a href="#cb38-115" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">scale =</span> <span class="fu">ifelse</span>(dataset <span class="sc">%in%</span> <span class="fu">c</span>(atlas_names[<span class="dv">1</span>]) <span class="sc">&amp;</span> cell_grouping <span class="sc">==</span> <span class="st">"4"</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">16</span>, scale)) <span class="sc">%&gt;%</span></span>
<span id="cb38-116"><a href="#cb38-116" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">scale =</span> <span class="fu">ifelse</span>(dataset <span class="sc">%in%</span> <span class="fu">c</span>(atlas_names[<span class="dv">1</span>]) <span class="sc">&amp;</span> cell_grouping <span class="sc">==</span> <span class="st">"8"</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">8</span>, scale)) <span class="sc">%&gt;%</span></span>
<span id="cb38-117"><a href="#cb38-117" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">scale =</span> <span class="fu">ifelse</span>(dataset <span class="sc">%in%</span> <span class="fu">c</span>(atlas_names[<span class="dv">1</span>]) <span class="sc">&amp;</span> cell_grouping <span class="sc">==</span> <span class="st">"16"</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, scale)) <span class="sc">%&gt;%</span></span>
<span id="cb38-118"><a href="#cb38-118" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">scale =</span> <span class="fu">ifelse</span>(dataset <span class="sc">%in%</span> <span class="fu">c</span>(atlas_names[<span class="dv">1</span>]) <span class="sc">&amp;</span> cell_grouping <span class="sc">==</span> <span class="st">"32"</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, scale)) <span class="sc">%&gt;%</span></span>
<span id="cb38-119"><a href="#cb38-119" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">scale =</span> <span class="fu">ifelse</span>(dataset <span class="sc">%in%</span> <span class="fu">c</span>(atlas_names[<span class="dv">1</span>]) <span class="sc">&amp;</span> cell_grouping <span class="sc">==</span> <span class="st">"64"</span>, <span class="dv">1</span>, scale)) <span class="sc">%&gt;%</span></span>
<span id="cb38-120"><a href="#cb38-120" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">scale =</span> <span class="fu">ifelse</span>(dataset <span class="sc">%in%</span> <span class="fu">c</span>(atlas_names[<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>]) <span class="sc">&amp;</span> cell_grouping <span class="sc">==</span> <span class="st">"1"</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">128</span>, scale)) <span class="sc">%&gt;%</span></span>
<span id="cb38-121"><a href="#cb38-121" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">scale =</span> <span class="fu">ifelse</span>(dataset <span class="sc">%in%</span> <span class="fu">c</span>(atlas_names[<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>]) <span class="sc">&amp;</span> cell_grouping <span class="sc">==</span> <span class="st">"2"</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">16</span>, scale)) <span class="sc">%&gt;%</span></span>
<span id="cb38-122"><a href="#cb38-122" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">scale =</span> <span class="fu">ifelse</span>(dataset <span class="sc">%in%</span> <span class="fu">c</span>(atlas_names[<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>]) <span class="sc">&amp;</span> cell_grouping <span class="sc">==</span> <span class="st">"4"</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">32</span>, scale)) <span class="sc">%&gt;%</span></span>
<span id="cb38-123"><a href="#cb38-123" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">scale =</span> <span class="fu">ifelse</span>(dataset <span class="sc">%in%</span> <span class="fu">c</span>(atlas_names[<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>]) <span class="sc">&amp;</span> cell_grouping <span class="sc">==</span> <span class="st">"8"</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">16</span>, scale)) <span class="sc">%&gt;%</span></span>
<span id="cb38-124"><a href="#cb38-124" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">scale =</span> <span class="fu">ifelse</span>(dataset <span class="sc">%in%</span> <span class="fu">c</span>(atlas_names[<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>]) <span class="sc">&amp;</span> cell_grouping <span class="sc">==</span> <span class="st">"16"</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">8</span>, scale)) <span class="sc">%&gt;%</span></span>
<span id="cb38-125"><a href="#cb38-125" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">scale =</span> <span class="fu">ifelse</span>(dataset <span class="sc">%in%</span> <span class="fu">c</span>(atlas_names[<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>]) <span class="sc">&amp;</span> cell_grouping <span class="sc">==</span> <span class="st">"32"</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, scale)) <span class="sc">%&gt;%</span></span>
<span id="cb38-126"><a href="#cb38-126" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">scale =</span> <span class="fu">ifelse</span>(dataset <span class="sc">%in%</span> <span class="fu">c</span>(atlas_names[<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>]) <span class="sc">&amp;</span> cell_grouping <span class="sc">==</span> <span class="st">"64"</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, scale)) <span class="sc">%&gt;%</span></span>
<span id="cb38-127"><a href="#cb38-127" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">scale =</span> <span class="fu">ifelse</span>(dataset <span class="sc">%in%</span> <span class="fu">c</span>(atlas_names[<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>]) <span class="sc">&amp;</span> cell_grouping <span class="sc">==</span> <span class="st">"128"</span>, <span class="dv">1</span>, scale))</span>
<span id="cb38-128"><a href="#cb38-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-129"><a href="#cb38-129" aria-hidden="true" tabindex="-1"></a>occ_data_final <span class="sc">%&gt;%</span> <span class="fu">filter_all</span>(<span class="fu">any_vars</span>(<span class="fu">is.na</span>(.))) <span class="co"># NAs in effort columns</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 0 × 23
# Groups:   dataset [0]
# ℹ 23 variables: cell_grouping &lt;fct&gt;, cell_label &lt;dbl&gt;, area &lt;dbl&gt;,
#   cell_long &lt;dbl&gt;, cell_lat &lt;dbl&gt;, Total_area &lt;dbl&gt;, Total_area_samp &lt;dbl&gt;,
#   Total_Ncells_samp &lt;int&gt;, Total_Ncells_atlas &lt;int&gt;, dataset &lt;chr&gt;, tp &lt;dbl&gt;,
#   verbatim_name &lt;chr&gt;, repeated &lt;dbl&gt;, grain &lt;chr&gt;, occupancy_area &lt;dbl&gt;,
#   mean_area &lt;dbl&gt;, occupancy_Ncells &lt;int&gt;, AOO &lt;dbl&gt;,
#   relative_occupancy_area &lt;dbl&gt;, relative_occupancy_Ncells &lt;dbl&gt;,
#   total_SR_atlas_AOOcalc &lt;int&gt;, cell_grouping2 &lt;dbl&gt;, scale &lt;dbl&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="do">### =============================================== </span><span class="al">###</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(occ_data)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="do">### =============================================== </span><span class="al">###</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a><span class="co"># save reduced version of this to file:</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>species_data <span class="ot">&lt;-</span> occ_data_final <span class="sc">%&gt;%</span> </span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(dataset, tp, cell_grouping, scale, verbatim_name, </span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>         Total_area, Total_area_samp, Total_Ncells_atlas, Total_Ncells_samp, </span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>         occupancy_area, occupancy_Ncells, AOO, relative_occupancy_area, relative_occupancy_Ncells, </span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>         mean_area, total_SR_atlas_AOOcalc, grain) <span class="sc">%&gt;%</span></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() </span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>species_data <span class="sc">%&gt;%</span> <span class="fu">write.csv</span>(<span class="fu">paste0</span>(out_path, <span class="st">"csv/Occupancy_table.csv"</span>))</span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a>species_data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(dataset <span class="sc">==</span> <span class="st">"Birds_atlas_EBBA"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8,048 × 17
# Groups:   dataset [1]
   dataset     tp cell_grouping   scale verbatim_name Total_area Total_area_samp
   &lt;chr&gt;    &lt;dbl&gt; &lt;fct&gt;           &lt;dbl&gt; &lt;chr&gt;              &lt;dbl&gt;           &lt;dbl&gt;
 1 Birds_a…     2 1             0.00781 Alectoris ru…  13483712.        9781678.
 2 Birds_a…     1 1             0.00781 Ardea cinerea  13483712.        9781678.
 3 Birds_a…     1 1             0.00781 Asio otus      13483712.        9781678.
 4 Birds_a…     2 1             0.00781 Asio otus      13483712.        9781678.
 5 Birds_a…     1 1             0.00781 Buteo buteo    13483712.        9781678.
 6 Birds_a…     2 1             0.00781 Buteo buteo    13483712.        9781678.
 7 Birds_a…     1 1             0.00781 Calonectris …  13483712.        9781678.
 8 Birds_a…     2 1             0.00781 Calonectris …  13483712.        9781678.
 9 Birds_a…     1 1             0.00781 Carduelis ca…  13483712.        9781678.
10 Birds_a…     2 1             0.00781 Carduelis ca…  13483712.        9781678.
# ℹ 8,038 more rows
# ℹ 10 more variables: Total_Ncells_atlas &lt;int&gt;, Total_Ncells_samp &lt;int&gt;,
#   occupancy_area &lt;dbl&gt;, occupancy_Ncells &lt;int&gt;, AOO &lt;dbl&gt;,
#   relative_occupancy_area &lt;dbl&gt;, relative_occupancy_Ncells &lt;dbl&gt;,
#   mean_area &lt;dbl&gt;, total_SR_atlas_AOOcalc &lt;int&gt;, grain &lt;chr&gt;</code></pre>
</div>
</div>
</section>
<section id="occupancy-area-relationship-oar-d" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="occupancy-area-relationship-oar-d"><span class="header-section-number">6.2</span> Occupancy-Area Relationship (OAR, D)</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop to prune species completely with less than 2 scales without saturation</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>atlas_names <span class="ot">&lt;-</span> <span class="fu">unique</span>(species_data<span class="sc">$</span>dataset)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>time_periods <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>list_sp <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>list_tp <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>list_a <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (a <span class="cf">in</span> <span class="fu">seq_along</span>(atlas_names)){</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>  temp_df <span class="ot">&lt;-</span> species_data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(dataset <span class="sc">==</span> atlas_names[a])</span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (t <span class="cf">in</span> <span class="fu">seq_along</span>(time_periods)) {</span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>    temp_df_t <span class="ot">&lt;-</span> temp_df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(tp <span class="sc">==</span> time_periods[t])</span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>    species_names <span class="ot">&lt;-</span> <span class="fu">unique</span>(temp_df_t<span class="sc">$</span>verbatim_name)</span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (s <span class="cf">in</span> <span class="fu">seq_along</span>(species_names)){</span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>      temp_df_s <span class="ot">&lt;-</span> temp_df_t <span class="sc">%&gt;%</span> <span class="fu">filter</span>(verbatim_name <span class="sc">==</span> species_names[s])</span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Exclude saturated scales</span></span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>      temp_df_red <span class="ot">&lt;-</span> temp_df_s <span class="sc">%&gt;%</span> <span class="fu">filter</span>(relative_occupancy_Ncells <span class="sc">&lt;</span> <span class="dv">1</span>)</span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="fu">nrow</span>(temp_df_red) <span class="sc">&lt;</span> <span class="dv">2</span> <span class="sc">&amp;</span> <span class="fu">nrow</span>(temp_df_red) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a>        out_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">verbatim_name =</span> species_names[s],</span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a>                             <span class="at">dataset =</span> atlas_names[a],</span>
<span id="cb42-23"><a href="#cb42-23" aria-hidden="true" tabindex="-1"></a>                             <span class="at">tp =</span> time_periods[t],</span>
<span id="cb42-24"><a href="#cb42-24" aria-hidden="true" tabindex="-1"></a>                             <span class="at">exclude =</span> <span class="dv">1</span>,</span>
<span id="cb42-25"><a href="#cb42-25" aria-hidden="true" tabindex="-1"></a>                             <span class="at">available_scales =</span> <span class="fu">nrow</span>(temp_df_red),</span>
<span id="cb42-26"><a href="#cb42-26" aria-hidden="true" tabindex="-1"></a>                             <span class="at">mean_relOcc =</span> <span class="fu">mean</span>(temp_df_red<span class="sc">$</span>relative_occupancy_Ncells, <span class="at">na.rm=</span>T))</span>
<span id="cb42-27"><a href="#cb42-27" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> <span class="cf">if</span> (<span class="fu">nrow</span>(temp_df_red) <span class="sc">&gt;=</span> <span class="dv">2</span>) {</span>
<span id="cb42-28"><a href="#cb42-28" aria-hidden="true" tabindex="-1"></a>        out_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">verbatim_name =</span> species_names[s],</span>
<span id="cb42-29"><a href="#cb42-29" aria-hidden="true" tabindex="-1"></a>                             <span class="at">dataset =</span> atlas_names[a],</span>
<span id="cb42-30"><a href="#cb42-30" aria-hidden="true" tabindex="-1"></a>                             <span class="at">tp =</span> time_periods[t],</span>
<span id="cb42-31"><a href="#cb42-31" aria-hidden="true" tabindex="-1"></a>                             <span class="at">exclude =</span> <span class="dv">0</span>,</span>
<span id="cb42-32"><a href="#cb42-32" aria-hidden="true" tabindex="-1"></a>                             <span class="at">available_scales =</span> <span class="fu">nrow</span>(temp_df_red),</span>
<span id="cb42-33"><a href="#cb42-33" aria-hidden="true" tabindex="-1"></a>                             <span class="at">mean_relOcc =</span> <span class="fu">mean</span>(temp_df_red<span class="sc">$</span>relative_occupancy_Ncells, <span class="at">na.rm=</span>T))</span>
<span id="cb42-34"><a href="#cb42-34" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb42-35"><a href="#cb42-35" aria-hidden="true" tabindex="-1"></a>                out_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">verbatim_name =</span> species_names[s],</span>
<span id="cb42-36"><a href="#cb42-36" aria-hidden="true" tabindex="-1"></a>                             <span class="at">dataset =</span> atlas_names[a],</span>
<span id="cb42-37"><a href="#cb42-37" aria-hidden="true" tabindex="-1"></a>                             <span class="at">tp =</span> time_periods[t],</span>
<span id="cb42-38"><a href="#cb42-38" aria-hidden="true" tabindex="-1"></a>                             <span class="at">exclude =</span> <span class="dv">1</span>,</span>
<span id="cb42-39"><a href="#cb42-39" aria-hidden="true" tabindex="-1"></a>                             <span class="at">available_scales =</span> <span class="fu">nrow</span>(temp_df_red),</span>
<span id="cb42-40"><a href="#cb42-40" aria-hidden="true" tabindex="-1"></a>                             <span class="at">mean_relOcc =</span> <span class="dv">1</span>)</span>
<span id="cb42-41"><a href="#cb42-41" aria-hidden="true" tabindex="-1"></a>                }</span>
<span id="cb42-42"><a href="#cb42-42" aria-hidden="true" tabindex="-1"></a>      list_sp[[s]] <span class="ot">&lt;-</span> out_df</span>
<span id="cb42-43"><a href="#cb42-43" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb42-44"><a href="#cb42-44" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb42-45"><a href="#cb42-45" aria-hidden="true" tabindex="-1"></a>    sp_df <span class="ot">&lt;-</span> plyr<span class="sc">::</span><span class="fu">rbind.fill</span>(list_sp)</span>
<span id="cb42-46"><a href="#cb42-46" aria-hidden="true" tabindex="-1"></a>    list_tp[[t]] <span class="ot">&lt;-</span> sp_df</span>
<span id="cb42-47"><a href="#cb42-47" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-48"><a href="#cb42-48" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb42-49"><a href="#cb42-49" aria-hidden="true" tabindex="-1"></a>  tp_df <span class="ot">&lt;-</span> plyr<span class="sc">::</span><span class="fu">rbind.fill</span>(list_tp)</span>
<span id="cb42-50"><a href="#cb42-50" aria-hidden="true" tabindex="-1"></a>  list_a[[a]] <span class="ot">&lt;-</span> tp_df</span>
<span id="cb42-51"><a href="#cb42-51" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb42-52"><a href="#cb42-52" aria-hidden="true" tabindex="-1"></a>atlas_df <span class="ot">&lt;-</span> plyr<span class="sc">::</span><span class="fu">rbind.fill</span>(list_a)</span>
<span id="cb42-53"><a href="#cb42-53" aria-hidden="true" tabindex="-1"></a>sp_data_new <span class="ot">&lt;-</span> <span class="fu">full_join</span>(species_data, atlas_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(dataset, tp, verbatim_name)`</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in full_join(species_data, atlas_df): Detected an unexpected many-to-many relationship between `x` and `y`.
ℹ Row 3216 of `x` matches multiple rows in `y`.
ℹ Row 1 of `y` matches multiple rows in `x`.
ℹ If a many-to-many relationship is expected, set `relationship =
  "many-to-many"` to silence this warning.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>dd <span class="ot">&lt;-</span> sp_data_new <span class="sc">%&gt;%</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(exclude <span class="sc">==</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(relative_occupancy_Ncells <span class="sc">&lt;</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="co"># exclude saturated scales</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unique</span>() <span class="sc">%&gt;%</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter_at</span>(<span class="fu">vars</span>(<span class="fu">c</span>(</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>      cell_grouping, scale,</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>      AOO, occupancy_Ncells,</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>      relative_occupancy_Ncells, mean_area)), <span class="fu">any_vars</span>(<span class="sc">!</span><span class="fu">is.na</span>(.)))</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a><span class="do">## Variables:</span></span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>atlas_names <span class="ot">&lt;-</span> <span class="fu">unique</span>(dd<span class="sc">$</span>dataset)</span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>period <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>OAR_list_sp <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>OAR_list_sp_tp <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>OAR_list_sp_tp_atlas <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a><span class="do">## Loop:</span></span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (n_atlas <span class="cf">in</span> <span class="fu">seq_along</span>(atlas_names)){</span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a>  atlas_name <span class="ot">&lt;-</span> atlas_names[n_atlas]</span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a>  atlas <span class="ot">&lt;-</span> dd <span class="sc">%&gt;%</span> <span class="fu">filter</span>(dataset <span class="sc">==</span> atlas_name)</span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (time <span class="cf">in</span> <span class="fu">seq_along</span>(period)){</span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a>    period_nr <span class="ot">&lt;-</span> period[time]</span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true" tabindex="-1"></a>    atlas_1time <span class="ot">&lt;-</span> atlas <span class="sc">%&gt;%</span> <span class="fu">filter</span>(tp <span class="sc">==</span> period_nr) </span>
<span id="cb45-24"><a href="#cb45-24" aria-hidden="true" tabindex="-1"></a>    sp <span class="ot">&lt;-</span> <span class="fu">unique</span>(atlas_1time<span class="sc">$</span>verbatim_name)</span>
<span id="cb45-25"><a href="#cb45-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(spec <span class="cf">in</span> <span class="fu">seq_along</span>(sp)){</span>
<span id="cb45-26"><a href="#cb45-26" aria-hidden="true" tabindex="-1"></a>      species <span class="ot">&lt;-</span> sp[spec]</span>
<span id="cb45-27"><a href="#cb45-27" aria-hidden="true" tabindex="-1"></a>      model_df <span class="ot">&lt;-</span> atlas_1time <span class="sc">%&gt;%</span> <span class="fu">filter</span>(verbatim_name <span class="sc">==</span> species) <span class="sc">%&gt;%</span> <span class="fu">distinct</span>()</span>
<span id="cb45-28"><a href="#cb45-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-29"><a href="#cb45-29" aria-hidden="true" tabindex="-1"></a>      OAR <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(AOO) <span class="sc">~</span> <span class="fu">log</span>(mean_area), <span class="at">data =</span> model_df)</span>
<span id="cb45-30"><a href="#cb45-30" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb45-31"><a href="#cb45-31" aria-hidden="true" tabindex="-1"></a>      OAR_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb45-32"><a href="#cb45-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">verbatim_name =</span> species,</span>
<span id="cb45-33"><a href="#cb45-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">dataset =</span> atlas_name,</span>
<span id="cb45-34"><a href="#cb45-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">tp =</span> period_nr,</span>
<span id="cb45-35"><a href="#cb45-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">m_AOO_a =</span> OAR<span class="sc">$</span>coefficients[<span class="dv">2</span>],</span>
<span id="cb45-36"><a href="#cb45-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">b_AOO_a =</span> OAR<span class="sc">$</span>coefficients[<span class="dv">1</span>])</span>
<span id="cb45-37"><a href="#cb45-37" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb45-38"><a href="#cb45-38" aria-hidden="true" tabindex="-1"></a>      OAR_df<span class="sc">$</span>D_AOO_a <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>OAR_df<span class="sc">$</span>m_AOO_a<span class="sc">+</span><span class="dv">2</span></span>
<span id="cb45-39"><a href="#cb45-39" aria-hidden="true" tabindex="-1"></a>      OAR_df<span class="sc">$</span>dataset <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(OAR_df<span class="sc">$</span>dataset)</span>
<span id="cb45-40"><a href="#cb45-40" aria-hidden="true" tabindex="-1"></a>      OAR_list_sp[[spec]] <span class="ot">&lt;-</span> OAR_df</span>
<span id="cb45-41"><a href="#cb45-41" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb45-42"><a href="#cb45-42" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb45-43"><a href="#cb45-43" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb45-44"><a href="#cb45-44" aria-hidden="true" tabindex="-1"></a>    OAR_df_sp <span class="ot">&lt;-</span> plyr<span class="sc">::</span><span class="fu">rbind.fill</span>(OAR_list_sp, <span class="at">fill =</span> T)</span>
<span id="cb45-45"><a href="#cb45-45" aria-hidden="true" tabindex="-1"></a>    OAR_list_sp_tp[[time]] <span class="ot">&lt;-</span> OAR_df_sp</span>
<span id="cb45-46"><a href="#cb45-46" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb45-47"><a href="#cb45-47" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb45-48"><a href="#cb45-48" aria-hidden="true" tabindex="-1"></a>  OAR_df_sp_tp <span class="ot">&lt;-</span> plyr<span class="sc">::</span><span class="fu">rbind.fill</span>(OAR_list_sp_tp, <span class="at">fill =</span> T)   </span>
<span id="cb45-49"><a href="#cb45-49" aria-hidden="true" tabindex="-1"></a>  OAR_list_sp_tp_atlas[[n_atlas]] <span class="ot">&lt;-</span> OAR_df_sp_tp</span>
<span id="cb45-50"><a href="#cb45-50" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb45-51"><a href="#cb45-51" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb45-52"><a href="#cb45-52" aria-hidden="true" tabindex="-1"></a>OAR_final <span class="ot">&lt;-</span> plyr<span class="sc">::</span><span class="fu">rbind.fill</span>(OAR_list_sp_tp_atlas, <span class="at">fill =</span> T) <span class="sc">%&gt;%</span> <span class="fu">distinct</span>()</span>
<span id="cb45-53"><a href="#cb45-53" aria-hidden="true" tabindex="-1"></a>OAR_final <span class="sc">%&gt;%</span> <span class="fu">filter_all</span>(<span class="fu">any_vars</span>(<span class="fu">is.na</span>(.))) <span class="co"># None !#</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] verbatim_name dataset       tp            m_AOO_a       b_AOO_a      
[6] D_AOO_a      
&lt;0 Zeilen&gt; (oder row.names mit Länge 0)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>species_data_new <span class="ot">&lt;-</span> <span class="fu">merge</span>(sp_data_new, </span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>                          OAR_final, </span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">by=</span><span class="fu">c</span>(<span class="fu">intersect</span>(<span class="fu">names</span>(species_data), <span class="fu">names</span>(OAR_final))), <span class="at">all =</span> T) <span class="sc">%&gt;%</span> <span class="fu">distinct</span>()</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a><span class="do">### =============================================== </span><span class="al">###</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(dd, OAR_list_sp_tp_atlas, OAR_list_sp_tp, OAR_df_sp_tp, OAR_list_sp, OAR_df_sp, OAR_df, sp, atlas_1time, model_df )</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a><span class="do">### =============================================== </span><span class="al">###</span></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">is.na</span>(species_data_new))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                  dataset                        tp             verbatim_name 
                        0                         0                         0 
            cell_grouping                     scale                Total_area 
                        0                         0                         0 
          Total_area_samp        Total_Ncells_atlas         Total_Ncells_samp 
                        0                         0                         0 
           occupancy_area          occupancy_Ncells                       AOO 
                        0                         0                         0 
  relative_occupancy_area relative_occupancy_Ncells                 mean_area 
                        0                         0                         0 
   total_SR_atlas_AOOcalc                     grain                   exclude 
                        0                         0                         0 
         available_scales               mean_relOcc                   m_AOO_a 
                        0                         0                       315 
                  b_AOO_a                   D_AOO_a 
                      315                       315 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>species_data_new <span class="sc">%&gt;%</span> <span class="fu">filter</span>(exclude <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(dataset, tp) <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">n =</span> <span class="fu">n_distinct</span>(verbatim_name)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'dataset'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
# Groups:   dataset [1]
  dataset                tp     n
  &lt;chr&gt;               &lt;dbl&gt; &lt;int&gt;
1 Birds_Atlas_Czechia     1    21
2 Birds_Atlas_Czechia     2    24</code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 28 species from CZ lost (21 from tp1 and 24 from tp2)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="telfer-index-of-change-not-static" class="level2" data-number="6.3">
<h2 data-number="6.3" class="anchored" data-anchor-id="telfer-index-of-change-not-static"><span class="header-section-number">6.3</span> Telfer Index of change (not static)</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Telfer:</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>telfer_res <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(atlas_names)){</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> pres_dat_final <span class="sc">%&gt;%</span> <span class="fu">filter</span>(dataset <span class="sc">==</span> atlas_names[i]) <span class="sc">%&gt;%</span> <span class="fu">distinct</span>()</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>  telfer <span class="ot">&lt;-</span> sparta<span class="sc">::</span><span class="fu">telfer</span>(<span class="at">taxa =</span> df<span class="sc">$</span>verbatim_name,</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>                         <span class="at">site =</span> df<span class="sc">$</span>cell_label,</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>                         <span class="at">time_period =</span> df<span class="sc">$</span>tp,</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>                         <span class="at">minSite =</span> <span class="dv">1</span>)</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>telfer<span class="sc">$</span>dataset <span class="ot">&lt;-</span> atlas_names[i]</span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>telfer_res[[i]] <span class="ot">&lt;-</span> telfer</span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in errorChecks(taxa = taxa, site = site, time_period = time_period, :
50096 out of 205245 observations will be removed as duplicates</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in errorChecks(taxa = taxa, site = site, time_period = time_period, :
247907 out of 1151694 observations will be removed as duplicates</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in errorChecks(taxa = taxa, site = site, time_period = time_period, :
21056 out of 131398 observations will be removed as duplicates</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in errorChecks(taxa = taxa, site = site, time_period = time_period, :
216762 out of 1275131 observations will be removed as duplicates</code></pre>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>telfer_res_df <span class="ot">&lt;-</span> plyr<span class="sc">::</span><span class="fu">rbind.fill</span>(telfer_res, <span class="at">fill =</span> T) <span class="sc">%&gt;%</span> <span class="fu">distinct</span>() <span class="sc">%&gt;%</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(taxa, Telfer_1_2, dataset) <span class="sc">%&gt;%</span> </span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">verbatim_name =</span> taxa)<span class="sc">%&gt;%</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reorder_levels</span>(dataset, <span class="at">order =</span> atlas_names)</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>species_data_new2 <span class="ot">&lt;-</span> <span class="fu">left_join</span>(species_data_new, telfer_res_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(dataset, verbatim_name)`</code></pre>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">is.na</span>(species_data_new2))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                  dataset                        tp             verbatim_name 
                        0                         0                         0 
            cell_grouping                     scale                Total_area 
                        0                         0                         0 
          Total_area_samp        Total_Ncells_atlas         Total_Ncells_samp 
                        0                         0                         0 
           occupancy_area          occupancy_Ncells                       AOO 
                        0                         0                         0 
  relative_occupancy_area relative_occupancy_Ncells                 mean_area 
                        0                         0                         0 
   total_SR_atlas_AOOcalc                     grain                   exclude 
                        0                         0                         0 
         available_scales               mean_relOcc                   m_AOO_a 
                        0                         0                       315 
                  b_AOO_a                   D_AOO_a                Telfer_1_2 
                      315                       315                         0 </code></pre>
</div>
</div>
</section>
<section id="log-ratio-temporal-change-response" class="level2" data-number="6.4">
<h2 data-number="6.4" class="anchored" data-anchor-id="log-ratio-temporal-change-response"><span class="header-section-number">6.4</span> Log Ratio (Temporal Change = Response)</h2>
<section id="make-wide-format" class="level3" data-number="6.4.1">
<h3 data-number="6.4.1" class="anchored" data-anchor-id="make-wide-format"><span class="header-section-number">6.4.1</span> Make wide-format</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Re-formating the data.. there is probably a smoother way to do it..</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>species_data_wide1 <span class="ot">&lt;-</span> species_data_new2 <span class="sc">%&gt;%</span> </span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(verbatim_name, tp, cell_grouping, </span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>         D_AOO_a, m_AOO_a,</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>         AOO, </span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>         Total_Ncells_samp, mean_area,</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>          occupancy_Ncells, </span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>         relative_occupancy_Ncells, dataset) <span class="sc">%&gt;%</span> </span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(dataset, verbatim_name, tp) <span class="sc">%&gt;%</span> </span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(tp <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">setNames</span>(<span class="fu">paste0</span>(<span class="st">'tp1_'</span>, <span class="fu">names</span>(.))) <span class="sc">%&gt;%</span> </span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(tp1_tp)) <span class="sc">%&gt;%</span></span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">verbatim_name =</span> tp1_verbatim_name,</span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">cell_grouping =</span> tp1_cell_grouping, </span>
<span id="cb62-17"><a href="#cb62-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">dataset =</span> tp1_dataset)</span>
<span id="cb62-18"><a href="#cb62-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-19"><a href="#cb62-19" aria-hidden="true" tabindex="-1"></a>species_data_wide2 <span class="ot">&lt;-</span> species_data_new2 <span class="sc">%&gt;%</span> </span>
<span id="cb62-20"><a href="#cb62-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(verbatim_name, tp, cell_grouping, </span>
<span id="cb62-21"><a href="#cb62-21" aria-hidden="true" tabindex="-1"></a>         D_AOO_a, m_AOO_a,</span>
<span id="cb62-22"><a href="#cb62-22" aria-hidden="true" tabindex="-1"></a>         AOO, </span>
<span id="cb62-23"><a href="#cb62-23" aria-hidden="true" tabindex="-1"></a>         Total_Ncells_samp, mean_area,</span>
<span id="cb62-24"><a href="#cb62-24" aria-hidden="true" tabindex="-1"></a>          occupancy_Ncells, </span>
<span id="cb62-25"><a href="#cb62-25" aria-hidden="true" tabindex="-1"></a>         relative_occupancy_Ncells, dataset) <span class="sc">%&gt;%</span> </span>
<span id="cb62-26"><a href="#cb62-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(dataset, verbatim_name, tp) <span class="sc">%&gt;%</span> </span>
<span id="cb62-27"><a href="#cb62-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb62-28"><a href="#cb62-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(tp <span class="sc">==</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb62-29"><a href="#cb62-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">setNames</span>(<span class="fu">paste0</span>(<span class="st">'tp2_'</span>, <span class="fu">names</span>(.))) <span class="sc">%&gt;%</span> </span>
<span id="cb62-30"><a href="#cb62-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb62-31"><a href="#cb62-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(tp2_tp)) <span class="sc">%&gt;%</span></span>
<span id="cb62-32"><a href="#cb62-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">verbatim_name =</span> tp2_verbatim_name,</span>
<span id="cb62-33"><a href="#cb62-33" aria-hidden="true" tabindex="-1"></a>         <span class="at">cell_grouping =</span> tp2_cell_grouping, </span>
<span id="cb62-34"><a href="#cb62-34" aria-hidden="true" tabindex="-1"></a>         <span class="at">dataset =</span> tp2_dataset)</span>
<span id="cb62-35"><a href="#cb62-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-36"><a href="#cb62-36" aria-hidden="true" tabindex="-1"></a><span class="co"># merge back together:</span></span>
<span id="cb62-37"><a href="#cb62-37" aria-hidden="true" tabindex="-1"></a>temp <span class="ot">&lt;-</span> <span class="fu">merge</span>(species_data_wide1, species_data_wide2, </span>
<span id="cb62-38"><a href="#cb62-38" aria-hidden="true" tabindex="-1"></a>              <span class="at">by=</span><span class="fu">intersect</span>(<span class="fu">names</span>(species_data_wide1), <span class="fu">names</span>(species_data_wide2)), <span class="at">all =</span> T)</span>
<span id="cb62-39"><a href="#cb62-39" aria-hidden="true" tabindex="-1"></a>names_v <span class="ot">&lt;-</span> <span class="fu">names</span>(temp)[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)] <span class="co"># remove verbatim_name, cell_grouping and dataset columns</span></span>
<span id="cb62-40"><a href="#cb62-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-41"><a href="#cb62-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Transform to wide format by cell_grouping</span></span>
<span id="cb62-42"><a href="#cb62-42" aria-hidden="true" tabindex="-1"></a>species_data_wide <span class="ot">&lt;-</span> temp <span class="sc">%&gt;%</span> </span>
<span id="cb62-43"><a href="#cb62-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> cell_grouping,</span>
<span id="cb62-44"><a href="#cb62-44" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from =</span> <span class="fu">all_of</span>(names_v)) <span class="sc">%&gt;%</span> <span class="fu">unique</span>()</span>
<span id="cb62-45"><a href="#cb62-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-46"><a href="#cb62-46" aria-hidden="true" tabindex="-1"></a><span class="do">### =============================================== </span><span class="al">###</span></span>
<span id="cb62-47"><a href="#cb62-47" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(species_data_wide1, species_data_wide2, temp, names_v)</span>
<span id="cb62-48"><a href="#cb62-48" aria-hidden="true" tabindex="-1"></a><span class="do">### =============================================== </span><span class="al">###</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="calculate-log-ratio" class="level3" data-number="6.4.2">
<h3 data-number="6.4.2" class="anchored" data-anchor-id="calculate-log-ratio"><span class="header-section-number">6.4.2</span> Calculate Log Ratio</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate log-Ratio of AOO (Temporal change)</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>log_ratio_data <span class="ot">&lt;-</span> species_data_wide <span class="sc">%&gt;%</span> </span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">log_R2_1 =</span> <span class="fu">log</span>(tp2_AOO_1<span class="sc">/</span>tp1_AOO_1)) <span class="sc">%&gt;%</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(dataset, verbatim_name, log_R2_1, tp1_AOO_1, tp2_AOO_1)</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>species_data_bigtable <span class="ot">&lt;-</span> <span class="fu">merge</span>(species_data_new2, log_ratio_data, <span class="at">by=</span><span class="fu">c</span>(<span class="st">"verbatim_name"</span>, <span class="st">"dataset"</span>),<span class="at">all =</span> T)</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>species_data_bigtable <span class="sc">%&gt;%</span> <span class="fu">write.csv</span>(<span class="at">file=</span><span class="fu">paste0</span>(out_path, <span class="st">"csv/Big_table_CZ_JP_NY_EU.csv"</span>))</span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>Change_Data <span class="ot">&lt;-</span> species_data_bigtable <span class="sc">%&gt;%</span> </span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(log_R2_1)) <span class="sc">%&gt;%</span> </span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(verbatim_name, dataset, log_R2_1, tp1_AOO_1, tp2_AOO_1) <span class="sc">%&gt;%</span> </span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>() <span class="sc">%&gt;%</span></span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reorder_levels</span>(dataset, <span class="at">order =</span> atlas_names)</span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-17"><a href="#cb63-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-18"><a href="#cb63-18" aria-hidden="true" tabindex="-1"></a>Change_Data <span class="sc">%&gt;%</span> </span>
<span id="cb63-19"><a href="#cb63-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">write.csv</span>(<span class="fu">paste0</span>(out_path, <span class="st">"csv/Change_Data.csv"</span>))</span>
<span id="cb63-20"><a href="#cb63-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-21"><a href="#cb63-21" aria-hidden="true" tabindex="-1"></a>Change_Data <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">log_R2_1 =</span> <span class="fu">round</span>(log_R2_1, <span class="dv">3</span>),</span>
<span id="cb63-22"><a href="#cb63-22" aria-hidden="true" tabindex="-1"></a>                       <span class="at">tp1_AOO_1 =</span> <span class="fu">round</span>(tp1_AOO_1, <span class="dv">3</span>),</span>
<span id="cb63-23"><a href="#cb63-23" aria-hidden="true" tabindex="-1"></a>                       <span class="at">tp2_AOO_1 =</span> <span class="fu">round</span>(tp2_AOO_1, <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                     verbatim_name              dataset log_R2_1   tp1_AOO_1
1                 Acanthis flammea     Birds_atlas_EBBA    0.379 2306868.125
2               Accipiter brevipes     Birds_atlas_EBBA    0.655  275708.324
3               Accipiter cooperii Birds_Atlas_New_York    0.901   13753.131
4               Accipiter gentilis  Birds_Atlas_Czechia   -0.025   77122.382
5               Accipiter gentilis     Birds_atlas_EBBA    0.193 5565090.875
6               Accipiter gentilis    Birds_atlas_Japan   -0.082   22891.286
7               Accipiter gentilis Birds_Atlas_New_York   -0.224   11106.004
8                Accipiter gularis    Birds_atlas_Japan   -0.266    9655.195
9                  Accipiter nisus  Birds_Atlas_Czechia    0.046   76442.668
10                 Accipiter nisus     Birds_atlas_EBBA    0.178 6132326.361
11                 Accipiter nisus    Birds_atlas_Japan   -0.869   18240.807
12              Accipiter striatus Birds_Atlas_New_York    0.516   21479.825
13       Acridotheres cristatellus     Birds_atlas_EBBA    0.693    2501.970
14           Acrocephalus agricola     Birds_atlas_EBBA    1.161  145129.695
15       Acrocephalus arundinaceus  Birds_Atlas_Czechia    0.058   31809.557
16       Acrocephalus arundinaceus     Birds_atlas_EBBA    0.223 4011494.586
17       Acrocephalus bistrigiceps    Birds_atlas_Japan   -0.596   38666.182
18          Acrocephalus dumetorum     Birds_atlas_EBBA    1.251  638277.259
19        Acrocephalus melanopogon     Birds_atlas_EBBA    0.209  344493.745
20         Acrocephalus orientalis    Birds_atlas_Japan    0.003  101880.470
21         Acrocephalus paludicola     Birds_atlas_EBBA   -0.225  156261.697
22          Acrocephalus palustris  Birds_Atlas_Czechia    0.061   72444.841
23          Acrocephalus palustris     Birds_atlas_EBBA    0.275 3545937.518
24      Acrocephalus schoenobaenus  Birds_Atlas_Czechia    0.197   37050.276
25      Acrocephalus schoenobaenus     Birds_atlas_EBBA    0.229 4685838.913
26         Acrocephalus scirpaceus  Birds_Atlas_Czechia    0.041   57987.256
27         Acrocephalus scirpaceus     Birds_atlas_EBBA    0.249 4322520.520
28              Actitis hypoleucos  Birds_Atlas_Czechia    0.004   34497.735
29              Actitis hypoleucos     Birds_atlas_EBBA    0.250 4897714.918
30              Actitis hypoleucos    Birds_atlas_Japan   -0.434   45314.502
31              Actitis macularius Birds_Atlas_New_York   -0.134   50563.653
32             Aegithalos caudatus  Birds_Atlas_Czechia    0.036   76161.041
33             Aegithalos caudatus     Birds_atlas_EBBA    0.219 5586154.729
34             Aegithalos caudatus    Birds_atlas_Japan   -0.095  219862.453
35               Aegolius acadicus Birds_Atlas_New_York    0.124    3226.739
36               Aegolius funereus  Birds_Atlas_Czechia    0.472   19509.497
37               Aegolius funereus     Birds_atlas_EBBA    0.280 2328994.823
38               Aegypius monachus     Birds_atlas_EBBA    0.177  169538.469
39             Agelaius phoeniceus Birds_Atlas_New_York   -0.018  126532.915
40           Agropsar philippensis    Birds_atlas_Japan    0.083   32106.175
41                Aix galericulata     Birds_atlas_EBBA    1.830  130325.056
42                Aix galericulata    Birds_atlas_Japan    0.270   21901.172
43                      Aix sponsa     Birds_atlas_EBBA    2.166   16691.251
44                      Aix sponsa Birds_Atlas_New_York    0.370   48088.507
45                 Alauda arvensis  Birds_Atlas_Czechia   -0.003   83776.380
46                 Alauda arvensis     Birds_atlas_EBBA    0.097 6644243.314
47                 Alauda arvensis    Birds_atlas_Japan   -0.003  146463.478
48               Alauda leucoptera     Birds_atlas_EBBA    2.551    7505.010
49              Alaudala rufescens     Birds_atlas_EBBA    0.667  187424.966
50                      Alca torda     Birds_atlas_EBBA    0.080  550973.506
51                   Alcedo atthis  Birds_Atlas_Czechia    0.238   53216.143
52                   Alcedo atthis     Birds_atlas_EBBA    0.094 4818427.318
53                   Alcedo atthis    Birds_atlas_Japan   -0.093   91207.368
54               Alectoris barbara     Birds_atlas_EBBA    0.048   51014.443
55                Alectoris chukar     Birds_atlas_EBBA    0.570  227175.341
56                Alectoris graeca     Birds_atlas_EBBA   -0.153  587556.638
57                  Alectoris rufa     Birds_atlas_EBBA    0.113 1468080.847
58                       Alle alle     Birds_atlas_EBBA    0.104  132658.386
59            Alopochen aegyptiaca     Birds_atlas_EBBA    2.503   89274.085
60               Amandava amandava     Birds_atlas_EBBA    0.986   30525.577
61          Amaurornis phoenicurus    Birds_atlas_Japan   -0.239    6491.487
62           Ammodramus caudacutus Birds_Atlas_New_York   -0.166    1800.182
63            Ammodramus henslowii Birds_Atlas_New_York   -1.603    8697.941
64            Ammodramus maritimus Birds_Atlas_New_York   -0.288    1200.226
65           Ammodramus savannarum Birds_Atlas_New_York   -0.544   20550.166
66                      Anas acuta  Birds_Atlas_Czechia    0.001    1341.092
67                      Anas acuta     Birds_atlas_EBBA    0.112 1601190.995
68                      Anas acuta Birds_Atlas_New_York   -1.253     875.178
69                  Anas americana Birds_Atlas_New_York   -0.647    1050.005
70                   Anas clypeata  Birds_Atlas_Czechia   -0.085   17930.257
71                   Anas clypeata    Birds_atlas_Japan   -0.699    2440.637
72                   Anas clypeata Birds_Atlas_New_York    0.274     475.057
73                     Anas crecca  Birds_Atlas_Czechia   -0.180   32078.550
74                     Anas crecca     Birds_atlas_EBBA    0.246 4046600.368
75                     Anas crecca    Birds_atlas_Japan   -0.197    6053.142
76                     Anas crecca Birds_Atlas_New_York   -0.598    3000.338
77                    Anas discors Birds_Atlas_New_York   -1.001   11500.814
78                    Anas falcata    Birds_atlas_Japan    0.390    2391.984
79              Anas platyrhynchos  Birds_Atlas_Czechia    0.023   79503.306
80              Anas platyrhynchos     Birds_atlas_EBBA    0.234 6748879.048
81              Anas platyrhynchos    Birds_atlas_Japan   -0.012   39147.675
82              Anas platyrhynchos Birds_Atlas_New_York    0.236   79520.062
83                Anas querquedula  Birds_Atlas_Czechia    0.032   25142.243
84                   Anas rubripes Birds_Atlas_New_York   -0.416   27562.592
85                   Anas strepera  Birds_Atlas_Czechia    0.321   26527.678
86                   Anas strepera    Birds_atlas_Japan    1.178     371.843
87                   Anas strepera Birds_Atlas_New_York    0.009    2850.359
88                Anas zonorhyncha    Birds_atlas_Japan    0.304  127643.780
89                  Anous stolidus    Birds_atlas_Japan    0.000     466.860
90                 Anser albifrons     Birds_atlas_EBBA    2.446   13963.967
91                     Anser anser  Birds_Atlas_Czechia    0.720    6472.622
92                     Anser anser     Birds_atlas_EBBA    0.655 1892926.229
93            Anser brachyrhynchus     Birds_atlas_EBBA    0.229  134983.525
94                Anser erythropus     Birds_atlas_EBBA   -0.949   99753.390
95                   Anser fabalis     Birds_atlas_EBBA    0.376  530521.494
96              Anthropoides virgo     Birds_atlas_EBBA    0.964   97793.548
97              Anthus berthelotii     Birds_atlas_EBBA    0.000   12502.718
98               Anthus campestris  Birds_Atlas_Czechia   -0.362    2668.230
99               Anthus campestris     Birds_atlas_EBBA    0.149 2674626.901
100                Anthus cervinus     Birds_atlas_EBBA    0.403  215295.665
101                Anthus hodgsoni     Birds_atlas_EBBA    0.676  179920.658
102                Anthus hodgsoni    Birds_atlas_Japan   -0.448   53960.848
103                Anthus petrosus     Birds_atlas_EBBA   -0.004  807294.208
104               Anthus pratensis  Birds_Atlas_Czechia    0.036   43145.875
105               Anthus pratensis     Birds_atlas_EBBA    0.144 4221762.772
106              Anthus spinoletta  Birds_Atlas_Czechia   -0.155    1857.729
107              Anthus spinoletta     Birds_atlas_EBBA    0.052  839307.414
108               Anthus trivialis  Birds_Atlas_Czechia   -0.008   81375.013
109               Anthus trivialis     Birds_atlas_EBBA    0.218 5594787.815
110          Apalopteron familiare    Birds_atlas_Japan    0.000     919.124
111                      Apus apus  Birds_Atlas_Czechia    0.015   80692.959
112                      Apus apus     Birds_atlas_EBBA    0.189 6569864.152
113                    Apus caffer     Birds_atlas_EBBA    1.229   39599.467
114                Apus nipalensis    Birds_atlas_Japan   -0.770   10151.252
115                 Apus pacificus    Birds_atlas_Japan   -0.507   51440.204
116                  Apus pallidus     Birds_atlas_EBBA    0.706  576132.002
117                  Apus unicolor     Birds_atlas_EBBA    0.000    7500.017
118               Aquila adalberti     Birds_atlas_EBBA    0.494  124077.951
119              Aquila chrysaetos     Birds_atlas_EBBA    0.309 2239870.830
120              Aquila chrysaetos Birds_Atlas_New_York    0.118     200.095
121                Aquila fasciata     Birds_atlas_EBBA   -0.051  664276.376
122                 Aquila heliaca     Birds_atlas_EBBA    0.557  262122.584
123              Aquila nipalensis     Birds_atlas_EBBA    1.110   48374.287
124                Aquila pomarina  Birds_Atlas_Czechia    0.072    1872.107
125           Archilochus colubris Birds_Atlas_New_York    0.188   87973.952
126                     Ardea alba     Birds_atlas_EBBA    1.514  408834.669
127                     Ardea alba    Birds_atlas_Japan    0.443   61757.416
128                     Ardea alba Birds_Atlas_New_York    0.535    1625.041
129                  Ardea cinerea  Birds_Atlas_Czechia    0.460   33597.752
130                  Ardea cinerea     Birds_atlas_EBBA    0.297 4470343.894
131                  Ardea cinerea    Birds_atlas_Japan    0.202  175377.808
132                 Ardea herodias Birds_Atlas_New_York    0.182   79146.769
133                 Ardea purpurea  Birds_Atlas_Czechia    0.641    1352.722
134                 Ardea purpurea     Birds_atlas_EBBA    0.368 1368971.718
135                 Ardea purpurea    Birds_atlas_Japan   -1.388    1872.311
136              Ardeola ralloides     Birds_atlas_EBBA    0.526  464086.601
137             Arenaria interpres     Birds_atlas_EBBA    0.143  488983.162
138                  Asio flammeus  Birds_Atlas_Czechia    0.955     670.134
139                  Asio flammeus     Birds_atlas_EBBA    0.338 2420233.974
140                  Asio flammeus Birds_Atlas_New_York   -0.405     900.211
141                      Asio otus  Birds_Atlas_Czechia   -0.011   66550.195
142                      Asio otus     Birds_atlas_EBBA    0.182 5526059.116
143                      Asio otus    Birds_atlas_Japan   -0.675     798.528
144                      Asio otus Birds_Atlas_New_York   -0.523    2025.471
145                  Athene noctua  Birds_Atlas_Czechia   -0.936   57212.947
146                  Athene noctua     Birds_atlas_EBBA    0.049 4542940.652
147                 Aythya affinis Birds_Atlas_New_York   -0.406      75.019
148               Aythya americana Birds_Atlas_New_York    0.559     200.123
149                Aythya collaris Birds_Atlas_New_York    0.725    1175.810
150                  Aythya ferina  Birds_Atlas_Czechia   -0.091   51874.604
151                  Aythya ferina     Birds_atlas_EBBA    0.205 3294393.355
152                  Aythya ferina    Birds_atlas_Japan   -0.947    5265.202
153                Aythya fuligula  Birds_Atlas_Czechia    0.018   58944.920
154                Aythya fuligula     Birds_atlas_EBBA    0.201 3860794.585
155                Aythya fuligula    Birds_atlas_Japan   -0.338    6414.420
156                  Aythya marila     Birds_atlas_EBBA   -0.268  780289.540
157                  Aythya nyroca  Birds_Atlas_Czechia   -0.801    2410.384
158                  Aythya nyroca     Birds_atlas_EBBA    0.263  797216.660
159             Aythya valisineria Birds_Atlas_New_York    0.000      25.008
160             Baeolophus bicolor Birds_Atlas_New_York    0.695   38937.089
161         Bambusicola thoracicus    Birds_atlas_Japan   -0.137  124151.281
162           Bartramia longicauda Birds_Atlas_New_York   -1.059   11902.795
163            Bombycilla cedrorum Birds_Atlas_New_York    0.021  122884.232
164            Bombycilla garrulus     Birds_atlas_EBBA    1.171  494990.627
165                 Bonasa bonasia  Birds_Atlas_Czechia    0.027    9167.117
166                 Bonasa bonasia     Birds_atlas_EBBA    0.321 2400808.427
167                Bonasa umbellus Birds_Atlas_New_York   -0.203   78808.232
168          Botaurus lentiginosus Birds_Atlas_New_York   -0.111   13356.035
169             Botaurus stellaris  Birds_Atlas_Czechia    0.362    6146.504
170             Botaurus stellaris     Birds_atlas_EBBA    0.431 2309339.365
171                Branta bernicla     Birds_atlas_EBBA   -0.121   89510.440
172              Branta canadensis     Birds_atlas_EBBA    0.577 1062709.657
173              Branta canadensis Birds_Atlas_New_York    1.321   26457.095
174               Branta leucopsis     Birds_atlas_EBBA    1.801  170637.736
175                      Bubo bubo  Birds_Atlas_Czechia    0.010   52523.906
176                      Bubo bubo     Birds_atlas_EBBA    0.302 3158402.687
177                Bubo scandiacus     Birds_atlas_EBBA   -1.347  267421.358
178               Bubo virginianus Birds_Atlas_New_York   -0.193   49187.542
179                  Bubulcus ibis     Birds_atlas_EBBA    1.710  174428.999
180                  Bubulcus ibis    Birds_atlas_Japan   -0.995   44505.338
181                  Bubulcus ibis Birds_Atlas_New_York   -1.049     500.055
182          Bucanetes githagineus     Birds_atlas_EBBA    0.636   17509.429
183           Bucanetes mongolicus     Birds_atlas_EBBA    0.916    5003.650
184             Bucephala clangula  Birds_Atlas_Czechia    0.711    2966.442
185             Bucephala clangula     Birds_atlas_EBBA    0.519 1951037.127
186             Bucephala clangula Birds_Atlas_New_York    0.256     600.392
187            Bucephala islandica     Birds_atlas_EBBA    0.992    5765.041
188              Bulweria bulwerii     Birds_atlas_EBBA    0.000   17504.554
189            Burhinus oedicnemus     Birds_atlas_EBBA    0.086 1472833.732
190               Butastur indicus    Birds_atlas_Japan   -0.325   66252.449
191                    Buteo buteo  Birds_Atlas_Czechia   -0.002   83775.554
192                    Buteo buteo     Birds_atlas_EBBA    0.224 6313373.461
193                    Buteo buteo    Birds_atlas_Japan    0.325   38699.574
194              Buteo jamaicensis Birds_Atlas_New_York    0.062   92869.752
195                  Buteo lagopus     Birds_atlas_EBBA    0.167  896215.448
196                 Buteo lineatus Birds_Atlas_New_York    0.209   17552.238
197              Buteo platypterus Birds_Atlas_New_York    0.007   48596.690
198                  Buteo rufinus     Birds_atlas_EBBA    1.403  292682.658
199              Butorides striata    Birds_atlas_Japan   -0.880   18117.590
200            Butorides virescens Birds_Atlas_New_York   -0.140   63610.165
201      Calandrella brachydactyla     Birds_atlas_EBBA    0.015 1540610.446
202           Calcarius lapponicus     Birds_atlas_EBBA    0.247  438897.591
203                  Calidris alba     Birds_atlas_EBBA   -0.288   20014.774
204                Calidris alpina     Birds_atlas_EBBA   -0.188 1106495.777
205               Calidris canutus     Birds_atlas_EBBA    1.099    2501.991
206           Calidris falcinellus     Birds_atlas_EBBA   -0.201  378476.711
207              Calidris maritima     Birds_atlas_EBBA   -0.113  507646.073
208             Calidris melanotos     Birds_atlas_EBBA    1.220    2501.665
209                Calidris minuta     Birds_atlas_EBBA    0.603   58065.638
210                Calidris pugnax     Birds_atlas_EBBA   -0.271 1610935.298
211            Calidris temminckii     Birds_atlas_EBBA    0.177  429111.655
212              Calliope calliope     Birds_atlas_EBBA   -0.907   69475.735
213         Callipepla californica     Birds_atlas_EBBA    0.000    2501.935
214           Calonectris borealis     Birds_atlas_EBBA    0.262   50020.176
215           Calonectris diomedea     Birds_atlas_EBBA   -0.045  171269.206
216         Calonectris leucomelas    Birds_atlas_Japan   -0.281    1685.304
217       Caprimulgus carolinensis Birds_Atlas_New_York   -0.965     524.943
218          Caprimulgus europaeus  Birds_Atlas_Czechia   -0.465   19392.410
219          Caprimulgus europaeus     Birds_atlas_EBBA    0.209 4582327.180
220            Caprimulgus indicus    Birds_atlas_Japan    0.784    7346.389
221         Caprimulgus ruficollis     Birds_atlas_EBBA    0.243  335691.716
222          Caprimulgus vociferus Birds_Atlas_New_York   -0.854   14107.096
223          Cardinalis cardinalis Birds_Atlas_New_York    0.085   89386.129
224            Carduelis cannabina  Birds_Atlas_Czechia    0.040   77264.417
225            Carduelis carduelis  Birds_Atlas_Czechia    0.008   82574.922
226            Carduelis carduelis     Birds_atlas_EBBA    0.210 6128797.085
227              Carduelis chloris  Birds_Atlas_Czechia    0.002   83773.640
228           Carduelis citrinella     Birds_atlas_EBBA    0.035  357000.237
229            Carduelis corsicana     Birds_atlas_EBBA   -0.128   62545.807
230              Carduelis flammea  Birds_Atlas_Czechia    0.114   33131.819
231               Carduelis spinus  Birds_Atlas_Czechia    0.028   61436.483
232               Carduelis spinus    Birds_atlas_Japan   -0.409    9050.586
233          Carpodacus erythrinus  Birds_Atlas_Czechia    0.195   13625.802
234          Carpodacus erythrinus     Birds_atlas_EBBA    0.534 2416674.860
235           Carpodacus mexicanus Birds_Atlas_New_York    0.175   71793.484
236           Carpodacus purpureus Birds_Atlas_New_York    0.004   78700.238
237           Carpodacus rubicilla     Birds_atlas_EBBA    2.465    5003.576
238                Catharacta skua     Birds_atlas_EBBA    0.376  182169.944
239                 Cathartes aura Birds_Atlas_New_York    0.536   53662.442
240             Catharus bicknelli Birds_Atlas_New_York    0.379     975.652
241            Catharus fuscescens Birds_Atlas_New_York   -0.027  106660.742
242              Catharus guttatus Birds_Atlas_New_York    0.266   52204.331
243             Catharus ustulatus Birds_Atlas_New_York   -0.182   17586.814
244               Cecropis daurica     Birds_atlas_EBBA    0.477  910351.867
245                  Cepphus carbo    Birds_atlas_Japan    0.685     376.937
246                 Cepphus grylle     Birds_atlas_EBBA    0.072  868616.316
247        Cercotrichas galactotes     Birds_atlas_EBBA   -0.299  332394.681
248          Cerorhinca monocerata    Birds_atlas_Japan   -1.110    1121.627
249              Certhia americana Birds_Atlas_New_York    0.048   50923.276
250          Certhia brachydactyla  Birds_Atlas_Czechia    0.069   54380.504
251          Certhia brachydactyla     Birds_atlas_EBBA    0.091 3114146.526
252             Certhia familiaris  Birds_Atlas_Czechia    0.068   74156.253
253             Certhia familiaris     Birds_atlas_EBBA    0.253 4334218.481
254             Certhia familiaris    Birds_atlas_Japan    0.942   11738.085
255                   Cettia cetti     Birds_atlas_EBBA    0.282 1931883.637
256                 Cettia diphone    Birds_atlas_Japan    0.010  424583.367
257              Chaetura pelagica Birds_Atlas_New_York   -0.164   78072.442
258             Chalcophaps indica    Birds_atlas_Japan    0.470    2339.177
259        Charadrius alexandrinus     Birds_atlas_EBBA    0.195  805847.690
260        Charadrius alexandrinus    Birds_atlas_Japan   -0.871    8744.217
261           Charadrius asiaticus     Birds_atlas_EBBA   -1.826   62133.351
262              Charadrius dubius  Birds_Atlas_Czechia    0.038   48252.174
263              Charadrius dubius     Birds_atlas_EBBA    0.260 5037575.554
264              Charadrius dubius    Birds_atlas_Japan   -0.100   46332.613
265           Charadrius hiaticula     Birds_atlas_EBBA    0.135 2063449.961
266       Charadrius leschenaultii     Birds_atlas_EBBA    1.609    2501.955
267             Charadrius melodus Birds_Atlas_New_York    0.027    1849.870
268          Charadrius morinellus  Birds_Atlas_Czechia   -0.700     263.629
269            Charadrius placidus    Birds_atlas_Japan    0.125   15433.597
270           Charadrius vociferus Birds_Atlas_New_York   -0.042   98493.600
271           Chersophilus duponti     Birds_atlas_EBBA    0.251   97438.072
272             Chlidonias hybrida     Birds_atlas_EBBA    0.777  661949.701
273         Chlidonias leucopterus     Birds_atlas_EBBA    0.574  589092.807
274               Chlidonias niger  Birds_Atlas_Czechia   -0.318    8845.810
275               Chlidonias niger     Birds_atlas_EBBA    0.001 1785847.314
276               Chlidonias niger Birds_Atlas_New_York   -0.506    1825.486
277                Chloris chloris     Birds_atlas_EBBA    0.170 6845348.223
278                 Chloris sinica    Birds_atlas_Japan   -0.007  346986.242
279               Chordeiles minor Birds_Atlas_New_York   -1.240   11926.203
280        Chrysolophus amherstiae     Birds_atlas_EBBA   -0.032    5449.058
281            Chrysolophus pictus     Birds_atlas_EBBA   -0.593   41149.068
282                Ciconia ciconia  Birds_Atlas_Czechia    0.048   57424.414
283                Ciconia ciconia     Birds_atlas_EBBA    0.228 3113232.399
284                  Ciconia nigra  Birds_Atlas_Czechia    0.235   52175.028
285                  Ciconia nigra     Birds_atlas_EBBA    0.348 1845142.403
286                Cinclus cinclus  Birds_Atlas_Czechia    0.040   52106.663
287                Cinclus cinclus     Birds_atlas_EBBA    0.092 3187712.961
288               Cinclus pallasii    Birds_atlas_Japan    0.048   91000.454
289             Circaetus gallicus     Birds_atlas_EBBA    0.382 1760535.394
290             Circus aeruginosus  Birds_Atlas_Czechia    0.286   49704.994
291             Circus aeruginosus     Birds_atlas_EBBA    0.373 3803372.301
292                 Circus cyaneus  Birds_Atlas_Czechia   -0.039   23192.268
293                 Circus cyaneus     Birds_atlas_EBBA   -0.016 2611891.552
294                 Circus cyaneus Birds_Atlas_New_York   -0.014   23254.334
295               Circus macrourus     Birds_atlas_EBBA    0.636  113003.045
296                Circus pygargus  Birds_Atlas_Czechia    0.836    6161.505
297                Circus pygargus     Birds_atlas_EBBA    0.309 2618851.547
298              Circus spilonotus    Birds_atlas_Japan   -0.167    4557.422
299             Cisticola juncidis     Birds_atlas_EBBA    0.240 1340049.221
300             Cisticola juncidis    Birds_atlas_Japan   -0.148   78477.187
301          Cistothorus palustris Birds_Atlas_New_York    0.049   10977.269
302          Cistothorus platensis Birds_Atlas_New_York    0.233    1425.529
303            Clamator glandarius     Birds_atlas_EBBA    0.227  568454.297
304                  Clanga clanga     Birds_atlas_EBBA    0.681  152523.343
305                Clanga pomarina     Birds_atlas_EBBA    0.416 1099980.403
306              Clangula hyemalis     Birds_atlas_EBBA   -0.037  659994.273
307  Coccothraustes coccothraustes  Birds_Atlas_Czechia    0.079   72943.422
308  Coccothraustes coccothraustes     Birds_atlas_EBBA    0.272 4320983.813
309  Coccothraustes coccothraustes    Birds_atlas_Japan   -0.071   34321.671
310     Coccothraustes vespertinus Birds_Atlas_New_York    0.359    6253.993
311            Coccyzus americanus Birds_Atlas_New_York    0.031   32033.615
312       Coccyzus erythropthalmus Birds_Atlas_New_York    0.034   49084.758
313               Colaptes auratus Birds_Atlas_New_York   -0.008  122458.076
314            Colinus virginianus     Birds_atlas_EBBA   -0.236   47527.635
315            Colinus virginianus Birds_Atlas_New_York   -0.299    5900.430
316               Columba janthina    Birds_atlas_Japan   -0.058    9308.391
317                  Columba livia  Birds_Atlas_Czechia    0.012   65436.001
318                  Columba livia     Birds_atlas_EBBA    0.309 5803968.260
319                  Columba livia    Birds_atlas_Japan    0.157   57960.325
320                  Columba livia Birds_Atlas_New_York   -0.008   94292.799
321                  Columba oenas  Birds_Atlas_Czechia    0.323   41984.888
322                  Columba oenas     Birds_atlas_EBBA    0.134 4031204.411
323               Columba palumbus  Birds_Atlas_Czechia    0.013   82579.538
324               Columba palumbus     Birds_atlas_EBBA    0.218 6561386.730
325                 Columba trocaz     Birds_atlas_EBBA    0.000    4998.945
326               Contopus cooperi Birds_Atlas_New_York   -0.422   11983.644
327                Contopus virens Birds_Atlas_New_York   -0.044  113430.195
328              Coracias garrulus     Birds_atlas_EBBA   -0.029 1885223.280
329          Corvus brachyrhynchos Birds_Atlas_New_York    0.008  123956.770
330                   Corvus corax  Birds_Atlas_Czechia    0.694   37784.116
331                   Corvus corax     Birds_atlas_EBBA    0.357 6048040.940
332                   Corvus corax Birds_Atlas_New_York    1.791    7830.059
333                  Corvus corone  Birds_Atlas_Czechia   -0.026   78978.350
334                  Corvus corone     Birds_atlas_EBBA    0.222 7185599.220
335                  Corvus corone    Birds_atlas_Japan   -0.030  331362.888
336              Corvus frugilegus  Birds_Atlas_Czechia   -0.180   11330.494
337              Corvus frugilegus     Birds_atlas_EBBA    0.231 3566573.216
338           Corvus macrorhynchos    Birds_atlas_Japan    0.067  380774.387
339                Corvus monedula  Birds_Atlas_Czechia   -0.339   53459.908
340                Corvus monedula     Birds_atlas_EBBA    0.171 6062590.013
341              Corvus ossifragus Birds_Atlas_New_York    0.434    5251.524
342              Coturnix coturnix  Birds_Atlas_Czechia    0.301   58081.840
343              Coturnix coturnix     Birds_atlas_EBBA    0.285 4978889.742
344                      Crex crex  Birds_Atlas_Czechia    0.659   26728.866
345                      Crex crex     Birds_atlas_EBBA    0.367 3427787.086
346                Cuculus canorus  Birds_Atlas_Czechia    0.008   82705.493
347                Cuculus canorus     Birds_atlas_EBBA    0.227 6984814.007
348                Cuculus canorus    Birds_atlas_Japan    0.035  134447.944
349            Cuculus micropterus    Birds_atlas_Japan    2.048     433.044
350                Cuculus optatus    Birds_atlas_Japan    0.082  214542.171
351          Cuculus poliocephalus    Birds_atlas_Japan    0.288  187211.511
352              Cuculus saturatus     Birds_atlas_EBBA    0.054  559401.653
353              Cyanecula svecica     Birds_atlas_EBBA    0.571 2219823.191
354            Cyanistes caeruleus     Birds_atlas_EBBA    0.148 6475912.766
355               Cyanistes cyanus     Birds_atlas_EBBA    1.149   27517.839
356           Cyanistes teneriffae     Birds_atlas_EBBA    0.000    1770.275
357            Cyanocitta cristata Birds_Atlas_New_York    0.003  128860.606
358                Cyanopica cooki     Birds_atlas_EBBA    0.107  272188.130
359               Cyanopica cyanus    Birds_atlas_Japan   -0.467   22307.786
360         Cyanoptila cyanomelana    Birds_atlas_Japan    0.085  257907.935
361             Cygnus columbianus     Birds_atlas_EBBA    0.130   84220.174
362                  Cygnus cygnus     Birds_atlas_EBBA    0.792 1075568.131
363                    Cygnus olor  Birds_Atlas_Czechia   -0.001   60107.188
364                    Cygnus olor     Birds_atlas_EBBA    0.407 3217469.310
365                    Cygnus olor    Birds_atlas_Japan    1.064    1287.558
366                    Cygnus olor Birds_Atlas_New_York    0.624    5451.141
367               Delichon dasypus    Birds_atlas_Japan   -0.250  112085.502
368                Delichon urbica  Birds_Atlas_Czechia    0.000   83774.458
369               Delichon urbicum     Birds_atlas_EBBA    0.117 7003864.072
370             Dendrocopos kizuki    Birds_atlas_Japan    0.043  326546.835
371           Dendrocopos leucotos  Birds_Atlas_Czechia   -0.027    4987.318
372           Dendrocopos leucotos     Birds_atlas_EBBA    0.550 1125397.070
373           Dendrocopos leucotos    Birds_atlas_Japan    0.491   31862.767
374              Dendrocopos major  Birds_Atlas_Czechia    0.008   83108.723
375              Dendrocopos major     Birds_atlas_EBBA    0.253 6195058.930
376              Dendrocopos major    Birds_atlas_Japan    0.050  163558.163
377             Dendrocopos medius  Birds_Atlas_Czechia    0.340   23848.260
378              Dendrocopos minor  Birds_Atlas_Czechia    0.093   60545.470
379              Dendrocopos minor    Birds_atlas_Japan   -0.593    2682.498
380           Dendrocopos syriacus  Birds_Atlas_Czechia    0.834    4455.767
381           Dendrocopos syriacus     Birds_atlas_EBBA    0.410 1360667.922
382         Dendroica caerulescens Birds_Atlas_New_York    0.096   43451.186
383             Dendroica castanea Birds_Atlas_New_York   -0.981     800.592
384              Dendroica cerulea Birds_Atlas_New_York   -0.134    6974.884
385             Dendroica coronata Birds_Atlas_New_York    0.300   52356.030
386             Dendroica discolor Birds_Atlas_New_York    0.180   18283.007
387             Dendroica dominica Birds_Atlas_New_York    0.511      74.995
388                Dendroica fusca Birds_Atlas_New_York    0.174   42795.699
389             Dendroica magnolia Birds_Atlas_New_York    0.228   42042.174
390             Dendroica palmarum Birds_Atlas_New_York    3.761      25.021
391         Dendroica pensylvanica Birds_Atlas_New_York    0.093   90858.090
392             Dendroica petechia Birds_Atlas_New_York    0.000  114501.193
393                Dendroica pinus Birds_Atlas_New_York    1.161    8704.343
394              Dendroica striata Birds_Atlas_New_York   -0.083    3127.190
395              Dendroica tigrina Birds_Atlas_New_York   -0.251     450.327
396               Dendroica virens Birds_Atlas_New_York    0.250   59372.891
397          Dolichonyx oryzivorus Birds_Atlas_New_York   -0.086   86616.011
398                Dryobates minor     Birds_atlas_EBBA    0.254 4886928.915
399              Dryocopus martius  Birds_Atlas_Czechia    0.041   76824.359
400              Dryocopus martius     Birds_atlas_EBBA    0.329 4025665.063
401              Dryocopus martius    Birds_atlas_Japan    0.571   11661.490
402             Dryocopus pileatus Birds_Atlas_New_York    0.251   67853.334
403         Dumetella carolinensis Birds_Atlas_New_York   -0.037  123005.430
404               Egretta caerulea Birds_Atlas_New_York   -0.054     475.030
405               Egretta garzetta  Birds_Atlas_Czechia    2.394     136.030
406               Egretta garzetta     Birds_atlas_EBBA    0.912  815683.462
407               Egretta garzetta    Birds_atlas_Japan   -0.878   84246.649
408             Egretta intermedia    Birds_atlas_Japan   -0.240   34729.911
409                  Egretta sacra    Birds_atlas_Japan   -0.530    6668.905
410                  Egretta thula Birds_Atlas_New_York   -0.483    2350.045
411               Egretta tricolor Birds_Atlas_New_York    0.167     275.079
412               Elanus caeruleus     Birds_atlas_EBBA    0.753  186752.662
413               Emberiza aureola     Birds_atlas_EBBA    0.176  193545.645
414             Emberiza bruniceps     Birds_atlas_EBBA    2.879    5003.277
415                Emberiza caesia     Birds_atlas_EBBA   -0.698  249084.741
416              Emberiza calandra     Birds_atlas_EBBA    0.172 4255627.080
417                   Emberiza cia     Birds_atlas_EBBA    0.137 1603436.715
418             Emberiza cineracea     Birds_atlas_EBBA    0.087   16052.777
419               Emberiza cioides    Birds_atlas_Japan   -0.016  371043.414
420                Emberiza cirlus     Birds_atlas_EBBA    0.093 2233704.611
421            Emberiza citrinella  Birds_Atlas_Czechia    0.000   83907.509
422            Emberiza citrinella     Birds_atlas_EBBA    0.130 5765034.982
423                Emberiza fucata    Birds_atlas_Japan    0.074   35280.765
424             Emberiza hortulana  Birds_Atlas_Czechia   -0.181    6386.120
425             Emberiza hortulana     Birds_atlas_EBBA   -0.012 3421450.768
426         Emberiza melanocephala     Birds_atlas_EBBA    0.498  690243.578
427               Emberiza pallasi     Birds_atlas_EBBA    0.306   27933.511
428               Emberiza pusilla     Birds_atlas_EBBA    1.320  242873.100
429               Emberiza rustica     Birds_atlas_EBBA   -0.332 1772130.501
430           Emberiza schoeniclus  Birds_Atlas_Czechia    0.079   61775.625
431           Emberiza schoeniclus     Birds_atlas_EBBA    0.190 5416479.714
432           Emberiza schoeniclus    Birds_atlas_Japan   -0.363   12394.458
433          Emberiza spodocephala    Birds_atlas_Japan   -0.139  145132.480
434            Emberiza sulphurata    Birds_atlas_Japan    0.224   28625.452
435            Emberiza variabilis    Birds_atlas_Japan    0.440   30531.725
436            Emberiza yessoensis    Birds_atlas_Japan   -0.379    2398.558
437              Empidonax alnorum Birds_Atlas_New_York    0.373   48239.704
438         Empidonax flaviventris Birds_Atlas_New_York    0.348    4803.543
439              Empidonax minimus Birds_Atlas_New_York   -0.041   95481.286
440             Empidonax traillii Birds_Atlas_New_York    0.304   48303.005
441            Empidonax virescens Birds_Atlas_New_York    0.389    4049.293
442              Eophona personata    Birds_atlas_Japan    0.149  174752.350
443           Eremophila alpestris     Birds_atlas_EBBA    0.488  334907.430
444           Eremophila alpestris Birds_Atlas_New_York   -0.458   27599.246
445             Erithacus rubecula  Birds_Atlas_Czechia    0.006   83244.995
446             Erithacus rubecula     Birds_atlas_EBBA    0.207 6609208.540
447               Estrilda astrild     Birds_atlas_EBBA    1.006  106065.275
448               Estrilda melpoda     Birds_atlas_EBBA    0.636    2815.404
449           Eudromias morinellus     Birds_atlas_EBBA    0.006  471857.626
450             Euphagus carolinus Birds_Atlas_New_York   -0.255    3777.830
451          Eurystomus orientalis    Birds_atlas_Japan   -0.360    4206.655
452         Falcipennis canadensis Birds_Atlas_New_York   -0.300     675.521
453                Falco biarmicus     Birds_atlas_EBBA   -0.319  208464.083
454                  Falco cherrug  Birds_Atlas_Czechia    0.201    1765.995
455                  Falco cherrug     Birds_atlas_EBBA    0.105  300313.872
456              Falco columbarius     Birds_atlas_EBBA    0.221 1612403.915
457                Falco eleonorae     Birds_atlas_EBBA    0.244  142402.843
458                 Falco naumanni     Birds_atlas_EBBA   -0.011  858010.566
459               Falco peregrinus  Birds_Atlas_Czechia    0.623    3205.263
460               Falco peregrinus     Birds_atlas_EBBA    0.677 2447729.498
461               Falco peregrinus    Birds_atlas_Japan    0.346   11883.785
462               Falco peregrinus Birds_Atlas_New_York    1.867     425.245
463               Falco rusticolus     Birds_atlas_EBBA    0.136  435473.588
464               Falco sparverius Birds_Atlas_New_York   -0.153   86267.760
465                 Falco subbuteo  Birds_Atlas_Czechia    0.239   28941.928
466                 Falco subbuteo     Birds_atlas_EBBA    0.337 4906697.780
467                 Falco subbuteo    Birds_atlas_Japan   -0.362    4923.796
468              Falco tinnunculus  Birds_Atlas_Czechia    0.015   82166.560
469              Falco tinnunculus     Birds_atlas_EBBA    0.144 7048283.913
470              Falco tinnunculus    Birds_atlas_Japan    0.057    7797.567
471              Falco vespertinus     Birds_atlas_EBBA    0.283  782000.703
472            Ficedula albicollis  Birds_Atlas_Czechia    0.095   40301.871
473            Ficedula albicollis     Birds_atlas_EBBA    0.401 1162489.840
474             Ficedula hypoleuca  Birds_Atlas_Czechia    0.045   43433.541
475             Ficedula hypoleuca     Birds_atlas_EBBA    0.175 4055838.696
476            Ficedula narcissina    Birds_atlas_Japan    0.374  242140.351
477                 Ficedula parva  Birds_Atlas_Czechia    0.163   19765.588
478                 Ficedula parva     Birds_atlas_EBBA    0.479 2083407.160
479          Ficedula semitorquata     Birds_atlas_EBBA    0.626  175426.289
480        Francolinus francolinus     Birds_atlas_EBBA    0.314   41664.665
481             Fratercula arctica     Birds_atlas_EBBA   -0.043  423244.095
482              Fringilla coelebs  Birds_Atlas_Czechia    0.002   83776.380
483              Fringilla coelebs     Birds_atlas_EBBA    0.200 7108122.077
484       Fringilla montifringilla     Birds_atlas_EBBA    0.422 1561326.855
485               Fulica americana Birds_Atlas_New_York    0.093    1800.013
486                    Fulica atra  Birds_Atlas_Czechia   -0.002   66959.983
487                    Fulica atra     Birds_atlas_EBBA    0.180 5342477.997
488                    Fulica atra    Birds_atlas_Japan    0.523    6891.110
489                Fulica cristata     Birds_atlas_EBBA    1.195   20129.755
490             Fulmarus glacialis     Birds_atlas_EBBA   -0.034  640797.733
491              Galerida cristata  Birds_Atlas_Czechia   -0.840   37289.811
492              Galerida cristata     Birds_atlas_EBBA   -0.037 4074346.057
493               Galerida theklae     Birds_atlas_EBBA    0.259  437463.625
494             Gallinago delicata Birds_Atlas_New_York    0.021   24233.058
495            Gallinago gallinago  Birds_Atlas_Czechia   -0.246   41031.633
496            Gallinago gallinago     Birds_atlas_EBBA    0.174 4451123.613
497           Gallinago hardwickii    Birds_atlas_Japan   -0.136   46024.785
498                Gallinago media     Birds_atlas_EBBA    0.473  525638.871
499              Gallinago stenura     Birds_atlas_EBBA   -0.446  123703.856
500            Gallinula chloropus  Birds_Atlas_Czechia    0.015   55613.321
501            Gallinula chloropus     Birds_atlas_EBBA    0.134 5485710.121
502            Gallinula chloropus    Birds_atlas_Japan   -0.671   33546.455
503            Gallinula chloropus Birds_Atlas_New_York   -0.405    7201.238
504           Gallirallus okinawae    Birds_atlas_Japan    0.405     918.465
505               Garrulax canorus    Birds_atlas_Japan    2.544    4613.851
506            Garrulus glandarius  Birds_Atlas_Czechia    0.016   82169.000
507            Garrulus glandarius     Birds_atlas_EBBA    0.159 6391991.339
508            Garrulus glandarius    Birds_atlas_Japan   -0.138  248026.862
509                Garrulus lidthi    Birds_atlas_Japan    0.000    2265.039
510                  Gavia arctica     Birds_atlas_EBBA    0.305 1427470.407
511                    Gavia immer     Birds_atlas_EBBA    0.028  103358.832
512                    Gavia immer Birds_Atlas_New_York    0.349    9231.807
513                 Gavia stellata     Birds_atlas_EBBA    0.273 1228469.651
514          Gelochelidon nilotica     Birds_atlas_EBBA    0.878  181432.743
515          Gelochelidon nilotica Birds_Atlas_New_York    0.511      75.032
516             Geothlypis trichas Birds_Atlas_New_York   -0.003  129386.064
517            Glareola maldivarum    Birds_atlas_Japan    0.000     933.720
518             Glareola nordmanni     Birds_atlas_EBBA   -0.215  232336.213
519            Glareola pratincola     Birds_atlas_EBBA    0.188  416210.865
520          Glaucidium passerinum  Birds_Atlas_Czechia    0.656   17048.318
521          Glaucidium passerinum     Birds_atlas_EBBA    0.529 1521325.304
522             Gorsachius goisagi    Birds_atlas_Japan    0.554    1683.039
523                      Grus grus  Birds_Atlas_Czechia    1.746     923.900
524                      Grus grus     Birds_atlas_EBBA    0.540 2030338.244
525                Grus japonensis    Birds_atlas_Japan    0.746    3389.344
526            Gulosus aristotelis     Birds_atlas_EBBA    0.233  802142.066
527              Gypaetus barbatus     Birds_atlas_EBBA    0.609  142478.312
528                    Gyps fulvus     Birds_atlas_EBBA    0.302  527105.413
529          Haematopus ostralegus     Birds_atlas_EBBA    0.322 2154886.153
530           Haematopus palliatus Birds_Atlas_New_York    0.413    1124.856
531              Halcyon coromanda    Birds_atlas_Japan    0.568   57956.583
532           Haliaeetus albicilla  Birds_Atlas_Czechia    1.585    2279.408
533           Haliaeetus albicilla     Birds_atlas_EBBA    1.219 1093558.428
534           Haliaeetus albicilla    Birds_atlas_Japan    0.691    4850.879
535       Haliaeetus leucocephalus Birds_Atlas_New_York    2.543     875.418
536         Helmitheros vermivorum Birds_Atlas_New_York   -0.009    5628.339
537            Hieraaetus pennatus     Birds_atlas_EBBA    0.412 1172979.419
538        Hierococcyx hyperythrus    Birds_atlas_Japan   -0.042   59192.909
539          Himantopus himantopus  Birds_Atlas_Czechia    0.230     537.623
540          Himantopus himantopus     Birds_atlas_EBBA    0.752 1058889.488
541          Himantopus himantopus    Birds_atlas_Japan    0.963     795.085
542             Hippolais icterina  Birds_Atlas_Czechia    0.007   78294.190
543             Hippolais icterina     Birds_atlas_EBBA    0.157 3676179.325
544           Hippolais olivetorum     Birds_atlas_EBBA    0.140  251781.723
545           Hippolais polyglotta     Birds_atlas_EBBA    0.100 1584385.481
546          Hirundapus caudacutus    Birds_atlas_Japan   -0.588   15921.318
547                Hirundo daurica    Birds_atlas_Japan   -0.381   27930.810
548                Hirundo rustica  Birds_Atlas_Czechia   -0.002   83907.509
549                Hirundo rustica     Birds_atlas_EBBA    0.187 7178531.278
550                Hirundo rustica    Birds_atlas_Japan   -0.095  265530.530
551                Hirundo rustica Birds_Atlas_New_York   -0.061  122931.204
552               Hirundo tahitica    Birds_atlas_Japan    0.084   10998.717
553      Histrionicus histrionicus     Birds_atlas_EBBA   -0.061  113773.739
554      Histrionicus histrionicus    Birds_atlas_Japan   -0.001    1163.365
555              Hydrobates castro     Birds_atlas_EBBA    0.154   30010.956
556          Hydrobates leucorhous     Birds_atlas_EBBA   -0.082   35306.201
557           Hydrobates pelagicus     Birds_atlas_EBBA   -0.018  242701.113
558           Hydrocoloeus minutus     Birds_atlas_EBBA    0.493  693627.001
559              Hydropogne caspia Birds_Atlas_New_York    0.510      75.041
560             Hydroprogne caspia     Birds_atlas_EBBA    0.296  235981.837
561           Hylocichla mustelina Birds_Atlas_New_York   -0.074  119131.337
562           Hypsipetes amaurotis    Birds_atlas_Japan    0.014  408412.823
563                 Icteria virens Birds_Atlas_New_York   -1.508    3050.135
564                Icterus galbula Birds_Atlas_New_York   -0.036  110675.722
565                Icterus spurius Birds_Atlas_New_York    0.556    5575.999
566                 Iduna caligata     Birds_atlas_EBBA    3.220   29336.119
567                    Iduna opaca     Birds_atlas_EBBA    0.012  189259.288
568                  Iduna pallida     Birds_atlas_EBBA    0.293  598257.900
569         Ixobrychus cinnamomeus    Birds_atlas_Japan    0.692     468.079
570              Ixobrychus exilis Birds_Atlas_New_York   -0.096    3550.928
571             Ixobrychus minutus  Birds_Atlas_Czechia    0.079    8181.060
572             Ixobrychus minutus     Birds_atlas_EBBA    0.321 2551014.061
573            Ixobrychus sinensis    Birds_atlas_Japan   -0.711    3318.114
574                 Junco hyemalis Birds_Atlas_New_York    0.207   57370.831
575                 Jynx torquilla  Birds_Atlas_Czechia    0.055   54733.165
576                 Jynx torquilla     Birds_atlas_EBBA    0.195 5231171.087
577                 Jynx torquilla    Birds_atlas_Japan    0.306   10572.855
578                Lagopus lagopus     Birds_atlas_EBBA    0.307 1435847.475
579                   Lagopus muta     Birds_atlas_EBBA    0.115  932561.777
580                   Lagopus muta    Birds_atlas_Japan    0.405     830.223
581              Lanius bucephalus    Birds_atlas_Japan   -0.042  193592.487
582                Lanius collurio  Birds_Atlas_Czechia    0.006   82974.349
583                Lanius collurio     Birds_atlas_EBBA    0.190 5335925.281
584               Lanius cristatus    Birds_atlas_Japan   -1.453    5597.735
585               Lanius excubitor  Birds_Atlas_Czechia    0.027   57573.676
586               Lanius excubitor     Birds_atlas_EBBA    0.069 2524172.753
587            Lanius ludovicianus Birds_Atlas_New_York   -1.792     600.229
588            Lanius meridionalis     Birds_atlas_EBBA   -0.096  701376.137
589                   Lanius minor     Birds_atlas_EBBA    0.232 1625166.348
590                 Lanius nubicus     Birds_atlas_EBBA    0.082  138761.179
591                 Lanius senator     Birds_atlas_EBBA   -0.015 1942342.211
592                Lanius tigrinus    Birds_atlas_Japan   -0.708    1660.299
593               Larus argentatus     Birds_atlas_EBBA    0.230 2184690.108
594               Larus argentatus Birds_Atlas_New_York   -0.139    6728.281
595                Larus armenicus     Birds_atlas_EBBA    2.996    2501.944
596                Larus audouinii     Birds_atlas_EBBA    0.686  106746.405
597               Larus cachinnans  Birds_Atlas_Czechia   -0.217     667.708
598               Larus cachinnans     Birds_atlas_EBBA    1.613  210275.808
599                    Larus canus  Birds_Atlas_Czechia    0.584    1342.174
600                    Larus canus     Birds_atlas_EBBA    0.381 2628837.241
601            Larus crassirostris    Birds_atlas_Japan   -0.148   38642.376
602             Larus delawarensis Birds_Atlas_New_York   -0.204     950.336
603                   Larus fuscus     Birds_atlas_EBBA    0.410 1438740.857
604                    Larus genei     Birds_atlas_EBBA    1.231   61122.050
605              Larus hyperboreus     Birds_atlas_EBBA    0.539  189969.686
606              Larus ichthyaetus     Birds_atlas_EBBA    0.993   57964.736
607                  Larus marinus     Birds_atlas_EBBA    0.207 1307900.008
608                  Larus marinus Birds_Atlas_New_York   -0.058    1775.100
609           Larus melanocephalus  Birds_Atlas_Czechia    1.249     538.158
610           Larus melanocephalus     Birds_atlas_EBBA    1.184  269667.436
611              Larus michahellis     Birds_atlas_EBBA    0.696  917591.847
612               Larus ridibundus  Birds_Atlas_Czechia   -0.144   44367.849
613               Larus ridibundus     Birds_atlas_EBBA    0.194 4347292.210
614             Larus schistisagus    Birds_atlas_Japan    0.045   23701.439
615         Laterallus jamaicensis Birds_Atlas_New_York    0.000      25.008
616               Leiopicus medius     Birds_atlas_EBBA    0.377 2265296.071
617                Leiothrix lutea    Birds_atlas_Japan    1.350   17164.895
618          Leucophaeus atricilla Birds_Atlas_New_York   -1.674     800.224
619               Limosa lapponica     Birds_atlas_EBBA    0.329  121516.613
620                  Limosa limosa  Birds_Atlas_Czechia   -0.608    5915.007
621                  Limosa limosa     Birds_atlas_EBBA    0.021 1758149.078
622              Linaria cannabina     Birds_atlas_EBBA    0.114 6166242.692
623           Linaria flavirostris     Birds_atlas_EBBA    0.166  501641.583
624          Locustella fasciolata    Birds_atlas_Japan    0.092   34254.396
625         Locustella fluviatilis  Birds_Atlas_Czechia    0.158   60196.943
626         Locustella fluviatilis     Birds_atlas_EBBA    0.457 2076623.123
627          Locustella lanceolata     Birds_atlas_EBBA    1.100   68269.471
628          Locustella lanceolata    Birds_atlas_Japan    0.001    4503.689
629        Locustella luscinioides  Birds_Atlas_Czechia    0.525   12995.686
630        Locustella luscinioides     Birds_atlas_EBBA    0.377 2184084.251
631              Locustella naevia  Birds_Atlas_Czechia    0.102   66586.479
632              Locustella naevia     Birds_atlas_EBBA    0.205 3323055.428
633          Locustella ochotensis    Birds_atlas_Japan    0.064   10967.852
634             Locustella pleskei    Birds_atlas_Japan   -1.102    1284.616
635              Locustella pryeri    Birds_atlas_Japan    0.233    1586.677
636            Lonchura punctulata    Birds_atlas_Japan    0.812    1842.809
637          Lophodytes cucullatus Birds_Atlas_New_York    0.745    9604.389
638          Lophophanes cristatus     Birds_atlas_EBBA    0.141 4075543.309
639              Loxia curvirostra  Birds_Atlas_Czechia    0.121   53734.640
640              Loxia curvirostra     Birds_atlas_EBBA    0.354 3668534.783
641              Loxia curvirostra    Birds_atlas_Japan   -0.646    5890.589
642              Loxia curvirostra Birds_Atlas_New_York   -1.025    5853.881
643               Loxia leucoptera     Birds_atlas_EBBA    0.378  429275.244
644               Loxia leucoptera Birds_Atlas_New_York    0.130    5228.694
645           Loxia pytyopsittacus     Birds_atlas_EBBA    0.103 1231058.761
646                  Loxia scotica     Birds_atlas_EBBA   -1.090   37218.538
647                Lullula arborea  Birds_Atlas_Czechia    0.174   21909.060
648                Lullula arborea     Birds_atlas_EBBA    0.218 4352604.475
649               Luscinia akahige    Birds_atlas_Japan   -0.288   52588.226
650              Luscinia calliope    Birds_atlas_Japan   -0.238   21393.012
651                 Luscinia cyane    Birds_atlas_Japan   -0.122  115261.384
652              Luscinia komadori    Birds_atlas_Japan   -0.076    5891.435
653              Luscinia luscinia  Birds_Atlas_Czechia    0.536     943.026
654              Luscinia luscinia     Birds_atlas_EBBA    0.250 2514309.784
655          Luscinia megarhynchos  Birds_Atlas_Czechia    0.218   33936.776
656          Luscinia megarhynchos     Birds_atlas_EBBA    0.113 3566113.557
657               Luscinia svecica  Birds_Atlas_Czechia    1.035    5907.532
658           Lymnocryptes minimus     Birds_atlas_EBBA    0.227  499963.663
659          Lyrurus mlokosiewiczi     Birds_atlas_EBBA   -0.070  122076.665
660                 Lyrurus tetrix     Birds_atlas_EBBA    0.241 2467371.918
661                Mareca penelope     Birds_atlas_EBBA    0.235 1958777.009
662                Mareca strepera     Birds_atlas_EBBA    0.747 1819750.514
663    Marmaronetta angustirostris     Birds_atlas_EBBA    0.631   38034.772
664              Megaceryle alcyon Birds_Atlas_New_York   -0.061   95376.664
665            Megaceryle lugubris    Birds_atlas_Japan   -0.475   32196.188
666                 Megascops asio Birds_Atlas_New_York    0.011   28129.273
667           Melanerpes carolinus Birds_Atlas_New_York    0.802   24451.657
668     Melanerpes erythrocephalus Birds_Atlas_New_York   -1.420   17274.311
669                Melanitta fusca     Birds_atlas_EBBA   -0.054  768345.349
670                Melanitta nigra     Birds_atlas_EBBA   -0.112  784584.444
671         Melanocorypha calandra     Birds_atlas_EBBA    0.106 1371793.617
672            Meleagris gallopavo     Birds_atlas_EBBA    0.947    5995.394
673            Meleagris gallopavo Birds_Atlas_New_York    0.845   39184.292
674            Melospiza georgiana Birds_Atlas_New_York    0.056   72351.063
675            Melospiza lincolnii Birds_Atlas_New_York   -0.148    6930.231
676              Melospiza melodia Birds_Atlas_New_York   -0.007  129859.941
677             Mergellus albellus     Birds_atlas_EBBA    0.857  322619.032
678               Mergus merganser  Birds_Atlas_Czechia    1.046     799.637
679               Mergus merganser     Birds_atlas_EBBA    0.502 1972924.266
680               Mergus merganser    Birds_atlas_Japan    0.056    8332.892
681               Mergus merganser Birds_Atlas_New_York    0.849   11757.587
682                Mergus serrator     Birds_atlas_EBBA    0.148 1973606.427
683                Mergus serrator Birds_Atlas_New_York    0.252     349.985
684                Merops apiaster  Birds_Atlas_Czechia    0.620    1892.514
685                Merops apiaster     Birds_atlas_EBBA    0.558 2458698.847
686                Merops persicus     Birds_atlas_EBBA    2.601    7363.361
687            Microcarbo pygmaeus     Birds_atlas_EBBA    1.094  118279.801
688              Miliaria calandra  Birds_Atlas_Czechia    0.719   18252.759
689                 Milvus migrans  Birds_Atlas_Czechia    0.320   10887.355
690                 Milvus migrans     Birds_atlas_EBBA    0.329 3271867.411
691                 Milvus migrans    Birds_atlas_Japan   -0.191  279138.604
692                  Milvus milvus  Birds_Atlas_Czechia    0.535   13911.898
693                  Milvus milvus     Birds_atlas_EBBA    0.232 1623539.060
694              Mimus polyglottos Birds_Atlas_New_York    0.093   37263.533
695                Mniotilta varia Birds_Atlas_New_York   -0.009   69390.346
696                 Molothrus ater Birds_Atlas_New_York   -0.072  112978.229
697            Monticola saxatilis     Birds_atlas_EBBA   -0.092 1223981.351
698           Monticola solitarius     Birds_atlas_EBBA    0.199 1299538.105
699           Monticola solitarius    Birds_atlas_Japan    0.290   52471.468
700         Montifringilla nivalis     Birds_atlas_EBBA    0.345  266639.713
701                 Morus bassanus     Birds_atlas_EBBA    0.162  109283.805
702                 Motacilla alba  Birds_Atlas_Czechia    0.003   83644.425
703                 Motacilla alba     Birds_atlas_EBBA    0.241 7201075.502
704                 Motacilla alba    Birds_atlas_Japan    0.180  129722.745
705              Motacilla cinerea  Birds_Atlas_Czechia    0.054   74782.150
706              Motacilla cinerea     Birds_atlas_EBBA    0.273 3769802.272
707              Motacilla cinerea    Birds_atlas_Japan   -0.090  247457.608
708             Motacilla citreola     Birds_atlas_EBBA    1.420  328337.128
709                Motacilla flava  Birds_Atlas_Czechia    0.077   26873.128
710                Motacilla flava     Birds_atlas_EBBA    0.190 5942830.451
711                Motacilla flava    Birds_atlas_Japan    0.090    1097.878
712              Motacilla grandis    Birds_atlas_Japan   -0.282  145835.485
713             Muscicapa dauurica    Birds_atlas_Japan    0.452   43396.621
714             Muscicapa sibirica    Birds_atlas_Japan   -0.870    4664.305
715              Muscicapa striata  Birds_Atlas_Czechia    0.048   74175.402
716              Muscicapa striata     Birds_atlas_EBBA    0.191 6631845.637
717             Myiarchus crinitus Birds_Atlas_New_York   -0.034  107628.800
718            Myiopsitta monachus     Birds_atlas_EBBA    2.164   27517.640
719            Myiopsitta monachus Birds_Atlas_New_York    1.610      75.033
720          Neophron percnopterus     Birds_atlas_EBBA   -0.038  705231.282
721                   Netta rufina  Birds_Atlas_Czechia    0.780    3651.198
722                   Netta rufina     Birds_atlas_EBBA    0.937  530089.389
723                Ninox scutulata    Birds_atlas_Japan    0.216    8640.358
724            Nisaetus nipalensis    Birds_atlas_Japan    0.003   12636.279
725        Nucifraga caryocatactes  Birds_Atlas_Czechia    0.069   42242.636
726        Nucifraga caryocatactes     Birds_atlas_EBBA    0.208 1799369.677
727        Nucifraga caryocatactes    Birds_atlas_Japan   -0.150    8442.278
728               Numenius arquata  Birds_Atlas_Czechia   -0.275    2832.050
729               Numenius arquata     Birds_atlas_EBBA    0.214 2983411.264
730              Numenius phaeopus     Birds_atlas_EBBA    0.385 1181024.275
731            Nyctanassa violacea Birds_Atlas_New_York   -0.322    1000.271
732          Nycticorax nycticorax  Birds_Atlas_Czechia    0.772    3244.985
733          Nycticorax nycticorax     Birds_atlas_EBBA    0.515 1197878.166
734          Nycticorax nycticorax    Birds_atlas_Japan   -0.833   79876.268
735          Nycticorax nycticorax Birds_Atlas_New_York    0.009    5275.781
736               Oenanthe deserti     Birds_atlas_EBBA    0.000    2501.639
737              Oenanthe finschii     Birds_atlas_EBBA    2.346    7504.661
738             Oenanthe hispanica     Birds_atlas_EBBA   -0.038 1241344.703
739            Oenanthe isabellina     Birds_atlas_EBBA    1.074  283574.239
740               Oenanthe leucura     Birds_atlas_EBBA   -0.212  387952.134
741              Oenanthe oenanthe  Birds_Atlas_Czechia   -0.439   26342.205
742              Oenanthe oenanthe     Birds_atlas_EBBA    0.189 6329453.947
743            Oenanthe pleschanka     Birds_atlas_EBBA    0.586  204705.816
744           Onychoprion fuscatus     Birds_atlas_EBBA   -0.511   12503.103
745             Oporornis formosus Birds_Atlas_New_York   -1.266     975.306
746         Oporornis philadelphia Birds_Atlas_New_York    0.043   34929.711
747                Oriolus oriolus  Birds_Atlas_Czechia    0.060   57643.725
748                Oriolus oriolus     Birds_atlas_EBBA    0.169 5084094.349
749                     Otis tarda     Birds_atlas_EBBA   -0.368  544188.079
750                   Otus elegans    Birds_atlas_Japan   -0.223    4625.396
751                   Otus lempiji    Birds_atlas_Japan   -0.117     459.232
752                     Otus scops  Birds_Atlas_Czechia    0.689     270.985
753                     Otus scops     Birds_atlas_EBBA    0.344 2301969.954
754                     Otus sunia    Birds_atlas_Japan   -2.084    3208.526
755             Oxyura jamaicensis     Birds_atlas_EBBA   -0.643  163921.547
756             Oxyura jamaicensis Birds_Atlas_New_York    0.944     175.051
757            Oxyura leucocephala     Birds_atlas_EBBA    0.446   67486.083
758              Pagophila eburnea     Birds_atlas_EBBA   -0.061   77105.755
759              Pandion haliaetus     Birds_atlas_EBBA    0.229 1746183.478
760              Pandion haliaetus    Birds_atlas_Japan    0.352   36773.866
761              Pandion haliaetus Birds_Atlas_New_York    0.901    8378.628
762              Panurus biarmicus  Birds_Atlas_Czechia    0.198    4291.163
763              Panurus biarmicus     Birds_atlas_EBBA    0.741 1165619.706
764               Parula americana Birds_Atlas_New_York    0.407    8555.974
765                     Parus ater  Birds_Atlas_Czechia    0.019   77877.333
766                Parus caeruleus  Birds_Atlas_Czechia    0.005   83375.044
767                Parus cristatus  Birds_Atlas_Czechia   -0.004   71457.768
768                    Parus major  Birds_Atlas_Czechia    0.002   83775.829
769                    Parus major     Birds_atlas_EBBA    0.184 7120757.295
770                    Parus minor    Birds_atlas_Japan    0.051  377387.433
771                 Parus montanus  Birds_Atlas_Czechia    0.146   56798.340
772                Parus palustris  Birds_Atlas_Czechia    0.043   74147.627
773              Passer domesticus  Birds_Atlas_Czechia   -0.003   83644.977
774              Passer domesticus     Birds_atlas_EBBA    0.153 6952238.680
775              Passer domesticus Birds_Atlas_New_York   -0.065  104895.789
776          Passer hispaniolensis     Birds_atlas_EBBA    0.548  784341.902
777                 Passer italiae     Birds_atlas_EBBA    0.051  461685.116
778                Passer montanus  Birds_Atlas_Czechia   -0.022   80845.095
779                Passer montanus     Birds_atlas_EBBA    0.233 5929403.648
780                Passer montanus    Birds_atlas_Japan   -0.109  306338.607
781                Passer rutilans    Birds_atlas_Japan   -0.079   52121.718
782      Passerculus sandwichensis Birds_Atlas_New_York    0.021   75133.677
783             Passerina caerulea Birds_Atlas_New_York    0.810     100.068
784               Passerina cyanea Birds_Atlas_New_York   -0.009  106624.752
785                  Pastor roseus     Birds_atlas_EBBA    1.210   88082.124
786             Pelagodroma marina     Birds_atlas_EBBA    0.000    2501.691
787              Pelecanus crispus     Birds_atlas_EBBA    1.377   34360.591
788          Pelecanus onocrotalus     Birds_atlas_EBBA    0.933   25013.185
789                  Perdix perdix  Birds_Atlas_Czechia   -0.074   70868.665
790                  Perdix perdix     Birds_atlas_EBBA    0.028 4286299.740
791                  Perdix perdix Birds_Atlas_New_York   -1.638     900.563
792       Pericrocotus divaricatus    Birds_atlas_Japan    0.848   65376.047
793                 Periparus ater     Birds_atlas_EBBA    0.178 5163417.038
794                 Periparus ater    Birds_atlas_Japan    0.140  196501.799
795          Perisoreus canadensis Birds_Atlas_New_York    0.156    2376.859
796           Perisoreus infaustus     Birds_atlas_EBBA    0.381  776818.663
797                Pernis apivorus  Birds_Atlas_Czechia    0.157   44594.662
798                Pernis apivorus     Birds_atlas_EBBA    0.274 4295704.849
799           Pernis ptilorhynchus    Birds_atlas_Japan   -0.417   19742.337
800       Petrochelidon pyrrhonota Birds_Atlas_New_York   -0.125   31264.361
801              Petronia petronia     Birds_atlas_EBBA    0.098 1022450.252
802          Phalacrocorax auritus Birds_Atlas_New_York    2.085     550.161
803       Phalacrocorax capillatus    Birds_atlas_Japan   -0.153   13695.289
804            Phalacrocorax carbo  Birds_Atlas_Czechia    1.074    4584.179
805            Phalacrocorax carbo     Birds_atlas_EBBA    1.099 1043519.002
806            Phalacrocorax carbo    Birds_atlas_Japan    1.132   33560.404
807        Phalacrocorax pelagicus    Birds_atlas_Japan   -0.199    1880.631
808          Phalaropus fulicarius     Birds_atlas_EBBA   -0.110   59845.673
809             Phalaropus lobatus     Birds_atlas_EBBA   -0.016  793508.548
810            Phasianus colchicus  Birds_Atlas_Czechia   -0.042   77915.101
811            Phasianus colchicus     Birds_atlas_EBBA    0.139 4015901.326
812            Phasianus colchicus    Birds_atlas_Japan   -0.027  159800.469
813            Phasianus colchicus Birds_Atlas_New_York   -0.464   42478.321
814        Pheucticus ludovicianus Birds_Atlas_New_York   -0.065  116758.709
815          Phoenicopterus roseus     Birds_atlas_EBBA    1.105   31518.501
816           Phoenicurus auroreus    Birds_atlas_Japan    1.560     416.420
817           Phoenicurus ochruros  Birds_Atlas_Czechia   -0.002   83907.509
818           Phoenicurus ochruros     Birds_atlas_EBBA    0.219 4462809.818
819        Phoenicurus phoenicurus  Birds_Atlas_Czechia    0.057   75352.900
820        Phoenicurus phoenicurus     Birds_atlas_EBBA    0.272 5440657.982
821           Phylloscopus bonelli     Birds_atlas_EBBA    0.039 1304552.038
822          Phylloscopus borealis     Birds_atlas_EBBA    0.606  555331.590
823       Phylloscopus borealoides    Birds_atlas_Japan    0.261   60598.819
824         Phylloscopus collybita  Birds_Atlas_Czechia    0.002   83368.534
825         Phylloscopus collybita     Birds_atlas_EBBA    0.235 6154678.748
826         Phylloscopus coronatus    Birds_atlas_Japan    0.164  181082.025
827          Phylloscopus ibericus     Birds_atlas_EBBA    0.239  386977.813
828            Phylloscopus ijimae    Birds_atlas_Japan   -0.281    1728.740
829         Phylloscopus inornatus     Birds_atlas_EBBA   -0.365  157578.465
830           Phylloscopus nitidus     Birds_atlas_EBBA    2.299   17509.425
831        Phylloscopus orientalis     Birds_atlas_EBBA   -0.031  175125.468
832        Phylloscopus sibilatrix  Birds_Atlas_Czechia    0.040   74445.347
833        Phylloscopus sibilatrix     Birds_atlas_EBBA    0.140 4641123.031
834         Phylloscopus sindianus     Birds_atlas_EBBA    2.611   10006.335
835      Phylloscopus trochiloides  Birds_Atlas_Czechia   -0.145    1067.350
836      Phylloscopus trochiloides     Birds_atlas_EBBA    1.041  808290.340
837         Phylloscopus trochilus  Birds_Atlas_Czechia    0.003   82299.049
838         Phylloscopus trochilus     Birds_atlas_EBBA    0.256 4718541.402
839       Phylloscopus xanthodryas    Birds_atlas_Japan   -0.752   67149.966
840                      Pica pica  Birds_Atlas_Czechia    0.025   78714.710
841                      Pica pica     Birds_atlas_EBBA    0.199 6940930.677
842                      Pica pica    Birds_atlas_Japan   -0.377    4312.840
843              Picoides arcticus Birds_Atlas_New_York    0.108    2852.146
844              Picoides dorsalis Birds_Atlas_New_York   -0.383     550.408
845             Picoides pubescens Birds_Atlas_New_York    0.024  114056.415
846           Picoides tridactylus  Birds_Atlas_Czechia   -0.143    5136.586
847           Picoides tridactylus     Birds_atlas_EBBA    0.409 1579521.707
848              Picoides villosus Birds_Atlas_New_York    0.081   94208.648
849                  Picus awokera    Birds_atlas_Japan    0.229  168916.120
850                    Picus canus  Birds_Atlas_Czechia    0.011   57220.018
851                    Picus canus     Birds_atlas_EBBA    0.325 2737478.638
852                    Picus canus    Birds_atlas_Japan    0.708   12403.573
853                  Picus sharpei     Birds_atlas_EBBA    0.075  636429.571
854                  Picus viridis  Birds_Atlas_Czechia    0.042   75370.510
855                  Picus viridis     Birds_atlas_EBBA    0.067 3956157.064
856            Pinicola enucleator     Birds_atlas_EBBA    0.040  423955.351
857            Pinicola enucleator    Birds_atlas_Japan   -0.410    1111.303
858        Pipilo erythrophthalmus Birds_Atlas_New_York   -0.126   93973.888
859               Piranga olivacea Birds_Atlas_New_York    0.008  107484.700
860                  Piranga rubra Birds_Atlas_New_York   -0.001      75.028
861                   Pitta nympha    Birds_atlas_Japan    1.206    3865.951
862            Platalea leucorodia  Birds_Atlas_Czechia    1.387     407.015
863            Platalea leucorodia     Birds_atlas_EBBA    1.037  235244.043
864          Plectrophenax nivalis     Birds_atlas_EBBA   -0.010  717941.459
865           Plegadis falcinellus     Birds_atlas_EBBA    0.999  169449.912
866           Plegadis falcinellus Birds_Atlas_New_York   -0.213    1175.099
867            Pluvialis apricaria     Birds_atlas_EBBA    0.180 1764542.528
868           Pluvialis squatarola     Birds_atlas_EBBA    0.103   64851.839
869               Podiceps auritus     Birds_atlas_EBBA    0.120  997008.002
870             Podiceps cristatus  Birds_Atlas_Czechia   -0.046   50141.478
871             Podiceps cristatus     Birds_atlas_EBBA    0.299 4440690.322
872             Podiceps cristatus    Birds_atlas_Japan    0.870    2862.287
873             Podiceps grisegena  Birds_Atlas_Czechia   -0.155    2807.254
874             Podiceps grisegena     Birds_atlas_EBBA    0.210 1498293.675
875           Podiceps nigricollis  Birds_Atlas_Czechia   -0.433   29312.958
876           Podiceps nigricollis     Birds_atlas_EBBA    0.171 1740013.430
877            Podilymbus podiceps Birds_Atlas_New_York    0.380    4550.865
878           Poecile atricapillus Birds_Atlas_New_York    0.009  128710.846
879                Poecile cinctus     Birds_atlas_EBBA    0.274  408855.752
880             Poecile hudsonicus Birds_Atlas_New_York    0.115    3077.250
881               Poecile lugubris     Birds_atlas_EBBA    0.279  388303.642
882               Poecile montanus     Birds_atlas_EBBA    0.227 4107113.570
883               Poecile montanus    Birds_atlas_Japan    0.123   87859.855
884              Poecile palustris     Birds_atlas_EBBA    0.044 4033623.130
885              Poecile palustris    Birds_atlas_Japan   -0.274   61168.175
886                 Poecile varius    Birds_atlas_Japan    0.124  272692.135
887            Polioptila caerulea Birds_Atlas_New_York    0.171   21906.802
888            Polysticta stelleri     Birds_atlas_EBBA   -0.499    4061.421
889            Pooecetes gramineus Birds_Atlas_New_York   -0.683   27904.563
890            Porphyrio porphyrio     Birds_atlas_EBBA    1.138  113462.236
891               Porzana carolina Birds_Atlas_New_York    0.143    6025.323
892                  Porzana fusca    Birds_atlas_Japan    0.312    8155.081
893                  Porzana parva  Birds_Atlas_Czechia    1.453    1068.445
894                Porzana porzana  Birds_Atlas_Czechia    0.175    7777.646
895                Porzana porzana     Birds_atlas_EBBA    0.157 2780448.595
896                   Progne subis Birds_Atlas_New_York   -0.504   24071.207
897            Protonotaria citrea Birds_Atlas_New_York   -0.693     549.970
898           Prunella atrogularis     Birds_atlas_EBBA    0.043   35095.391
899              Prunella collaris  Birds_Atlas_Czechia    0.181     658.939
900              Prunella collaris     Birds_atlas_EBBA   -0.003  650894.527
901              Prunella collaris    Birds_atlas_Japan    0.006    2882.863
902             Prunella modularis  Birds_Atlas_Czechia    0.015   80579.524
903             Prunella modularis     Birds_atlas_EBBA    0.110 5145541.751
904            Prunella montanella     Birds_atlas_EBBA   -0.106  130273.844
905                Prunella rubida    Birds_atlas_Japan   -0.439    9310.196
906             Psittacula krameri     Birds_atlas_EBBA    1.538  108980.642
907              Pterocles alchata     Birds_atlas_EBBA   -0.217  196676.342
908           Pterocles orientalis     Birds_atlas_EBBA    0.114  294089.473
909             Pterodroma deserta     Birds_atlas_EBBA   -0.693    5002.713
910             Pterodroma madeira     Birds_atlas_EBBA    0.000    4998.945
911         Ptyonoprogne rupestris     Birds_atlas_EBBA    0.270 1455534.148
912           Puffinus lherminieri     Birds_atlas_EBBA    0.435   27506.882
913          Puffinus mauretanicus     Birds_atlas_EBBA    0.288   22513.311
914              Puffinus puffinus     Birds_atlas_EBBA   -0.360  121873.696
915              Puffinus yelkouan     Birds_atlas_EBBA   -0.493  153229.607
916            Pycnonotus sinensis    Birds_atlas_Japan    0.168    5082.329
917           Pyrrhocorax graculus     Birds_atlas_EBBA    0.166  487013.689
918        Pyrrhocorax pyrrhocorax     Birds_atlas_EBBA    0.217  784628.117
919                Pyrrhula murina     Birds_atlas_EBBA    0.000    5001.175
920              Pyrrhula pyrrhula  Birds_Atlas_Czechia   -0.004   75054.799
921              Pyrrhula pyrrhula     Birds_atlas_EBBA    0.237 4733505.939
922              Pyrrhula pyrrhula    Birds_atlas_Japan   -0.136   30619.359
923                Quiscalus major Birds_Atlas_New_York    2.251     100.052
924             Quiscalus quiscula Birds_Atlas_New_York   -0.020  125558.385
925           Rallina eurizonoides    Birds_atlas_Japan    0.000     934.939
926               Rallus aquaticus  Birds_Atlas_Czechia    0.343   26611.982
927               Rallus aquaticus     Birds_atlas_EBBA    0.163 4434186.819
928               Rallus aquaticus    Birds_atlas_Japan    0.055    1499.535
929                 Rallus elegans Birds_Atlas_New_York    0.000     124.961
930                Rallus limicola Birds_Atlas_New_York    0.189   11452.702
931            Rallus longirostris Birds_Atlas_New_York   -0.035    1450.281
932         Recurvirostra avosetta  Birds_Atlas_Czechia    1.108     268.534
933         Recurvirostra avosetta     Birds_atlas_EBBA    0.539  753124.101
934              Regulus calendula Birds_Atlas_New_York   -0.066    4678.373
935            Regulus ignicapilla     Birds_atlas_EBBA    0.302 2672434.154
936           Regulus ignicapillus  Birds_Atlas_Czechia    0.256   50310.050
937            Regulus madeirensis     Birds_atlas_EBBA    0.000    4998.945
938                Regulus regulus  Birds_Atlas_Czechia    0.013   76838.058
939                Regulus regulus     Birds_atlas_EBBA    0.241 4652770.288
940                Regulus regulus    Birds_atlas_Japan    0.106   29723.245
941                Regulus satrapa Birds_Atlas_New_York    0.116   24338.174
942               Remiz pendulinus  Birds_Atlas_Czechia   -0.081   39436.547
943               Remiz pendulinus     Birds_atlas_EBBA    0.261 2779237.600
944                Riparia riparia  Birds_Atlas_Czechia   -0.236   32888.398
945                Riparia riparia     Birds_atlas_EBBA    0.202 5683253.391
946                Riparia riparia    Birds_atlas_Japan   -0.704   12885.222
947                Riparia riparia Birds_Atlas_New_York   -0.325   49138.088
948               Rissa tridactyla     Birds_atlas_EBBA   -0.009  692704.202
949        Rostratula benghalensis    Birds_atlas_Japan   -0.025     423.242
950                 Rynchops niger Birds_Atlas_New_York   -0.392     924.858
951            Sapheopipo noguchii    Birds_atlas_Japan    0.288    1377.039
952               Saxicola rubetra  Birds_Atlas_Czechia   -0.034   72553.242
953               Saxicola rubetra     Birds_atlas_EBBA    0.135 5510628.495
954              Saxicola torquata  Birds_Atlas_Czechia    0.236   30472.180
955             Saxicola torquatus     Birds_atlas_EBBA    0.394 4143328.477
956             Saxicola torquatus    Birds_atlas_Japan    0.095   48423.071
957                Sayornis phoebe Birds_Atlas_New_York    0.085  107080.369
958                 Scolopax minor Birds_Atlas_New_York    0.038   48164.753
959             Scolopax rusticola  Birds_Atlas_Czechia    0.121   37689.948
960             Scolopax rusticola     Birds_atlas_EBBA    0.224 4289497.451
961             Scolopax rusticola    Birds_atlas_Japan   -0.068    5239.122
962            Seiurus aurocapilla Birds_Atlas_New_York    0.086  101036.315
963              Seiurus motacilla Birds_Atlas_New_York   -0.230   26386.642
964         Seiurus noveboracensis Birds_Atlas_New_York    0.039   28364.951
965                Serinus canaria     Birds_atlas_EBBA    0.000   42514.561
966               Serinus pusillus     Birds_atlas_EBBA    1.909   21745.058
967                Serinus serinus  Birds_Atlas_Czechia    0.003   83240.962
968                Serinus serinus     Birds_atlas_EBBA    0.053 4211066.982
969            Setophaga ruticilla Birds_Atlas_New_York    0.021  107236.622
970                  Sialia sialis Birds_Atlas_New_York    0.433   61517.609
971               Sitta canadensis Birds_Atlas_New_York    0.309   42247.538
972             Sitta carolinensis Birds_Atlas_New_York    0.028  106583.312
973                 Sitta europaea  Birds_Atlas_Czechia    0.008   83110.893
974                 Sitta europaea     Birds_atlas_EBBA    0.177 5090693.486
975                 Sitta europaea    Birds_atlas_Japan    0.083   91216.634
976                 Sitta krueperi     Birds_atlas_EBBA    1.314   20012.318
977                 Sitta neumayer     Birds_atlas_EBBA    0.510  238290.406
978               Sitta whiteheadi     Birds_atlas_EBBA   -0.182   15011.685
979           Somateria mollissima     Birds_atlas_EBBA    0.217 1027210.054
980          Somateria spectabilis     Birds_atlas_EBBA   -0.204  129001.043
981               Spatula clypeata     Birds_atlas_EBBA    0.309 2911390.370
982            Spatula querquedula     Birds_atlas_EBBA    0.154 3727889.916
983             Sphyrapicus varius Birds_Atlas_New_York    0.419   55130.259
984        Spilopelia senegalensis     Birds_atlas_EBBA    2.219   17481.051
985               Spilornis cheela    Birds_atlas_Japan   -0.405    1404.231
986                   Spinus pinus Birds_Atlas_New_York    0.012   10330.332
987                  Spinus spinus     Birds_atlas_EBBA    0.301 3899343.693
988                 Spinus tristis Birds_Atlas_New_York    0.017  122781.506
989                Spiza americana Birds_Atlas_New_York    1.792      24.982
990               Spizella pallida Birds_Atlas_New_York    1.099     575.076
991             Spizella passerina Birds_Atlas_New_York    0.003  121756.708
992               Spizella pusilla Birds_Atlas_New_York   -0.173   97293.324
993          Spodiopsar cineraceus    Birds_atlas_Japan   -0.189  160494.840
994     Stelgidopteryx serripennis Birds_Atlas_New_York    0.191   39105.225
995       Stercorarius longicaudus     Birds_atlas_EBBA    0.344  272951.045
996       Stercorarius parasiticus     Birds_atlas_EBBA    0.160  714414.093
997         Stercorarius pomarinus     Birds_atlas_EBBA   -1.082   89797.152
998               Sterna albifrons    Birds_atlas_Japan   -1.257   22284.296
999               Sterna dougallii     Birds_atlas_EBBA   -0.181  111493.838
1000              Sterna dougallii    Birds_atlas_Japan    0.680     466.860
1001              Sterna dougallii Birds_Atlas_New_York   -0.460     474.844
1002               Sterna forsteri Birds_Atlas_New_York    1.609      50.026
1003                Sterna hirundo  Birds_Atlas_Czechia    0.135    9303.113
1004                Sterna hirundo     Birds_atlas_EBBA    0.290 3947572.785
1005                Sterna hirundo Birds_Atlas_New_York   -0.016    3050.203
1006             Sterna paradisaea     Birds_atlas_EBBA    0.179 1666154.574
1007              Sterna sumatrana    Birds_atlas_Japan   -1.602    2319.706
1008            Sternula albifrons     Birds_atlas_EBBA    0.152 1343676.094
1009           Sternula antillarum Birds_Atlas_New_York   -0.220    2149.812
1010         Streptopelia decaocto  Birds_Atlas_Czechia   -0.007   82057.797
1011         Streptopelia decaocto     Birds_atlas_EBBA    0.236 5369344.550
1012       Streptopelia orientalis    Birds_atlas_Japan    0.019  395296.636
1013           Streptopelia turtur  Birds_Atlas_Czechia   -0.003   79923.934
1014           Streptopelia turtur     Birds_atlas_EBBA    0.042 5421249.901
1015                   Strix aluco  Birds_Atlas_Czechia    0.023   73512.447
1016                   Strix aluco     Birds_atlas_EBBA    0.073 5389865.502
1017                Strix nebulosa     Birds_atlas_EBBA    0.747  485097.394
1018               Strix uralensis  Birds_Atlas_Czechia    1.511     537.373
1019               Strix uralensis     Birds_atlas_EBBA    0.552 1017435.639
1020               Strix uralensis    Birds_atlas_Japan    0.460   14235.659
1021                   Strix varia Birds_Atlas_New_York    0.354   26887.488
1022               Sturnella magna Birds_Atlas_New_York   -0.286   87663.782
1023            Sturnella neglecta Birds_Atlas_New_York   -1.791     150.028
1024              Sturnus unicolor     Birds_atlas_EBBA    0.102  745767.134
1025              Sturnus vulgaris  Birds_Atlas_Czechia    0.000   83505.919
1026              Sturnus vulgaris     Birds_atlas_EBBA    0.185 6184768.628
1027              Sturnus vulgaris Birds_Atlas_New_York   -0.016  115550.438
1028              Sula leucogaster    Birds_atlas_Japan    0.647     459.892
1029                  Surnia ulula     Birds_atlas_EBBA    0.250  878475.534
1030            Sylvia atricapilla  Birds_Atlas_Czechia    0.000   83776.380
1031            Sylvia atricapilla     Birds_atlas_EBBA    0.173 6514773.596
1032              Sylvia balearica     Birds_atlas_EBBA    0.000   22513.618
1033                  Sylvia borin  Birds_Atlas_Czechia    0.016   76528.072
1034                  Sylvia borin     Birds_atlas_EBBA    0.193 5431698.486
1035             Sylvia cantillans     Birds_atlas_EBBA    0.021 1359808.682
1036               Sylvia communis  Birds_Atlas_Czechia    0.003   82031.278
1037               Sylvia communis     Birds_atlas_EBBA    0.180 6277453.486
1038          Sylvia conspicillata     Birds_atlas_EBBA    0.115  643446.658
1039          Sylvia crassirostris     Birds_atlas_EBBA    0.232  329599.683
1040                Sylvia curruca  Birds_Atlas_Czechia   -0.003   82293.549
1041                Sylvia curruca     Birds_atlas_EBBA    0.227 4893624.604
1042              Sylvia hortensis     Birds_atlas_EBBA   -0.156  748507.754
1043          Sylvia melanocephala     Birds_atlas_EBBA    0.097 1501858.587
1044               Sylvia mystacea     Birds_atlas_EBBA    4.002    2501.944
1045                Sylvia nisoria  Birds_Atlas_Czechia    0.059   24827.554
1046                Sylvia nisoria     Birds_atlas_EBBA    0.316 2008202.106
1047                Sylvia ruppeli     Birds_atlas_EBBA   -0.108  116134.898
1048                  Sylvia sarda     Birds_atlas_EBBA    0.034   71821.387
1049              Sylvia subalpina     Birds_atlas_EBBA   -0.150  194069.577
1050                 Sylvia undata     Birds_atlas_EBBA    0.044 1171159.143
1051           Syrmaticus reevesii     Birds_atlas_EBBA    0.371  103276.094
1052      Syrmaticus soemmerringii    Birds_atlas_Japan    0.313   39150.426
1053        Tachybaptus ruficollis  Birds_Atlas_Czechia   -0.019   57641.907
1054        Tachybaptus ruficollis     Birds_atlas_EBBA    0.188 4277835.243
1055        Tachybaptus ruficollis    Birds_atlas_Japan   -0.215   55543.548
1056           Tachycineta bicolor Birds_Atlas_New_York    0.040  116286.914
1057            Tachymarptis melba     Birds_atlas_EBBA    0.261 1298940.439
1058            Tadorna ferruginea     Birds_atlas_EBBA    1.522  232467.945
1059               Tadorna tadorna     Birds_atlas_EBBA    0.607 1465126.053
1060             Tarsiger cyanurus     Birds_atlas_EBBA    2.462   59713.539
1061             Tarsiger cyanurus    Birds_atlas_Japan   -0.044   29380.199
1062       Terpsiphone atrocaudata    Birds_atlas_Japan    0.682   70754.823
1063                 Tetrao tetrix  Birds_Atlas_Czechia   -0.429   12687.080
1064              Tetrao urogallus  Birds_Atlas_Czechia   -0.303    5636.298
1065              Tetrao urogallus     Birds_atlas_EBBA    0.295 2191872.129
1066          Tetraogallus caspius     Birds_atlas_EBBA    0.430   32633.361
1067       Tetraogallus caucasicus     Birds_atlas_EBBA   -0.073   73883.832
1068             Tetrastes bonasia    Birds_atlas_Japan    0.122    8985.460
1069                 Tetrax tetrax     Birds_atlas_EBBA    0.067  632358.692
1070       Thalasseus sandvicensis     Birds_atlas_EBBA    0.298  377741.039
1071      Thryothorus ludovicianus Birds_Atlas_New_York    1.411    7626.257
1072            Tichodroma muraria     Birds_atlas_EBBA    0.013  509530.940
1073               Toxostoma rufum Birds_Atlas_New_York   -0.358   83545.010
1074               Treron formosae    Birds_atlas_Japan   -0.041   13319.275
1075              Treron sieboldii    Birds_atlas_Japan    0.563  135230.266
1076             Tringa erythropus     Birds_atlas_EBBA    0.085  387307.680
1077               Tringa glareola     Birds_atlas_EBBA    0.484 1533941.286
1078              Tringa nebularia     Birds_atlas_EBBA    0.637 1179488.744
1079               Tringa ochropus  Birds_Atlas_Czechia    1.206    5370.516
1080               Tringa ochropus     Birds_atlas_EBBA    0.417 2478592.106
1081            Tringa semipalmata Birds_Atlas_New_York    0.569    1075.169
1082            Tringa stagnatilis     Birds_atlas_EBBA    0.606  191019.363
1083                Tringa totanus  Birds_Atlas_Czechia   -0.086    9683.563
1084                Tringa totanus     Birds_atlas_EBBA    0.122 3845900.331
1085                Tringa totanus    Birds_atlas_Japan   -1.102    1125.736
1086             Troglodytes aedon Birds_Atlas_New_York   -0.032  109898.516
1087       Troglodytes troglodytes  Birds_Atlas_Czechia    0.010   82707.683
1088       Troglodytes troglodytes     Birds_atlas_EBBA    0.139 6170099.721
1089       Troglodytes troglodytes    Birds_atlas_Japan    0.160  135487.834
1090       Troglodytes troglodytes Birds_Atlas_New_York    0.396   30243.263
1091            Turdus atrogularis     Birds_atlas_EBBA   -0.430  146918.305
1092                 Turdus cardis    Birds_atlas_Japan    0.277  148764.344
1093              Turdus celaenops    Birds_atlas_Japan   -0.282    1730.412
1094             Turdus chrysolaus    Birds_atlas_Japan   -0.264  109309.870
1095                Turdus iliacus  Birds_Atlas_Czechia   -0.185    3203.862
1096                Turdus iliacus     Birds_atlas_EBBA    0.354 2440292.038
1097                 Turdus merula  Birds_Atlas_Czechia   -0.002   83907.509
1098                 Turdus merula     Birds_atlas_EBBA    0.168 6877767.068
1099            Turdus migratorius Birds_Atlas_New_York    0.008  129710.114
1100               Turdus pallidus    Birds_atlas_Japan   -0.494    5494.708
1101             Turdus philomelos  Birds_Atlas_Czechia    0.002   83644.425
1102             Turdus philomelos     Birds_atlas_EBBA    0.267 5931021.837
1103                Turdus pilaris  Birds_Atlas_Czechia    0.017   77504.768
1104                Turdus pilaris     Birds_atlas_EBBA    0.285 3917776.385
1105              Turdus torquatus  Birds_Atlas_Czechia   -0.029    9641.319
1106              Turdus torquatus     Birds_atlas_EBBA    0.066 1408009.771
1107             Turdus viscivorus  Birds_Atlas_Czechia    0.113   69934.130
1108             Turdus viscivorus     Birds_atlas_EBBA    0.269 5291234.878
1109             Turnix suscitator    Birds_atlas_Japan   -1.495    4165.398
1110             Tyrannus tyrannus Birds_Atlas_New_York   -0.076  120155.729
1111                     Tyto alba  Birds_Atlas_Czechia   -0.265   41800.790
1112                     Tyto alba     Birds_atlas_EBBA    0.063 3446726.224
1113                     Tyto alba Birds_Atlas_New_York   -1.504    3150.771
1114                   Upupa epops  Birds_Atlas_Czechia    0.212   13033.363
1115                   Upupa epops     Birds_atlas_EBBA    0.161 4394598.634
1116              Uragus sibiricus    Birds_atlas_Japan   -0.127   47103.432
1117                    Uria aalge     Birds_atlas_EBBA    0.012  451047.398
1118                   Uria lomvia     Birds_atlas_EBBA   -0.036  145888.203
1119         Urosphena squameiceps    Birds_atlas_Japan   -0.047  276362.325
1120             Vanellus cinereus    Birds_atlas_Japan   -0.135   19318.729
1121            Vanellus gregarius     Birds_atlas_EBBA   -2.936   61849.268
1122             Vanellus leucurus     Birds_atlas_EBBA    3.239    2501.639
1123             Vanellus spinosus     Birds_atlas_EBBA    0.908   10148.616
1124             Vanellus vanellus  Birds_Atlas_Czechia   -0.096   75250.895
1125             Vanellus vanellus     Birds_atlas_EBBA    0.159 5478218.063
1126         Vermivora chrysoptera Birds_Atlas_New_York   -0.691   15030.542
1127           Vermivora peregrina Birds_Atlas_New_York    0.036     675.485
1128               Vermivora pinus Birds_Atlas_New_York    0.152   47229.219
1129         Vermivora ruficapilla Birds_Atlas_New_York   -0.075   36894.531
1130              Vireo flavifrons Birds_Atlas_New_York   -0.074   41992.762
1131                  Vireo gilvus Birds_Atlas_New_York    0.120   78345.638
1132                 Vireo griseus Birds_Atlas_New_York   -0.071    4350.846
1133               Vireo olivaceus Birds_Atlas_New_York    0.027  124610.142
1134          Vireo philadelphicus Birds_Atlas_New_York    0.448    1150.845
1135              Vireo solitarius Birds_Atlas_New_York    0.329   47297.647
1136           Wilsonia canadensis Birds_Atlas_New_York   -0.263   42095.239
1137              Wilsonia citrina Birds_Atlas_New_York    0.900   10517.920
1138              Wilsonia pusilla Birds_Atlas_New_York   -0.405      75.052
1139                   Xema sabini     Birds_atlas_EBBA    2.063    2501.964
1140                Xenus cinereus     Birds_atlas_EBBA    2.004   94386.135
1141                Zapornia parva     Birds_atlas_EBBA    0.484  979110.471
1142              Zapornia pusilla     Birds_atlas_EBBA   -0.446  285718.271
1143              Zenaida macroura Birds_Atlas_New_York    0.086  110073.112
1144        Zonotrichia albicollis Birds_Atlas_New_York   -0.159   58286.819
1145                Zoothera aurea     Birds_atlas_EBBA    0.291  131010.576
1146                Zoothera dauma    Birds_atlas_Japan   -0.023  100749.781
1147             Zoothera sibirica    Birds_atlas_Japan   -0.186   20325.351
1148           Zosterops japonicus    Birds_atlas_Japan    0.019  287189.967
       tp2_AOO_1
1    3370433.664
2     530780.586
3      33855.800
4      75240.781
5    6752030.720
6      21088.843
7       8878.891
8       7402.356
9      80030.136
10   7327844.416
11      7650.182
12     35983.646
13      5003.948
14    463263.943
15     33714.376
16   5014580.398
17     21298.462
18   2230247.098
19    424728.788
20    102186.423
21    124813.009
22     76978.284
23   4668356.865
24     45126.045
25   5891574.932
26     60431.517
27   5546942.200
28     34648.536
29   6286466.774
30     29354.347
31     44239.075
32     78982.480
33   6957072.280
34    199884.794
35      3651.586
36     31263.265
37   3083000.910
38    202427.798
39    124281.389
40     34877.975
41    812621.591
42     28677.888
43    145580.135
44     69619.553
45     83503.212
46   7317754.429
47    146023.513
48     96217.316
49    365311.331
50    596734.065
51     67512.618
52   5291693.897
53     83133.171
54     53516.072
55    401666.314
56    504107.683
57   1644205.411
58    147263.648
59   1090931.118
60     81806.143
61      5112.629
62      1525.165
63      1749.969
64       900.142
65     11925.730
66      1342.423
67   1790411.294
68       250.068
69       549.874
70     16468.611
71      1213.723
72       625.060
73     26790.768
74   5176173.682
75      4969.509
76      1650.385
77      4226.113
78      3534.114
79     81366.558
80   8530366.808
81     38691.322
82    100651.775
83     25963.075
84     18184.057
85     36570.521
86      1208.125
87      2875.839
88    173020.969
89       466.860
90    161144.162
91     13302.086
92   3644231.573
93    169663.753
94     38635.378
95    772392.123
96    256468.831
97     12502.718
98      1857.964
99   3103092.470
100   322006.826
101   353742.777
102    34488.622
103   804055.213
104    44747.135
105  4877917.772
106     1590.282
107   884003.682
108    80718.469
109  6955147.824
110      919.124
111    81890.311
112  7936633.390
113   135288.609
114     4697.880
115    30975.873
116  1166924.467
117     7500.017
118   203390.708
119  3052190.545
120      225.105
121   631140.564
122   457496.003
123   146751.770
124     2011.467
125   106202.813
126  1857937.781
127    96182.712
128     2775.016
129    53230.485
130  6014765.431
131   214741.613
132    94976.621
133     2568.943
134  1978496.963
135      467.473
136   785094.576
137   564003.981
138     1741.560
139  3393608.384
140      600.147
141    65790.009
142  6626944.863
143      406.666
144     1200.108
145    22440.268
146  4772402.810
147       49.968
148      349.976
149     2426.545
150    47382.934
151  4044704.406
152     2042.346
153    60017.200
154  4722509.346
155     4572.553
156   597109.221
157     1081.493
158  1036990.330
159       25.009
160    78014.404
161   108217.094
162     4126.262
163   125434.965
164  1596191.913
165     9418.677
166  3310354.289
167    64328.742
168    11956.410
169     8830.780
170  3552320.501
171    79309.348
172  1892105.663
173    99098.218
174  1032994.015
175    53027.575
176  4272756.794
177    69529.253
178    40534.817
179   964289.015
180    16453.153
181      175.093
182    33080.738
183    12509.230
184     6041.403
185  3277072.183
186      775.423
187    15548.223
188    17504.554
189  1604981.458
190    47872.775
191    83637.619
192  7901312.117
193    53580.001
194    98769.006
195  1059238.002
196    21627.832
197    48944.778
198  1190617.664
199     7512.510
200    55307.157
201  1564232.654
202   561897.197
203    15011.189
204   916831.962
205     7505.863
206   309503.065
207   453543.249
208     8471.124
209   106073.161
210  1228590.597
211   512162.368
212    28057.397
213     2501.935
214    65030.071
215   163665.644
216     1272.227
217      199.978
218    12178.325
219  5647715.966
220    16091.730
221   427880.092
222     6003.062
223    97363.333
224    80453.732
225    83242.596
226  7561509.842
227    83907.509
228   369876.901
229    55038.455
230    37138.953
231    63157.931
232     6012.837
233    16552.331
234  4122762.332
235    85513.376
236    79026.887
237    58878.572
238   265347.037
239    91722.175
240     1425.934
241   103855.326
242    68108.002
243    14659.311
244  1467276.746
245      747.752
246   933517.745
247   246570.969
248      369.780
249    53421.672
250    58253.731
251  3411460.236
252    79392.536
253  5582579.860
254    30116.106
255  2562080.014
256   429011.604
257    66245.248
258     3741.578
259   979109.337
260     3660.436
261    10006.592
262    50118.047
263  6530881.745
264    41922.825
265  2362268.580
266    12502.416
267     1899.824
268      130.852
269    17485.738
270    94441.695
271   125208.690
272  1439354.278
273  1046242.257
274     6435.767
275  1787403.656
276     1100.357
277  8109976.650
278   344618.602
279     3450.926
280     5277.374
281    22750.506
282    60236.519
283  3911228.913
284    66007.626
285  2613469.443
286    54212.598
287  3495375.058
288    95473.770
289  2580240.197
290    66175.085
291  5524256.672
292    22294.603
293  2571429.879
294    22930.776
295   213504.502
296    14217.989
297  3565677.607
298     3855.188
299  1704089.633
300    67689.772
301    11527.839
302     1800.400
303   713115.490
304   301401.516
305  1667324.322
306   635758.864
307    78978.917
308  5673936.022
309    31959.796
310     8955.521
311    33056.825
312    50789.075
313   121506.298
314    37524.730
315     4374.981
316     8780.337
317    66255.210
318  7903232.735
319    67833.980
320    93517.485
321    58018.966
322  4611378.501
323    83640.337
324  8161646.881
325     4998.945
326     7855.628
327   108526.585
328  1831331.770
329   124931.658
330    75628.962
331  8644632.470
332    46948.299
333    76962.994
334  8967764.943
335   321728.777
336     9466.096
337  4494035.994
338   407042.435
339    38076.082
340  7195850.268
341     8103.286
342    78443.281
343  6618010.654
344    51661.688
345  4948045.667
346    83373.679
347  8769037.515
348   139174.609
349     3358.640
350   232923.819
351   249698.887
352   590479.427
353  3927948.401
354  7510274.031
355    86849.506
356     1770.275
357   129210.703
358   302815.052
359    13979.850
360   280831.154
361    95876.121
362  2373704.825
363    60026.110
364  4833462.719
365     3732.080
366    10177.966
367    87290.815
368    83769.804
369  7872908.817
370   341037.244
371     4853.440
372  1950802.817
373    52074.216
374    83775.279
375  7976441.639
376   171880.710
377    33512.092
378    66417.353
379     1482.219
380    10261.266
381  2050432.335
382    47851.908
383      300.213
384     6100.232
385    70654.215
386    21882.640
387      124.955
388    50919.924
389    52815.531
390     1075.820
391    99706.171
392   114525.569
393    27788.392
394     2876.913
395      350.229
396    76252.375
397    79439.168
398  6299750.856
399    80043.451
400  5596286.320
401    20636.221
402    87205.535
403   118502.321
404      450.106
405     1489.865
406  2029672.365
407    34998.702
408    27327.363
409     3923.593
410     1450.052
411      325.100
412   396450.232
413   230889.453
414    89057.870
415   123914.429
416  5055352.301
417  1838156.651
418    17511.891
419   365041.149
420  2450706.675
421    83907.509
422  6567615.386
423    37983.419
424     5326.445
425  3380562.704
426  1135488.601
427    37941.677
428   909126.286
429  1271615.243
430    66869.655
431  6549315.601
432     8617.612
433   126321.251
434    35828.816
435    47423.306
436     1641.657
437    70071.756
438     6804.987
439    91656.921
440    65432.469
441     5972.694
442   202887.567
443   545767.021
444    17449.419
445    83774.458
446  8132723.151
447   290180.286
448     5315.489
449   474461.294
450     2927.194
451     2933.776
452      500.397
453   151533.802
454     2158.919
455   333703.340
456  2010753.568
457   181774.845
458   848726.629
459     5977.779
460  4815107.488
461    16791.642
462     2751.315
463   498858.643
464    74011.856
465    36754.416
466  6876002.978
467     3427.796
468    83371.533
469  8143978.953
470     8252.236
471  1037323.578
472    44335.417
473  1735352.965
474    45427.344
475  4832737.649
476   352037.721
477    23257.292
478  3364141.352
479   328054.023
480    57048.529
481   405434.072
482    83907.509
483  8685219.447
484  2381122.892
485     1974.544
486    66850.593
487  6394722.205
488    11626.180
489    66503.501
490   619324.668
491    16094.470
492  3927663.019
493   566713.871
494    24735.700
495    32074.254
496  5299548.567
497    40153.104
498   843124.829
499    79179.536
500    56436.267
501  6273895.347
502    17147.267
503     4801.216
504     1377.039
505    58733.552
506    83503.470
507  7496880.289
508   216041.436
509     2265.039
510  1936281.936
511   106344.147
512    13084.321
513  1614854.862
514   436604.541
515      125.057
516   129010.467
517      933.720
518   187464.527
519   502300.728
520    32866.220
521  2583185.011
522     2928.351
523     5298.054
524  3483621.093
525     7146.460
526  1013002.459
527   261864.200
528   712649.528
529  2973212.616
530     1700.109
531   102247.438
532    11118.571
533  3699808.784
534     9685.634
535    11130.330
536     5578.218
537  1771719.775
538    56748.932
539      676.921
540  2246765.394
541     2082.392
542    78859.591
543  4301286.424
544   289721.817
545  1750536.410
546     8844.632
547    19075.191
548    83776.657
549  8654539.177
550   241507.740
551   115676.301
552    11963.491
553   107053.737
554     1162.374
555    35012.131
556    32527.698
557   238382.759
558  1135556.127
559      124.985
560   317229.193
561   110600.718
562   414169.117
563      674.915
564   106798.368
565     9726.817
566   734029.551
567   191483.587
568   802190.171
569      934.939
570     3225.533
571     8851.165
572  3515567.248
573     1629.306
574    70595.877
575    57819.390
576  6358167.847
577    14362.754
578  1952371.768
579  1046633.510
580     1244.902
581   185690.705
582    83512.486
583  6453480.980
584     1308.569
585    59160.764
586  2703671.549
587       99.993
588   637271.836
589  2050001.874
590   150563.059
591  1912489.154
592      817.588
593  2749742.820
594     5853.176
595    50028.664
596   211922.790
597      537.342
598  1055231.789
599     2407.627
600  3849017.228
601    33326.042
602      774.956
603  2168396.403
604   209237.025
605   325737.844
606   156469.915
607  1609483.396
608     1675.337
609     1876.816
610   881426.341
611  1839544.882
612    38415.146
613  5279075.948
614    24800.563
615       25.008
616  3301098.610
617    66208.168
618      150.054
619   168885.799
620     3219.549
621  1795129.320
622  6908987.265
623   592051.494
624    37556.237
625    70466.185
626  3280498.142
627   205168.797
628     4506.882
629    21978.616
630  3184433.555
631    73772.935
632  4078534.020
633    11693.658
634      426.570
635     2002.226
636     4152.478
637    20231.963
638  4692587.188
639    60670.797
640  5228842.320
641     3087.095
642     2101.287
643   626694.932
644     5954.148
645  1364600.965
646    12508.625
647    26074.375
648  5413471.027
649    39442.724
650    16854.837
651   101993.329
652     5459.185
653     1612.368
654  3228781.995
655    42218.468
656  3994103.984
657    16636.052
658   627459.626
659   113817.315
660  3138272.401
661  2478050.650
662  3839166.995
663    71483.297
664    89725.413
665    20025.620
666    28426.567
667    54530.534
668     4174.331
669   728076.501
670   701168.605
671  1525004.921
672    15452.913
673    91224.937
674    76499.068
675     5979.456
676   128959.407
677   759977.471
678     2275.643
679  3259999.919
680     8812.764
681    27489.337
682  2288690.505
683      450.141
684     3519.779
685  4294177.354
686    99228.022
687   353218.330
688    37448.258
689    14995.497
690  4545100.991
691   230648.439
692    23752.245
693  2047880.973
694    40884.649
695    68790.754
696   105123.257
697  1115900.164
698  1586229.618
699    70121.194
700   376674.453
701   128448.362
702    83907.509
703  9166260.611
704   155380.976
705    78934.350
706  4951920.629
707   226100.774
708  1358776.703
709    29014.713
710  7182786.260
711     1201.216
712   109978.114
713    68228.925
714     1954.354
715    77799.230
716  8026140.128
717   104076.283
718   239651.825
719      375.212
720   678960.476
721     7964.973
722  1353312.330
723    10720.820
724    12671.708
725    45272.387
726  2214624.157
727     7268.076
728     2151.318
729  3694190.727
730  1735810.434
731      725.184
732     7025.553
733  2004014.940
734    34717.550
735     5325.742
736     2501.641
737    78338.571
738  1194834.063
739   830384.309
740   313801.787
741    16988.309
742  7649398.142
743   367821.194
744     7502.878
745      275.102
746    36454.460
747    61233.332
748  6020540.413
749   376695.235
750     3702.231
751      408.471
752      539.832
753  3247906.848
754      399.304
755    86150.548
756      449.908
757   105404.321
758    72543.665
759  2194810.819
760    52287.235
761    20633.492
762     5228.435
763  2445418.588
764    12858.141
765    79355.225
766    83772.286
767    71199.995
768    83907.509
769  8562825.592
770   397174.542
771    65719.144
772    77391.581
773    83368.507
774  8101215.862
775    98341.584
776  1357402.017
777   485889.756
778    79100.772
779  7486970.541
780   274702.356
781    48182.455
782    76711.159
783      225.019
784   105624.582
785   295288.929
786     2501.691
787   136133.134
788    63593.005
789    65806.066
790  4408797.456
791      175.097
792   152716.975
793  6168159.172
794   226054.621
795     2777.156
796  1137059.188
797    52177.303
798  5650872.004
799    13012.267
800    27583.664
801  1127918.830
802     4426.646
803    11757.534
804    13415.936
805  3133098.778
806   104087.183
807     1541.155
808    53634.686
809   781217.197
810    74689.246
811  4615587.556
812   155477.221
813    26698.910
814   109453.351
815    95129.559
816     1982.507
817    83770.942
818  5554479.761
819    79762.812
820  7139817.567
821  1356930.581
822  1017704.675
823    78633.749
824    83512.471
825  7782794.199
826   213332.542
827   491504.750
828     1305.498
829   109347.872
830   174443.439
831   169862.453
832    77509.601
833  5340032.131
834   136245.377
835      923.626
836  2288805.591
837    82581.414
838  6096275.706
839    31652.340
840    80691.684
841  8473199.204
842     2958.150
843     3177.353
844      375.282
845   116880.440
846     4452.076
847  2376991.912
848   102206.271
849   212405.265
850    57873.817
851  3787340.633
852    25168.658
853   685923.984
854    78584.464
855  4228744.833
856   441231.082
857      737.413
858    82818.437
859   108307.657
860       74.983
861    12915.819
862     1629.999
863   663824.340
864   710938.874
865   460340.954
866      950.133
867  2112591.027
868    71906.043
869  1124189.032
870    47907.579
871  5989352.766
872     6831.664
873     2403.826
874  1847960.395
875    19016.438
876  2065405.653
877     6651.814
878   129911.091
879   537875.799
880     3452.497
881   513145.937
882  5154162.984
883    99356.131
884  4215697.128
885    46489.925
886   308762.635
887    25982.435
888     2464.710
889    14101.102
890   354213.279
891     6950.780
892    11141.584
893     4567.566
894     9263.446
895  3253357.995
896    14546.815
897      274.941
898    36632.981
899      789.792
900   649087.311
901     2900.876
902    81773.325
903  5746615.298
904   117113.300
905     6004.838
906   507106.411
907   158366.697
908   329503.221
909     2501.010
910     4998.945
911  1906373.972
912    42515.241
913    30018.262
914    85063.941
915    93632.917
916     6009.641
917   575017.020
918   975177.862
919     5001.175
920    74773.142
921  5998335.283
922    26715.698
923      950.288
924   123106.583
925      934.939
926    37484.295
927  5219814.477
928     1584.025
929      124.974
930    13829.017
931     1400.307
932      813.490
933  1291040.158
934     4377.987
935  3615052.977
936    64961.920
937     4998.945
938    77876.226
939  5918715.779
940    33045.115
941    27336.486
942    36366.946
943  3609841.130
944    25962.363
945  6956076.236
946     6370.716
947    35506.522
948   686776.938
949      412.920
950      625.091
951     1836.931
952    70115.272
953  6306171.029
954    38585.385
955  6147085.292
956    53223.656
957   116555.204
958    50038.758
959    42519.655
960  5364654.884
961     4894.032
962   110113.693
963    20957.591
964    29489.761
965    42514.561
966   146754.384
967    83505.415
968  4438589.156
969   109531.305
970    94896.069
971    57523.665
972   109654.561
973    83775.829
974  6073758.757
975    99155.405
976    74446.093
977   396990.321
978    12509.741
979  1275958.165
980   105147.777
981  3964531.561
982  4348222.328
983    83829.870
984   160848.375
985      936.159
986    10455.857
987  5271263.101
988   124932.093
989      149.975
990     1725.268
991   122131.468
992    81835.726
993   132839.623
994    47332.436
995   384931.189
996   838388.318
997    30428.448
998     6342.424
999    93072.786
1000     921.737
1001     299.908
1002     250.093
1003   10644.794
1004 5277520.995
1005    3000.483
1006 1992527.367
1007     467.473
1008 1563617.681
1009    1724.870
1010   81510.090
1011 6800827.172
1012  402898.404
1013   79666.247
1014 5651137.275
1015   75244.689
1016 5799785.956
1017 1024372.520
1018    2435.317
1019 1767390.664
1020   22541.160
1021   38315.253
1022   65856.067
1023      25.013
1024  826066.965
1025   83502.130
1026 7443139.968
1027  113699.471
1028     878.557
1029 1127658.207
1030   83773.097
1031 7743323.737
1032   22515.427
1033   77750.430
1034 6586936.648
1035 1388927.255
1036   82310.709
1037 7511787.748
1038  722062.463
1039  415684.676
1040   82027.480
1041 6137718.203
1042  640525.165
1043 1654158.428
1044  136888.300
1045   26337.142
1046 2754845.582
1047  104281.162
1048   74323.057
1049  167032.464
1050 1223414.277
1051  149591.424
1052   53516.991
1053   56578.617
1054 5165214.315
1055   44777.526
1056  121057.537
1057 1686308.809
1058 1064666.340
1059 2688429.189
1060  700677.012
1061   28102.925
1062  139974.450
1063    8260.606
1064    4162.469
1065 2942758.352
1066   50146.853
1067   68677.518
1068   10152.053
1069  676461.411
1070  508825.427
1071   31255.313
1072  516119.634
1073   58413.226
1074   12779.071
1075  237466.570
1076  421569.214
1077 2488131.209
1078 2229538.893
1079   17945.607
1080 3760454.006
1081    1900.140
1082  350227.359
1083    8882.278
1084 4345692.265
1085     373.891
1086  106421.497
1087   83502.388
1088 7091479.036
1089  158934.696
1090   44924.145
1091   95616.153
1092  196340.915
1093    1305.498
1094   83966.860
1095    2663.059
1096 3476430.577
1097   83775.554
1098 8134615.686
1099  130760.625
1100    3353.004
1101   83775.829
1102 7746048.467
1103   78843.416
1104 5211705.246
1105    9365.666
1106 1504086.137
1107   78321.791
1108 6927672.284
1109     934.328
1110  111325.765
1111   32080.785
1112 3669516.902
1113     700.319
1114   16105.597
1115 5162885.273
1116   41495.417
1117  456500.949
1118  140792.474
1119  263721.587
1120   16877.990
1121    3283.072
1122   63781.715
1123   25159.094
1124   68334.949
1125 6422667.972
1126    7527.787
1127     700.473
1128   54976.459
1129   34220.218
1130   39015.543
1131   88345.975
1132    4050.799
1133  127986.226
1134    1801.298
1135   65724.866
1136   32365.817
1137   25859.679
1138      50.035
1139   19685.756
1140  700106.954
1141 1588298.417
1142  182880.157
1143  119953.435
1144   49731.731
1145  175261.800
1146   98434.068
1147   16867.279
1148  292823.394</code></pre>
</div>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>threshold <span class="ot">&lt;-</span> <span class="fu">quantile</span>(Change_Data<span class="sc">$</span>log_R2_1, <span class="at">probs =</span> <span class="fl">0.95</span>)</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter the dataframe to include only rows where 'y' is less than or equal to the threshold</span></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>filtered_df <span class="ot">&lt;-</span> Change_Data <span class="sc">%&gt;%</span></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(log_R2_1 <span class="sc">&gt;=</span> threshold)</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a><span class="fu">range</span>(filtered_df<span class="sc">$</span>log_R2_1) <span class="co">#[1] 1.035344 3.761139</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.228595 4.002097</code></pre>
</div>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>filtered_df <span class="ot">&lt;-</span> Change_Data <span class="sc">%&gt;%</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(log_R2_1 <span class="sc">&lt;=</span> threshold)</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a><span class="fu">range</span>(filtered_df<span class="sc">$</span>log_R2_1) <span class="co">#[1] -3.296224  1.028331</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -2.935921  1.219707</code></pre>
</div>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(Change_Data, <span class="fu">aes</span>(<span class="at">x =</span> log_R2_1))<span class="sc">+</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="0_1_Atlas_prep_clean_files/figure-html/temporal%20change-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>Change_Data2 <span class="ot">&lt;-</span> Change_Data <span class="sc">%&gt;%</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">quartile =</span> <span class="fu">ntile</span>(log_R2_1, <span class="dv">5</span>))</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(Change_Data2, <span class="fu">aes</span>(<span class="at">x=</span>log_R2_1))<span class="sc">+</span></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> tp2_AOO_1), <span class="at">col=</span><span class="st">"blue"</span>)<span class="sc">+</span></span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> tp1_AOO_1), <span class="at">col =</span> <span class="st">"red"</span>)<span class="sc">+</span></span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">y =</span> tp2_AOO_1), <span class="at">col=</span><span class="st">"blue"</span>)<span class="sc">+</span></span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">y =</span> tp1_AOO_1), <span class="at">col=</span><span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using method = 'gam' and formula = 'y ~ s(x, bs = "cs")'
`geom_smooth()` using method = 'gam' and formula = 'y ~ s(x, bs = "cs")'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="0_1_Atlas_prep_clean_files/figure-html/temporal%20change-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>Change_Data <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(dataset) <span class="sc">%&gt;%</span> rstatix<span class="sc">::</span><span class="fu">get_summary_stats</span>(<span class="at">type=</span><span class="st">"common"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 11
   dataset      variable     n      min    max   median     iqr     mean      sd
   &lt;fct&gt;        &lt;fct&gt;    &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;
 1 Birds_Atlas… log_R2_1   200   -0.936 2.39e0  2.7 e-2 2.02e-1  1.48e-1 4.32e-1
 2 Birds_Atlas… tp1_AOO…   200  136.    8.39e4  4.64e+4 6.70e+4  4.37e+4 3.13e+4
 3 Birds_Atlas… tp2_AOO…   200  131.    8.39e4  5.09e+4 6.67e+4  4.58e+4 3.14e+4
 4 Birds_Atlas… log_R2_1   237   -1.79  3.76e0  8   e-3 4.14e-1  4.8 e-2 6.68e-1
 5 Birds_Atlas… tp1_AOO…   237   25.0   1.30e5  1.73e+4 7.00e+4  3.81e+4 4.30e+4
 6 Birds_Atlas… tp2_AOO…   237   25.0   1.31e5  2.06e+4 7.62e+4  4.03e+4 4.39e+4
 7 Birds_atlas… log_R2_1   208   -2.08  2.54e0 -1.4 e-2 5.07e-1 -2.9 e-2 5.77e-1
 8 Birds_atlas… tp1_AOO…   208  372.    4.25e5  2.00e+4 7.44e+4  6.48e+4 9.65e+4
 9 Birds_atlas… tp2_AOO…   208  370.    4.29e5  1.83e+4 8.57e+4  6.76e+4 1.01e+5
10 Birds_atlas… log_R2_1   503   -2.94  4.00e0  2.27e-1 3.62e-1  3.6 e-1 6.33e-1
11 Birds_atlas… tp1_AOO…   503 1770.    7.20e6  8.07e+5 2.98e+6  1.82e+6 2.08e+6
12 Birds_atlas… tp2_AOO…   503 1770.    9.17e6  1.14e+6 3.71e+6  2.33e+6 2.53e+6
# ℹ 2 more variables: se &lt;dbl&gt;, ci &lt;dbl&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="do">### =============================================== </span><span class="al">###</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="co">#rm(species_data_new2, log_ratio_data)</span></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a><span class="do">### =============================================== </span><span class="al">###</span></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">is.na</span>(Change_Data))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>verbatim_name       dataset      log_R2_1     tp1_AOO_1     tp2_AOO_1 
            0             0             0             0             0 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>Change_Data <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n_distinct</span>(verbatim_name))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    n
1 841</code></pre>
</div>
</div>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>