<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Friederike Wölke">
<meta name="dcterms.date" content="2024-04-20">

<title>Predictor Variables Calculations 4</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="3d_ClimateNicheBreadth_files/libs/clipboard/clipboard.min.js"></script>
<script src="3d_ClimateNicheBreadth_files/libs/quarto-html/quarto.js"></script>
<script src="3d_ClimateNicheBreadth_files/libs/quarto-html/popper.min.js"></script>
<script src="3d_ClimateNicheBreadth_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="3d_ClimateNicheBreadth_files/libs/quarto-html/anchor.min.js"></script>
<link href="3d_ClimateNicheBreadth_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="3d_ClimateNicheBreadth_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="3d_ClimateNicheBreadth_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="3d_ClimateNicheBreadth_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="3d_ClimateNicheBreadth_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#clean-environment" id="toc-clean-environment" class="nav-link active" data-scroll-target="#clean-environment"><span class="header-section-number">1</span> Clean environment</a></li>
  <li><a href="#libraries" id="toc-libraries" class="nav-link" data-scroll-target="#libraries"><span class="header-section-number">2</span> Libraries</a></li>
  <li><a href="#data" id="toc-data" class="nav-link" data-scroll-target="#data"><span class="header-section-number">3</span> Data</a>
  <ul class="collapse">
  <li><a href="#species-data" id="toc-species-data" class="nav-link" data-scroll-target="#species-data"><span class="header-section-number">3.1</span> Species data</a>
  <ul class="collapse">
  <li><a href="#create-taxon-lookup-table-with-synonyms-from-botw-taxonomic-info" id="toc-create-taxon-lookup-table-with-synonyms-from-botw-taxonomic-info" class="nav-link" data-scroll-target="#create-taxon-lookup-table-with-synonyms-from-botw-taxonomic-info"><span class="header-section-number">3.1.1</span> Create Taxon Lookup table with synonyms from BOTW Taxonomic Info</a></li>
  <li><a href="#get-rl-status-from-birdlife" id="toc-get-rl-status-from-birdlife" class="nav-link" data-scroll-target="#get-rl-status-from-birdlife"><span class="header-section-number">3.1.2</span> Get RL Status from BirdLife</a></li>
  <li><a href="#rasterize-birdlife-rangemaps" id="toc-rasterize-birdlife-rangemaps" class="nav-link" data-scroll-target="#rasterize-birdlife-rangemaps"><span class="header-section-number">3.1.3</span> Rasterize BirdLife rangemaps</a></li>
  <li><a href="#calculate-global-range-size" id="toc-calculate-global-range-size" class="nav-link" data-scroll-target="#calculate-global-range-size"><span class="header-section-number">3.1.4</span> Calculate Global Range Size</a></li>
  </ul></li>
  <li><a href="#climate-data" id="toc-climate-data" class="nav-link" data-scroll-target="#climate-data"><span class="header-section-number">3.2</span> Climate Data</a>
  <ul class="collapse">
  <li><a href="#aggregate-chelsa-to-1-resolution" id="toc-aggregate-chelsa-to-1-resolution" class="nav-link" data-scroll-target="#aggregate-chelsa-to-1-resolution"><span class="header-section-number">3.2.1</span> Aggregate CHELSA to 1° resolution</a></li>
  </ul></li>
  <li><a href="#extract-bird-coordinates" id="toc-extract-bird-coordinates" class="nav-link" data-scroll-target="#extract-bird-coordinates"><span class="header-section-number">3.3</span> Extract Bird Coordinates</a></li>
  <li><a href="#climate-pca" id="toc-climate-pca" class="nav-link" data-scroll-target="#climate-pca"><span class="header-section-number">3.4</span> Climate PCA</a></li>
  </ul></li>
  <li><a href="#project-birds-to-climmate-space" id="toc-project-birds-to-climmate-space" class="nav-link" data-scroll-target="#project-birds-to-climmate-space"><span class="header-section-number">4</span> Project Birds to climmate space</a>
  <ul class="collapse">
  <li><a href="#plot-birds-in-climate-space" id="toc-plot-birds-in-climate-space" class="nav-link" data-scroll-target="#plot-birds-in-climate-space"><span class="header-section-number">4.1</span> Plot Birds in Climate Space</a></li>
  </ul></li>
  <li><a href="#calculate-niche-breadth" id="toc-calculate-niche-breadth" class="nav-link" data-scroll-target="#calculate-niche-breadth"><span class="header-section-number">5</span> Calculate Niche Breadth</a>
  <ul class="collapse">
  <li><a href="#plot-niche-breadth" id="toc-plot-niche-breadth" class="nav-link" data-scroll-target="#plot-niche-breadth"><span class="header-section-number">5.1</span> Plot Niche Breadth</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Predictor Variables Calculations 4</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Friederike Wölke </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">April 20, 2024</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="clean-environment" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Clean environment</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">gc</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          used (Mb) gc trigger (Mb) max used (Mb)
Ncells  572936 30.6    1307960 69.9   658000 35.2
Vcells 1047335  8.0    8388608 64.0  1768422 13.5</code></pre>
</div>
</div>
</section>
<section id="libraries" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Libraries</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf); <span class="fu">sf_use_s2</span>(<span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Linking to GEOS 3.11.2, GDAL 3.7.2, PROJ 9.3.0; sf_use_s2() is TRUE</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Spherical geometry (s2) switched off</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(terra)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>terra 1.7.71</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:terra':

    intersect, union</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggfortify)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(rasterSp, climateNiche) <span class="co"># require dependencies to be installed (see GitHub of these packages)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="data" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Data</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>source_Git <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"c:/Users/wolke/OneDrive - CZU v Praze/Dokumenty/GitHub/BEAST_General_Procedures/Project_Frieda/StaticPredictors/"</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>out_path <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">paste0</span>(source_Git, <span class="st">"out/"</span>))</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>source_predictors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"c:/Users/wolke/OneDrive - CZU v Praze/Dokumenty/PhD_Projects/StaticPredictors/Data/"</span>)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>CHELSA_path <span class="ot">&lt;-</span> <span class="fu">paste0</span>(source_predictors, <span class="st">"Chelsa_Bio_PET/"</span>)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="co"># List all the .tif files in the directory</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>tif_files <span class="ot">&lt;-</span> <span class="fu">list.files</span>(<span class="at">path=</span>CHELSA_path, <span class="at">pattern =</span> <span class="st">".tif$"</span>)</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="co"># The input file geodatabase from BirdLife International 2018</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>fgdb <span class="ot">&lt;-</span><span class="st">"c:/Users/wolke/OneDrive - CZU v Praze/Datasets/Raw/Distributions/Birds_of_the_world/BOTW.gdb"</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="species-data" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="species-data"><span class="header-section-number">3.1</span> Species data</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Taxonomic data from BirdLife international</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>Tax <span class="ot">&lt;-</span> <span class="fu">st_read</span>(fgdb, <span class="at">layer =</span> <span class="st">"Taxonomic_checklist"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Order_, FamilyName, ScientificName, RL_Category, Synonyms) <span class="sc">%&gt;%</span> </span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Order"</span> <span class="ot">=</span> <span class="st">"Order_"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Order =</span> stringr<span class="sc">::</span><span class="fu">str_to_sentence</span>(Order))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `Taxonomic_checklist' from data source 
  `C:\Users\wolke\OneDrive - CZU v Praze\Datasets\Raw\Distributions\Birds_of_the_world\BOTW.gdb' 
  using driver `OpenFileGDB'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: no simple feature geometries present: returning a data.frame or tbl_df</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>Tax[Tax <span class="sc">==</span> <span class="st">"&lt;NA&gt;"</span>] <span class="ot">=</span> <span class="cn">NA</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Atlas species names</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>spData <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"../../out/csv/SpeciesNamesData.csv"</span>) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(verbatim_name) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="create-taxon-lookup-table-with-synonyms-from-botw-taxonomic-info" class="level3" data-number="3.1.1">
<h3 data-number="3.1.1" class="anchored" data-anchor-id="create-taxon-lookup-table-with-synonyms-from-botw-taxonomic-info"><span class="header-section-number">3.1.1</span> Create Taxon Lookup table with synonyms from BOTW Taxonomic Info</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Reduce Taxonomic data from BirdLife 2018 to Species Names columns</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>Tax_red <span class="ot">&lt;-</span> Tax <span class="sc">%&gt;%</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">distinct</span>(ScientificName, Synonyms) <span class="sc">%&gt;%</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="st">"AtlasSp"</span> <span class="ot">=</span> <span class="st">"ScientificName"</span>)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>Tax_red<span class="sc">$</span>TaxID <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(Tax_red))</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Tax_red)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                     AtlasSp Synonyms TaxID
1             Rhea americana     &lt;NA&gt;     1
2               Rhea pennata     &lt;NA&gt;     2
3        Casuarius casuarius     &lt;NA&gt;     3
4         Casuarius bennetti     &lt;NA&gt;     4
5 Casuarius unappendiculatus     &lt;NA&gt;     5
6   Dromaius novaehollandiae     &lt;NA&gt;     6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Quick Matches</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>sp_direct_match <span class="ot">&lt;-</span> <span class="fu">intersect</span>(spData, Tax_red<span class="sc">$</span>AtlasSp) <span class="co"># 733</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>sp_syn_match <span class="ot">&lt;-</span> <span class="fu">intersect</span>(spData, Tax_red<span class="sc">$</span>Synonyms) <span class="co"># 72</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create Dataframe that will be filled for taxonomic matching</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>Atlas_sp <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">AtlasSp =</span> spData,</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">AtlasID =</span> <span class="fu">seq</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(spData)),</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">match_type =</span> <span class="cn">NA</span>,</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">match =</span> <span class="cn">NA</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(AtlasSp) <span class="sc">%&gt;%</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">match_type =</span> <span class="fu">case_when</span>(</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>            AtlasSp <span class="sc">%in%</span> sp_direct_match <span class="sc">~</span> <span class="st">"direct"</span>,</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>            AtlasSp <span class="sc">%in%</span> sp_syn_match <span class="sc">~</span> <span class="st">"synonym"</span>,</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>            <span class="at">.default =</span> <span class="cn">NA</span></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a><span class="co"># =================================== Step 1: Direct Matches  ===================================== #</span></span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>Atlas_merged <span class="ot">&lt;-</span> <span class="fu">left_join</span>(Atlas_sp, Tax_red <span class="sc">%&gt;%</span> <span class="fu">filter</span>(AtlasSp <span class="sc">%in%</span> sp_direct_match)) <span class="sc">%&gt;%</span></span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(AtlasSp) <span class="sc">%&gt;%</span></span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">match =</span> <span class="fu">case_when</span>(<span class="fu">is.na</span>(TaxID) <span class="sc">~</span> <span class="dv">0</span>, <span class="sc">!</span><span class="fu">is.na</span>(TaxID) <span class="sc">~</span> <span class="dv">1</span>),</span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">AtlasSp_new =</span> <span class="fu">case_when</span>(match <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> AtlasSp, match <span class="sc">==</span> <span class="dv">0</span> <span class="sc">~</span> <span class="st">""</span>),</span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">ScientificName =</span> <span class="fu">case_when</span>(match <span class="sc">==</span> <span class="dv">0</span> <span class="sc">~</span> <span class="cn">NA</span>, match <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> AtlasSp)</span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(AtlasSp)`</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>Atlas_merged <span class="sc">%&gt;%</span> <span class="fu">filter</span>(AtlasSp_new <span class="sc">==</span> <span class="st">""</span>) <span class="sc">%&gt;%</span> <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> <span class="fu">distinct</span>(match_type)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 1
  match_type
  &lt;chr&gt;     
1 synonym   
2 &lt;NA&gt;      </code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>Atlas_merged <span class="sc">%&gt;%</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(match <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">n_distinct</span>() <span class="co"># 733 species with matching taxonomy. We can delete them from the matching process now</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 733</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Checks:</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>spData_unmmatched <span class="ot">&lt;-</span> Atlas_merged <span class="sc">%&gt;%</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(match <span class="sc">==</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(AtlasSp) <span class="co"># 108 species still missing</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>sp_matched <span class="ot">&lt;-</span> Atlas_merged <span class="sc">%&gt;%</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(match <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(AtlasSp)</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>syn_match <span class="ot">&lt;-</span> <span class="fu">intersect</span>(spData_unmmatched, sp_syn_match) <span class="co"># of those 108, 67 species can be matched directly from the synonyms species</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a><span class="fu">intersect</span>(sp_syn_match, sp_matched) <span class="co"># 5 Species were matched but are also found in the synonyms column.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Luscinia svecica"  "Cuculus optatus"   "Buteo rufinus"    
[4] "Cuculus saturatus" "Melanitta fusca"  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>Atlas_merged <span class="sc">%&gt;%</span> <span class="fu">filter</span>(AtlasSp <span class="sc">%in%</span> <span class="fu">intersect</span>(sp_syn_match, sp_matched))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 8
# Groups:   AtlasSp [5]
  AtlasSp     AtlasID match_type match Synonyms TaxID AtlasSp_new ScientificName
  &lt;chr&gt;         &lt;int&gt; &lt;chr&gt;      &lt;dbl&gt; &lt;chr&gt;    &lt;int&gt; &lt;chr&gt;       &lt;chr&gt;         
1 Luscinia s…     115 direct         1 Luscini…  5744 Luscinia s… Luscinia svec…
2 Cuculus op…     441 direct         1 Cuculus…  9406 Cuculus op… Cuculus optat…
3 Buteo rufi…     595 direct         1 &lt;NA&gt;      9635 Buteo rufi… Buteo rufinus 
4 Cuculus sa…     637 direct         1 Cuculus…  9405 Cuculus sa… Cuculus satur…
5 Melanitta …     721 direct         1 Melanit…  8460 Melanitta … Melanitta fus…</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># =================================== Step 2: Direct Synonyms =========================================== #</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>Atlas_synonyms <span class="ot">&lt;-</span> Atlas_merged <span class="sc">%&gt;%</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(AtlasID, AtlasSp, match_type, match) <span class="sc">%&gt;%</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(AtlasSp <span class="sc">%in%</span> syn_match)</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>Atlas_synonyms<span class="sc">$</span>Synonyms <span class="ot">&lt;-</span> Atlas_synonyms<span class="sc">$</span>AtlasSp</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>Atlas_synonyms_merged <span class="ot">&lt;-</span> <span class="fu">left_join</span>(Atlas_synonyms, Tax_red <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Synonyms <span class="sc">%in%</span> syn_match) <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="st">"ScientificName"</span> <span class="ot">=</span> <span class="st">"AtlasSp"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">AtlasSp_new =</span> ScientificName,</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">match =</span> <span class="dv">1</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(Synonyms)`</code></pre>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Atlas_synonyms_merged)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 8
# Groups:   AtlasSp [6]
  AtlasID AtlasSp     match_type match Synonyms ScientificName TaxID AtlasSp_new
    &lt;int&gt; &lt;chr&gt;       &lt;chr&gt;      &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;          &lt;int&gt; &lt;chr&gt;      
1      13 Anas clype… synonym        1 Anas cl… Spatula clype…   406 Spatula cl…
2      16 Anas querq… synonym        1 Anas qu… Spatula querq…   416 Spatula qu…
3      17 Anas strep… synonym        1 Anas st… Mareca strepe…   386 Mareca str…
4      24 Aquila pom… synonym        1 Aquila … Clanga pomari…  3076 Clanga pom…
5      42 Carduelis … synonym        1 Carduel… Acanthis flam…  8483 Acanthis f…
6      43 Carduelis … synonym        1 Carduel… Spinus spinus   7571 Spinus spi…</code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Atlas_merged)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 8
# Groups:   AtlasSp [6]
  AtlasSp     AtlasID match_type match Synonyms TaxID AtlasSp_new ScientificName
  &lt;chr&gt;         &lt;int&gt; &lt;chr&gt;      &lt;dbl&gt; &lt;chr&gt;    &lt;int&gt; &lt;chr&gt;       &lt;chr&gt;         
1 Accipiter …       1 direct         1 &lt;NA&gt;      3022 Accipiter … Accipiter gen…
2 Accipiter …       2 direct         1 &lt;NA&gt;      3015 Accipiter … Accipiter nis…
3 Acrocephal…       3 direct         1 &lt;NA&gt;     11005 Acrocephal… Acrocephalus …
4 Acrocephal…       4 direct         1 &lt;NA&gt;      6584 Acrocephal… Acrocephalus …
5 Acrocephal…       5 direct         1 &lt;NA&gt;      6577 Acrocephal… Acrocephalus …
6 Acrocephal…       6 direct         1 &lt;NA&gt;      6582 Acrocephal… Acrocephalus …</code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">is.na</span>(Atlas_synonyms_merged))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       AtlasID        AtlasSp     match_type          match       Synonyms 
             0              0              0              0              0 
ScientificName          TaxID    AtlasSp_new 
             0              0              0 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>Atlas_synonyms_merged <span class="sc">%&gt;%</span> <span class="fu">filter</span>(ScientificName <span class="sc">==</span> <span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 0 × 8
# Groups:   AtlasSp [0]
# ℹ 8 variables: AtlasID &lt;int&gt;, AtlasSp &lt;chr&gt;, match_type &lt;chr&gt;, match &lt;dbl&gt;,
#   Synonyms &lt;chr&gt;, ScientificName &lt;chr&gt;, TaxID &lt;int&gt;, AtlasSp_new &lt;chr&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>Atlas_merged2 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(Atlas_merged <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span>(AtlasSp <span class="sc">%in%</span> syn_match)), Atlas_synonyms_merged)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Delete species from vector that have been matched already:</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>spData_unmmatched2 <span class="ot">&lt;-</span> Atlas_merged2 <span class="sc">%&gt;%</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="fu">is.na</span>(TaxID)) <span class="sc">%&gt;%</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(AtlasSp)</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>Atlas_merged3 <span class="ot">&lt;-</span> Atlas_merged2 <span class="sc">%&gt;%</span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(AtlasSp) <span class="sc">%&gt;%</span></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">match_type =</span></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>            <span class="fu">case_when</span>(</span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>                (AtlasSp <span class="sc">%in%</span> spData_unmmatched2) <span class="sc">~</span> <span class="st">"manually"</span>,</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>                <span class="at">.default =</span> match_type</span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a><span class="do">## Note: There is a script that can do a partial match on the concatenated strings in the original Synonyms column. Not needed here, but just in case.</span></span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a><span class="co"># =================================== Step 3: Manual Matching  =========================================== #</span></span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Lets continue with manual matching of names: (Note: Updated names were retrieved from Wikipedia on 21.04.2024)</span></span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a>unmatched <span class="ot">&lt;-</span> Atlas_merged3 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(match_type <span class="sc">==</span> <span class="st">"manually"</span>)</span>
<span id="cb41-22"><a href="#cb41-22" aria-hidden="true" tabindex="-1"></a>unmatched<span class="sc">$</span>AtlasSp_new <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"Sylvia"</span>, <span class="st">"Curruca"</span>, unmatched<span class="sc">$</span>AtlasSp)</span>
<span id="cb41-23"><a href="#cb41-23" aria-hidden="true" tabindex="-1"></a>unmatched<span class="sc">$</span>AtlasSp_new <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"Carduelis cannabina"</span>, <span class="st">"Linaria cannabina"</span>, unmatched<span class="sc">$</span>AtlasSp_new)</span>
<span id="cb41-24"><a href="#cb41-24" aria-hidden="true" tabindex="-1"></a>unmatched<span class="sc">$</span>AtlasSp_new <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"Carduelis chloris"</span>, <span class="st">"Chloris chloris"</span>, unmatched<span class="sc">$</span>AtlasSp_new)</span>
<span id="cb41-25"><a href="#cb41-25" aria-hidden="true" tabindex="-1"></a>unmatched<span class="sc">$</span>AtlasSp_new <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"Linaria chloris"</span>, <span class="st">"Chloris chloris"</span>, unmatched<span class="sc">$</span>AtlasSp_new)</span>
<span id="cb41-26"><a href="#cb41-26" aria-hidden="true" tabindex="-1"></a>unmatched<span class="sc">$</span>AtlasSp_new <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"Locustella pryeri"</span>, <span class="st">"Helopsaltes pryeri"</span>, unmatched<span class="sc">$</span>AtlasSp_new)</span>
<span id="cb41-27"><a href="#cb41-27" aria-hidden="true" tabindex="-1"></a>unmatched<span class="sc">$</span>AtlasSp_new <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"Cyanecula svecica"</span>, <span class="st">"Luscinia svecica"</span>, unmatched<span class="sc">$</span>AtlasSp_new)</span>
<span id="cb41-28"><a href="#cb41-28" aria-hidden="true" tabindex="-1"></a>unmatched<span class="sc">$</span>AtlasSp_new <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"Passer rutilans"</span>, <span class="st">"Passer cinnamomeus"</span>, unmatched<span class="sc">$</span>AtlasSp_new)</span>
<span id="cb41-29"><a href="#cb41-29" aria-hidden="true" tabindex="-1"></a>unmatched<span class="sc">$</span>AtlasSp_new <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"Luscinia akahige"</span>, <span class="st">"Larvivora akahige"</span>, unmatched<span class="sc">$</span>AtlasSp_new)</span>
<span id="cb41-30"><a href="#cb41-30" aria-hidden="true" tabindex="-1"></a>unmatched<span class="sc">$</span>AtlasSp_new <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"Gallirallus okinawae"</span>, <span class="st">"Hypotaenidia okinawae"</span>, unmatched<span class="sc">$</span>AtlasSp_new)</span>
<span id="cb41-31"><a href="#cb41-31" aria-hidden="true" tabindex="-1"></a>unmatched<span class="sc">$</span>AtlasSp_new <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"Luscinia komadori"</span>, <span class="st">"Larvivora komadori"</span>, unmatched<span class="sc">$</span>AtlasSp_new)</span>
<span id="cb41-32"><a href="#cb41-32" aria-hidden="true" tabindex="-1"></a>unmatched<span class="sc">$</span>AtlasSp_new <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"Hirundo daurica"</span>, <span class="st">"Cecropis daurica"</span>, unmatched<span class="sc">$</span>AtlasSp_new)</span>
<span id="cb41-33"><a href="#cb41-33" aria-hidden="true" tabindex="-1"></a>unmatched<span class="sc">$</span>AtlasSp_new <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"Poecile varius"</span>, <span class="st">"Sittiparus varius"</span>, unmatched<span class="sc">$</span>AtlasSp_new)</span>
<span id="cb41-34"><a href="#cb41-34" aria-hidden="true" tabindex="-1"></a>unmatched<span class="sc">$</span>AtlasSp_new <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"Sterna albifrons"</span>, <span class="st">"Sternula albifrons"</span>, unmatched<span class="sc">$</span>AtlasSp_new)</span>
<span id="cb41-35"><a href="#cb41-35" aria-hidden="true" tabindex="-1"></a>unmatched<span class="sc">$</span>AtlasSp_new <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"Egretta intermedia"</span>, <span class="st">"Ardea intermedia"</span>, unmatched<span class="sc">$</span>AtlasSp_new)</span>
<span id="cb41-36"><a href="#cb41-36" aria-hidden="true" tabindex="-1"></a>unmatched<span class="sc">$</span>AtlasSp_new <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"Ammodramus maritimus"</span>, <span class="st">"Ammospiza maritima"</span>, unmatched<span class="sc">$</span>AtlasSp_new)</span>
<span id="cb41-37"><a href="#cb41-37" aria-hidden="true" tabindex="-1"></a>unmatched<span class="sc">$</span>AtlasSp_new <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"Falcipennis canadensis"</span>, <span class="st">"Canachites canadensis"</span>, unmatched<span class="sc">$</span>AtlasSp_new)</span>
<span id="cb41-38"><a href="#cb41-38" aria-hidden="true" tabindex="-1"></a>unmatched<span class="sc">$</span>AtlasSp_new <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"Regulus calendula"</span>, <span class="st">"Corthylio calendula"</span>, unmatched<span class="sc">$</span>AtlasSp_new)</span>
<span id="cb41-39"><a href="#cb41-39" aria-hidden="true" tabindex="-1"></a>unmatched<span class="sc">$</span>AtlasSp_new <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"Oporornis formosus"</span>, <span class="st">"Geothlypis formosa"</span>, unmatched<span class="sc">$</span>AtlasSp_new)</span>
<span id="cb41-40"><a href="#cb41-40" aria-hidden="true" tabindex="-1"></a>unmatched<span class="sc">$</span>AtlasSp_new <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"Bonasa bonasia"</span>, <span class="st">"Tetrastes bonasia"</span>, unmatched<span class="sc">$</span>AtlasSp_new)</span>
<span id="cb41-41"><a href="#cb41-41" aria-hidden="true" tabindex="-1"></a>unmatched<span class="sc">$</span>AtlasSp_new <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"Regulus ignicapillus"</span>, <span class="st">"Regulus ignicapilla"</span>, unmatched<span class="sc">$</span>AtlasSp_new)</span>
<span id="cb41-42"><a href="#cb41-42" aria-hidden="true" tabindex="-1"></a>unmatched<span class="sc">$</span>AtlasSp_new <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"Parus caeruleus"</span>, <span class="st">"Cyanistes caeruleus"</span>, unmatched<span class="sc">$</span>AtlasSp_new)</span>
<span id="cb41-43"><a href="#cb41-43" aria-hidden="true" tabindex="-1"></a>unmatched<span class="sc">$</span>AtlasSp_new <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"Miliaria calandra"</span>, <span class="st">"Emberiza calandra"</span>, unmatched<span class="sc">$</span>AtlasSp_new)</span>
<span id="cb41-44"><a href="#cb41-44" aria-hidden="true" tabindex="-1"></a>unmatched<span class="sc">$</span>AtlasSp_new <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"Delichon urbica"</span>, <span class="st">"Delichon urbicum"</span>, unmatched<span class="sc">$</span>AtlasSp_new)</span>
<span id="cb41-45"><a href="#cb41-45" aria-hidden="true" tabindex="-1"></a>unmatched<span class="sc">$</span>AtlasSp_new <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"Oporornis philadelphia"</span>, <span class="st">"Geothlypis philadelphia"</span>, unmatched<span class="sc">$</span>AtlasSp_new)</span>
<span id="cb41-46"><a href="#cb41-46" aria-hidden="true" tabindex="-1"></a>unmatched<span class="sc">$</span>AtlasSp_new <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"Seiurus noveboracensis"</span>, <span class="st">"Parkesia noveboracensis"</span>, unmatched<span class="sc">$</span>AtlasSp_new)</span>
<span id="cb41-47"><a href="#cb41-47" aria-hidden="true" tabindex="-1"></a>unmatched<span class="sc">$</span>AtlasSp_new <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"Coccothraustes vespertinus"</span>, <span class="st">"Hesperiphona vespertina"</span>, unmatched<span class="sc">$</span>AtlasSp_new)</span>
<span id="cb41-48"><a href="#cb41-48" aria-hidden="true" tabindex="-1"></a>unmatched<span class="sc">$</span>AtlasSp_new <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"Hydropogne caspia"</span>, <span class="st">"Hydroprogne caspia"</span>, unmatched<span class="sc">$</span>AtlasSp_new)</span>
<span id="cb41-49"><a href="#cb41-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-50"><a href="#cb41-50" aria-hidden="true" tabindex="-1"></a><span class="do">## Back to Step 1: Direct match:</span></span>
<span id="cb41-51"><a href="#cb41-51" aria-hidden="true" tabindex="-1"></a>unmatched<span class="sc">$</span>ScientificName <span class="ot">&lt;-</span> unmatched<span class="sc">$</span>AtlasSp_new</span>
<span id="cb41-52"><a href="#cb41-52" aria-hidden="true" tabindex="-1"></a>unmatched<span class="sc">$</span>TaxID <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb41-53"><a href="#cb41-53" aria-hidden="true" tabindex="-1"></a>unmatched<span class="sc">$</span>Synonyms <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb41-54"><a href="#cb41-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-55"><a href="#cb41-55" aria-hidden="true" tabindex="-1"></a><span class="fu">setdiff</span>(unmatched<span class="sc">$</span>ScientificName, Tax_red<span class="sc">$</span>AtlasSp) <span class="co"># Matched all but 2 species which are new. Great !</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Picoides dorsalis" "Parus minor"      </code></pre>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>unmatched_merged <span class="ot">&lt;-</span> <span class="fu">left_join</span>(unmatched, Tax_red <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="st">"ScientificName"</span> <span class="ot">=</span> <span class="st">"AtlasSp"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(ScientificName)`</code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>unmatched_merged<span class="sc">$</span>match <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Merge to final table: </span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>Atlas_merged4 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(Atlas_merged3 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(match_type <span class="sc">!=</span> <span class="st">"manually"</span>), unmatched_merged) <span class="sc">%&gt;%</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(AtlasSp) <span class="sc">%&gt;%</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>()</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a> Atlas_merged4 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(match_type <span class="sc">==</span> <span class="st">"manually"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 41 × 8
# Groups:   AtlasSp [41]
   AtlasSp    AtlasID match_type match Synonyms TaxID AtlasSp_new ScientificName
   &lt;chr&gt;        &lt;int&gt; &lt;chr&gt;      &lt;dbl&gt; &lt;chr&gt;    &lt;int&gt; &lt;chr&gt;       &lt;chr&gt;         
 1 Bonasa bo…      33 manually       1 &lt;NA&gt;       263 Tetrastes … Tetrastes bon…
 2 Carduelis…      39 manually       1 Acanthi…  7591 Linaria ca… Linaria canna…
 3 Carduelis…      41 manually       1 Chloris…  7566 Chloris ch… Chloris chlor…
 4 Delichon …      68 manually       1 &lt;NA&gt;     10602 Delichon u… Delichon urbi…
 5 Miliaria …     118 manually       1 Emberiz…  7708 Emberiza c… Emberiza cala…
 6 Parus cae…     134 manually       1 &lt;NA&gt;     10352 Cyanistes … Cyanistes cae…
 7 Regulus i…     166 manually       1 &lt;NA&gt;      9427 Regulus ig… Regulus ignic…
 8 Sylvia co…     183 manually       1 &lt;NA&gt;      6963 Curruca co… Curruca commu…
 9 Sylvia cu…     184 manually       1 Sylvia …  9425 Curruca cu… Curruca curru…
10 Sylvia ni…     185 manually       1 &lt;NA&gt;      6964 Curruca ni… Curruca nisor…
# ℹ 31 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Data Checks: </span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">is.na</span>(Atlas_merged4))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       AtlasSp        AtlasID     match_type          match       Synonyms 
             0              0              0              0            645 
         TaxID    AtlasSp_new ScientificName 
             2              0              0 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">intersect</span>(spData, Atlas_merged4<span class="sc">$</span>AtlasSp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] "Accipiter gentilis"            "Accipiter nisus"              
  [3] "Acrocephalus arundinaceus"     "Acrocephalus palustris"       
  [5] "Acrocephalus schoenobaenus"    "Acrocephalus scirpaceus"      
  [7] "Actitis hypoleucos"            "Aegithalos caudatus"          
  [9] "Aegolius funereus"             "Alauda arvensis"              
 [11] "Alcedo atthis"                 "Anas acuta"                   
 [13] "Anas clypeata"                 "Anas crecca"                  
 [15] "Anas platyrhynchos"            "Anas querquedula"             
 [17] "Anas strepera"                 "Anser anser"                  
 [19] "Anthus campestris"             "Anthus pratensis"             
 [21] "Anthus spinoletta"             "Anthus trivialis"             
 [23] "Apus apus"                     "Aquila pomarina"              
 [25] "Ardea cinerea"                 "Ardea purpurea"               
 [27] "Asio flammeus"                 "Asio otus"                    
 [29] "Athene noctua"                 "Aythya ferina"                
 [31] "Aythya fuligula"               "Aythya nyroca"                
 [33] "Bonasa bonasia"                "Botaurus stellaris"           
 [35] "Bubo bubo"                     "Bucephala clangula"           
 [37] "Buteo buteo"                   "Caprimulgus europaeus"        
 [39] "Carduelis cannabina"           "Carduelis carduelis"          
 [41] "Carduelis chloris"             "Carduelis flammea"            
 [43] "Carduelis spinus"              "Carpodacus erythrinus"        
 [45] "Certhia brachydactyla"         "Certhia familiaris"           
 [47] "Charadrius dubius"             "Charadrius morinellus"        
 [49] "Chlidonias niger"              "Ciconia ciconia"              
 [51] "Ciconia nigra"                 "Cinclus cinclus"              
 [53] "Circus aeruginosus"            "Circus cyaneus"               
 [55] "Circus pygargus"               "Coccothraustes coccothraustes"
 [57] "Columba livia"                 "Columba oenas"                
 [59] "Columba palumbus"              "Corvus corax"                 
 [61] "Corvus corone"                 "Corvus frugilegus"            
 [63] "Corvus monedula"               "Coturnix coturnix"            
 [65] "Crex crex"                     "Cuculus canorus"              
 [67] "Cygnus olor"                   "Delichon urbica"              
 [69] "Dendrocopos leucotos"          "Dendrocopos major"            
 [71] "Dendrocopos medius"            "Dendrocopos minor"            
 [73] "Dendrocopos syriacus"          "Dryocopus martius"            
 [75] "Egretta garzetta"              "Emberiza citrinella"          
 [77] "Emberiza hortulana"            "Emberiza schoeniclus"         
 [79] "Erithacus rubecula"            "Falco cherrug"                
 [81] "Falco peregrinus"              "Falco subbuteo"               
 [83] "Falco tinnunculus"             "Ficedula albicollis"          
 [85] "Ficedula hypoleuca"            "Ficedula parva"               
 [87] "Fringilla coelebs"             "Fulica atra"                  
 [89] "Galerida cristata"             "Gallinago gallinago"          
 [91] "Gallinula chloropus"           "Garrulus glandarius"          
 [93] "Glaucidium passerinum"         "Grus grus"                    
 [95] "Haliaeetus albicilla"          "Himantopus himantopus"        
 [97] "Hippolais icterina"            "Hirundo rustica"              
 [99] "Ixobrychus minutus"            "Jynx torquilla"               
[101] "Lanius collurio"               "Lanius excubitor"             
[103] "Larus cachinnans"              "Larus canus"                  
[105] "Larus melanocephalus"          "Larus ridibundus"             
[107] "Limosa limosa"                 "Locustella fluviatilis"       
[109] "Locustella luscinioides"       "Locustella naevia"            
[111] "Loxia curvirostra"             "Lullula arborea"              
[113] "Luscinia luscinia"             "Luscinia megarhynchos"        
[115] "Luscinia svecica"              "Mergus merganser"             
[117] "Merops apiaster"               "Miliaria calandra"            
[119] "Milvus migrans"                "Milvus milvus"                
[121] "Motacilla alba"                "Motacilla cinerea"            
[123] "Motacilla flava"               "Muscicapa striata"            
[125] "Netta rufina"                  "Nucifraga caryocatactes"      
[127] "Numenius arquata"              "Nycticorax nycticorax"        
[129] "Oenanthe oenanthe"             "Oriolus oriolus"              
[131] "Otus scops"                    "Panurus biarmicus"            
[133] "Parus ater"                    "Parus caeruleus"              
[135] "Parus cristatus"               "Parus major"                  
[137] "Parus montanus"                "Parus palustris"              
[139] "Passer domesticus"             "Passer montanus"              
[141] "Perdix perdix"                 "Pernis apivorus"              
[143] "Phalacrocorax carbo"           "Phasianus colchicus"          
[145] "Phoenicurus ochruros"          "Phoenicurus phoenicurus"      
[147] "Phylloscopus collybita"        "Phylloscopus sibilatrix"      
[149] "Phylloscopus trochiloides"     "Phylloscopus trochilus"       
[151] "Pica pica"                     "Picoides tridactylus"         
[153] "Picus canus"                   "Picus viridis"                
[155] "Platalea leucorodia"           "Podiceps cristatus"           
[157] "Podiceps grisegena"            "Podiceps nigricollis"         
[159] "Porzana parva"                 "Porzana porzana"              
[161] "Prunella collaris"             "Prunella modularis"           
[163] "Pyrrhula pyrrhula"             "Rallus aquaticus"             
[165] "Recurvirostra avosetta"        "Regulus ignicapillus"         
[167] "Regulus regulus"               "Remiz pendulinus"             
[169] "Riparia riparia"               "Saxicola rubetra"             
[171] "Saxicola torquata"             "Scolopax rusticola"           
[173] "Serinus serinus"               "Sitta europaea"               
[175] "Sterna hirundo"                "Streptopelia decaocto"        
[177] "Streptopelia turtur"           "Strix aluco"                  
[179] "Strix uralensis"               "Sturnus vulgaris"             
[181] "Sylvia atricapilla"            "Sylvia borin"                 
[183] "Sylvia communis"               "Sylvia curruca"               
[185] "Sylvia nisoria"                "Tachybaptus ruficollis"       
[187] "Tetrao tetrix"                 "Tetrao urogallus"             
[189] "Tringa ochropus"               "Tringa totanus"               
[191] "Troglodytes troglodytes"       "Turdus iliacus"               
[193] "Turdus merula"                 "Turdus philomelos"            
[195] "Turdus pilaris"                "Turdus torquatus"             
[197] "Turdus viscivorus"             "Tyto alba"                    
[199] "Upupa epops"                   "Vanellus vanellus"            
[201] "Accipiter cooperii"            "Accipiter striatus"           
[203] "Actitis macularius"            "Aegolius acadicus"            
[205] "Agelaius phoeniceus"           "Aix sponsa"                   
[207] "Ammodramus caudacutus"         "Ammodramus henslowii"         
[209] "Ammodramus maritimus"          "Ammodramus savannarum"        
[211] "Anas americana"                "Anas discors"                 
[213] "Anas rubripes"                 "Aquila chrysaetos"            
[215] "Archilochus colubris"          "Ardea alba"                   
[217] "Ardea herodias"                "Aythya affinis"               
[219] "Aythya americana"              "Aythya collaris"              
[221] "Aythya valisineria"            "Baeolophus bicolor"           
[223] "Bartramia longicauda"          "Bombycilla cedrorum"          
[225] "Bonasa umbellus"               "Botaurus lentiginosus"        
[227] "Branta canadensis"             "Bubo virginianus"             
[229] "Bubulcus ibis"                 "Buteo jamaicensis"            
[231] "Buteo lineatus"                "Buteo platypterus"            
[233] "Butorides virescens"           "Caprimulgus carolinensis"     
[235] "Caprimulgus vociferus"         "Cardinalis cardinalis"        
[237] "Carpodacus mexicanus"          "Carpodacus purpureus"         
[239] "Cathartes aura"                "Catharus bicknelli"           
[241] "Catharus fuscescens"           "Catharus guttatus"            
[243] "Catharus ustulatus"            "Certhia americana"            
[245] "Chaetura pelagica"             "Charadrius melodus"           
[247] "Charadrius vociferus"          "Chordeiles minor"             
[249] "Cistothorus palustris"         "Cistothorus platensis"        
[251] "Coccothraustes vespertinus"    "Coccyzus americanus"          
[253] "Coccyzus erythropthalmus"      "Colaptes auratus"             
[255] "Colinus virginianus"           "Contopus cooperi"             
[257] "Contopus virens"               "Corvus brachyrhynchos"        
[259] "Corvus ossifragus"             "Cyanocitta cristata"          
[261] "Dendroica caerulescens"        "Dendroica castanea"           
[263] "Dendroica cerulea"             "Dendroica coronata"           
[265] "Dendroica discolor"            "Dendroica dominica"           
[267] "Dendroica fusca"               "Dendroica magnolia"           
[269] "Dendroica palmarum"            "Dendroica pensylvanica"       
[271] "Dendroica petechia"            "Dendroica pinus"              
[273] "Dendroica striata"             "Dendroica tigrina"            
[275] "Dendroica virens"              "Dolichonyx oryzivorus"        
[277] "Dryocopus pileatus"            "Dumetella carolinensis"       
[279] "Egretta caerulea"              "Egretta thula"                
[281] "Egretta tricolor"              "Empidonax alnorum"            
[283] "Empidonax flaviventris"        "Empidonax minimus"            
[285] "Empidonax traillii"            "Empidonax virescens"          
[287] "Eremophila alpestris"          "Euphagus carolinus"           
[289] "Falcipennis canadensis"        "Falco sparverius"             
[291] "Fulica americana"              "Gallinago delicata"           
[293] "Gavia immer"                   "Gelochelidon nilotica"        
[295] "Geothlypis trichas"            "Haematopus palliatus"         
[297] "Haliaeetus leucocephalus"      "Helmitheros vermivorum"       
[299] "Hydropogne caspia"             "Hylocichla mustelina"         
[301] "Icteria virens"                "Icterus galbula"              
[303] "Icterus spurius"               "Ixobrychus exilis"            
[305] "Junco hyemalis"                "Lanius ludovicianus"          
[307] "Larus argentatus"              "Larus delawarensis"           
[309] "Larus marinus"                 "Laterallus jamaicensis"       
[311] "Leucophaeus atricilla"         "Lophodytes cucullatus"        
[313] "Loxia leucoptera"              "Megaceryle alcyon"            
[315] "Megascops asio"                "Melanerpes carolinus"         
[317] "Melanerpes erythrocephalus"    "Meleagris gallopavo"          
[319] "Melospiza georgiana"           "Melospiza lincolnii"          
[321] "Melospiza melodia"             "Mergus serrator"              
[323] "Mimus polyglottos"             "Mniotilta varia"              
[325] "Molothrus ater"                "Myiarchus crinitus"           
[327] "Myiopsitta monachus"           "Nyctanassa violacea"          
[329] "Oporornis formosus"            "Oporornis philadelphia"       
[331] "Oxyura jamaicensis"            "Pandion haliaetus"            
[333] "Parula americana"              "Passerculus sandwichensis"    
[335] "Passerina caerulea"            "Passerina cyanea"             
[337] "Perisoreus canadensis"         "Petrochelidon pyrrhonota"     
[339] "Phalacrocorax auritus"         "Pheucticus ludovicianus"      
[341] "Picoides arcticus"             "Picoides dorsalis"            
[343] "Picoides pubescens"            "Picoides villosus"            
[345] "Pipilo erythrophthalmus"       "Piranga olivacea"             
[347] "Piranga rubra"                 "Plegadis falcinellus"         
[349] "Podilymbus podiceps"           "Poecile atricapillus"         
[351] "Poecile hudsonicus"            "Polioptila caerulea"          
[353] "Pooecetes gramineus"           "Porzana carolina"             
[355] "Progne subis"                  "Protonotaria citrea"          
[357] "Quiscalus major"               "Quiscalus quiscula"           
[359] "Rallus elegans"                "Rallus limicola"              
[361] "Rallus longirostris"           "Regulus calendula"            
[363] "Regulus satrapa"               "Rynchops niger"               
[365] "Sayornis phoebe"               "Scolopax minor"               
[367] "Seiurus aurocapilla"           "Seiurus motacilla"            
[369] "Seiurus noveboracensis"        "Setophaga ruticilla"          
[371] "Sialia sialis"                 "Sitta canadensis"             
[373] "Sitta carolinensis"            "Sphyrapicus varius"           
[375] "Spinus pinus"                  "Spinus tristis"               
[377] "Spiza americana"               "Spizella pallida"             
[379] "Spizella passerina"            "Spizella pusilla"             
[381] "Stelgidopteryx serripennis"    "Sterna dougallii"             
[383] "Sterna forsteri"               "Sternula antillarum"          
[385] "Strix varia"                   "Sturnella magna"              
[387] "Sturnella neglecta"            "Tachycineta bicolor"          
[389] "Thryothorus ludovicianus"      "Toxostoma rufum"              
[391] "Tringa semipalmata"            "Troglodytes aedon"            
[393] "Turdus migratorius"            "Tyrannus tyrannus"            
[395] "Vermivora chrysoptera"         "Vermivora peregrina"          
[397] "Vermivora pinus"               "Vermivora ruficapilla"        
[399] "Vireo flavifrons"              "Vireo gilvus"                 
[401] "Vireo griseus"                 "Vireo olivaceus"              
[403] "Vireo philadelphicus"          "Vireo solitarius"             
[405] "Wilsonia canadensis"           "Wilsonia citrina"             
[407] "Wilsonia pusilla"              "Zenaida macroura"             
[409] "Zonotrichia albicollis"        "Accipiter gularis"            
[411] "Acrocephalus bistrigiceps"     "Acrocephalus orientalis"      
[413] "Agropsar philippensis"         "Aix galericulata"             
[415] "Amaurornis phoenicurus"        "Anas falcata"                 
[417] "Anas zonorhyncha"              "Anous stolidus"               
[419] "Anthus hodgsoni"               "Apalopteron familiare"        
[421] "Apus nipalensis"               "Apus pacificus"               
[423] "Bambusicola thoracicus"        "Butastur indicus"             
[425] "Butorides striata"             "Calonectris leucomelas"       
[427] "Caprimulgus indicus"           "Cepphus carbo"                
[429] "Cerorhinca monocerata"         "Cettia diphone"               
[431] "Chalcophaps indica"            "Charadrius alexandrinus"      
[433] "Charadrius placidus"           "Chloris sinica"               
[435] "Cinclus pallasii"              "Circus spilonotus"            
[437] "Cisticola juncidis"            "Columba janthina"             
[439] "Corvus macrorhynchos"          "Cuculus micropterus"          
[441] "Cuculus optatus"               "Cuculus poliocephalus"        
[443] "Cyanopica cyanus"              "Cyanoptila cyanomelana"       
[445] "Delichon dasypus"              "Dendrocopos kizuki"           
[447] "Egretta intermedia"            "Egretta sacra"                
[449] "Emberiza cioides"              "Emberiza fucata"              
[451] "Emberiza spodocephala"         "Emberiza sulphurata"          
[453] "Emberiza variabilis"           "Emberiza yessoensis"          
[455] "Eophona personata"             "Eurystomus orientalis"        
[457] "Ficedula narcissina"           "Gallinago hardwickii"         
[459] "Gallirallus okinawae"          "Garrulax canorus"             
[461] "Garrulus lidthi"               "Glareola maldivarum"          
[463] "Gorsachius goisagi"            "Grus japonensis"              
[465] "Halcyon coromanda"             "Hierococcyx hyperythrus"      
[467] "Hirundapus caudacutus"         "Hirundo daurica"              
[469] "Hirundo tahitica"              "Histrionicus histrionicus"    
[471] "Hypsipetes amaurotis"          "Ixobrychus cinnamomeus"       
[473] "Ixobrychus sinensis"           "Lagopus muta"                 
[475] "Lanius bucephalus"             "Lanius cristatus"             
[477] "Lanius tigrinus"               "Larus crassirostris"          
[479] "Larus schistisagus"            "Leiothrix lutea"              
[481] "Locustella fasciolata"         "Locustella lanceolata"        
[483] "Locustella ochotensis"         "Locustella pleskei"           
[485] "Locustella pryeri"             "Lonchura punctulata"          
[487] "Luscinia akahige"              "Luscinia calliope"            
[489] "Luscinia cyane"                "Luscinia komadori"            
[491] "Megaceryle lugubris"           "Monticola solitarius"         
[493] "Motacilla grandis"             "Muscicapa dauurica"           
[495] "Muscicapa sibirica"            "Ninox scutulata"              
[497] "Nisaetus nipalensis"           "Otus elegans"                 
[499] "Otus lempiji"                  "Otus sunia"                   
[501] "Parus minor"                   "Passer rutilans"              
[503] "Pericrocotus divaricatus"      "Periparus ater"               
[505] "Pernis ptilorhynchus"          "Phalacrocorax capillatus"     
[507] "Phalacrocorax pelagicus"       "Phoenicurus auroreus"         
[509] "Phylloscopus borealoides"      "Phylloscopus coronatus"       
[511] "Phylloscopus ijimae"           "Phylloscopus xanthodryas"     
[513] "Picus awokera"                 "Pinicola enucleator"          
[515] "Pitta nympha"                  "Poecile montanus"             
[517] "Poecile palustris"             "Poecile varius"               
[519] "Porzana fusca"                 "Prunella rubida"              
[521] "Pycnonotus sinensis"           "Rallina eurizonoides"         
[523] "Rostratula benghalensis"       "Sapheopipo noguchii"          
[525] "Saxicola torquatus"            "Spilornis cheela"             
[527] "Spodiopsar cineraceus"         "Sterna albifrons"             
[529] "Sterna sumatrana"              "Streptopelia orientalis"      
[531] "Sula leucogaster"              "Syrmaticus soemmerringii"     
[533] "Tarsiger cyanurus"             "Terpsiphone atrocaudata"      
[535] "Tetrastes bonasia"             "Treron formosae"              
[537] "Treron sieboldii"              "Turdus cardis"                
[539] "Turdus celaenops"              "Turdus chrysolaus"            
[541] "Turdus pallidus"               "Turnix suscitator"            
[543] "Uragus sibiricus"              "Urosphena squameiceps"        
[545] "Vanellus cinereus"             "Zoothera dauma"               
[547] "Zoothera sibirica"             "Zosterops japonicus"          
[549] "Acanthis flammea"              "Accipiter brevipes"           
[551] "Acridotheres cristatellus"     "Acrocephalus agricola"        
[553] "Acrocephalus dumetorum"        "Acrocephalus melanopogon"     
[555] "Acrocephalus paludicola"       "Aegypius monachus"            
[557] "Alauda leucoptera"             "Alaudala rufescens"           
[559] "Alca torda"                    "Alectoris barbara"            
[561] "Alectoris chukar"              "Alectoris graeca"             
[563] "Alectoris rufa"                "Alle alle"                    
[565] "Alopochen aegyptiaca"          "Amandava amandava"            
[567] "Anser albifrons"               "Anser brachyrhynchus"         
[569] "Anser erythropus"              "Anser fabalis"                
[571] "Anthropoides virgo"            "Anthus berthelotii"           
[573] "Anthus cervinus"               "Anthus petrosus"              
[575] "Apus caffer"                   "Apus pallidus"                
[577] "Apus unicolor"                 "Aquila adalberti"             
[579] "Aquila fasciata"               "Aquila heliaca"               
[581] "Aquila nipalensis"             "Ardeola ralloides"            
[583] "Arenaria interpres"            "Aythya marila"                
[585] "Bombycilla garrulus"           "Branta bernicla"              
[587] "Branta leucopsis"              "Bubo scandiacus"              
[589] "Bucanetes githagineus"         "Bucanetes mongolicus"         
[591] "Bucephala islandica"           "Bulweria bulwerii"            
[593] "Burhinus oedicnemus"           "Buteo lagopus"                
[595] "Buteo rufinus"                 "Calandrella brachydactyla"    
[597] "Calcarius lapponicus"          "Calidris alba"                
[599] "Calidris alpina"               "Calidris canutus"             
[601] "Calidris falcinellus"          "Calidris maritima"            
[603] "Calidris melanotos"            "Calidris minuta"              
[605] "Calidris pugnax"               "Calidris temminckii"          
[607] "Calliope calliope"             "Callipepla californica"       
[609] "Calonectris borealis"          "Calonectris diomedea"         
[611] "Caprimulgus ruficollis"        "Carduelis citrinella"         
[613] "Carduelis corsicana"           "Carpodacus rubicilla"         
[615] "Catharacta skua"               "Cecropis daurica"             
[617] "Cepphus grylle"                "Cercotrichas galactotes"      
[619] "Cettia cetti"                  "Charadrius asiaticus"         
[621] "Charadrius hiaticula"          "Charadrius leschenaultii"     
[623] "Chersophilus duponti"          "Chlidonias hybrida"           
[625] "Chlidonias leucopterus"        "Chloris chloris"              
[627] "Chrysolophus amherstiae"       "Chrysolophus pictus"          
[629] "Circaetus gallicus"            "Circus macrourus"             
[631] "Clamator glandarius"           "Clanga clanga"                
[633] "Clanga pomarina"               "Clangula hyemalis"            
[635] "Columba trocaz"                "Coracias garrulus"            
[637] "Cuculus saturatus"             "Cyanecula svecica"            
[639] "Cyanistes caeruleus"           "Cyanistes cyanus"             
[641] "Cyanistes teneriffae"          "Cyanopica cooki"              
[643] "Cygnus columbianus"            "Cygnus cygnus"                
[645] "Delichon urbicum"              "Dryobates minor"              
[647] "Elanus caeruleus"              "Emberiza aureola"             
[649] "Emberiza bruniceps"            "Emberiza caesia"              
[651] "Emberiza calandra"             "Emberiza cia"                 
[653] "Emberiza cineracea"            "Emberiza cirlus"              
[655] "Emberiza melanocephala"        "Emberiza pallasi"             
[657] "Emberiza pusilla"              "Emberiza rustica"             
[659] "Estrilda astrild"              "Estrilda melpoda"             
[661] "Eudromias morinellus"          "Falco biarmicus"              
[663] "Falco columbarius"             "Falco eleonorae"              
[665] "Falco naumanni"                "Falco rusticolus"             
[667] "Falco vespertinus"             "Ficedula semitorquata"        
[669] "Francolinus francolinus"       "Fratercula arctica"           
[671] "Fringilla montifringilla"      "Fulica cristata"              
[673] "Fulmarus glacialis"            "Galerida theklae"             
[675] "Gallinago media"               "Gallinago stenura"            
[677] "Gavia arctica"                 "Gavia stellata"               
[679] "Glareola nordmanni"            "Glareola pratincola"          
[681] "Gulosus aristotelis"           "Gypaetus barbatus"            
[683] "Gyps fulvus"                   "Haematopus ostralegus"        
[685] "Hieraaetus pennatus"           "Hippolais olivetorum"         
[687] "Hippolais polyglotta"          "Hydrobates castro"            
[689] "Hydrobates leucorhous"         "Hydrobates pelagicus"         
[691] "Hydrocoloeus minutus"          "Hydroprogne caspia"           
[693] "Iduna caligata"                "Iduna opaca"                  
[695] "Iduna pallida"                 "Lagopus lagopus"              
[697] "Lanius meridionalis"           "Lanius minor"                 
[699] "Lanius nubicus"                "Lanius senator"               
[701] "Larus armenicus"               "Larus audouinii"              
[703] "Larus fuscus"                  "Larus genei"                  
[705] "Larus hyperboreus"             "Larus ichthyaetus"            
[707] "Larus michahellis"             "Leiopicus medius"             
[709] "Limosa lapponica"              "Linaria cannabina"            
[711] "Linaria flavirostris"          "Lophophanes cristatus"        
[713] "Loxia pytyopsittacus"          "Loxia scotica"                
[715] "Lymnocryptes minimus"          "Lyrurus mlokosiewiczi"        
[717] "Lyrurus tetrix"                "Mareca penelope"              
[719] "Mareca strepera"               "Marmaronetta angustirostris"  
[721] "Melanitta fusca"               "Melanitta nigra"              
[723] "Melanocorypha calandra"        "Mergellus albellus"           
[725] "Merops persicus"               "Microcarbo pygmaeus"          
[727] "Monticola saxatilis"           "Montifringilla nivalis"       
[729] "Morus bassanus"                "Motacilla citreola"           
[731] "Neophron percnopterus"         "Numenius phaeopus"            
[733] "Oenanthe deserti"              "Oenanthe finschii"            
[735] "Oenanthe hispanica"            "Oenanthe isabellina"          
[737] "Oenanthe leucura"              "Oenanthe pleschanka"          
[739] "Onychoprion fuscatus"          "Otis tarda"                   
[741] "Oxyura leucocephala"           "Pagophila eburnea"            
[743] "Passer hispaniolensis"         "Passer italiae"               
[745] "Pastor roseus"                 "Pelagodroma marina"           
[747] "Pelecanus crispus"             "Pelecanus onocrotalus"        
[749] "Perisoreus infaustus"          "Petronia petronia"            
[751] "Phalaropus fulicarius"         "Phalaropus lobatus"           
[753] "Phoenicopterus roseus"         "Phylloscopus bonelli"         
[755] "Phylloscopus borealis"         "Phylloscopus ibericus"        
[757] "Phylloscopus inornatus"        "Phylloscopus nitidus"         
[759] "Phylloscopus orientalis"       "Phylloscopus sindianus"       
[761] "Picus sharpei"                 "Plectrophenax nivalis"        
[763] "Pluvialis apricaria"           "Pluvialis squatarola"         
[765] "Podiceps auritus"              "Poecile cinctus"              
[767] "Poecile lugubris"              "Polysticta stelleri"          
[769] "Porphyrio porphyrio"           "Prunella atrogularis"         
[771] "Prunella montanella"           "Psittacula krameri"           
[773] "Pterocles alchata"             "Pterocles orientalis"         
[775] "Pterodroma deserta"            "Pterodroma madeira"           
[777] "Ptyonoprogne rupestris"        "Puffinus lherminieri"         
[779] "Puffinus mauretanicus"         "Puffinus puffinus"            
[781] "Puffinus yelkouan"             "Pyrrhocorax graculus"         
[783] "Pyrrhocorax pyrrhocorax"       "Pyrrhula murina"              
[785] "Regulus ignicapilla"           "Regulus madeirensis"          
[787] "Rissa tridactyla"              "Serinus canaria"              
[789] "Serinus pusillus"              "Sitta krueperi"               
[791] "Sitta neumayer"                "Sitta whiteheadi"             
[793] "Somateria mollissima"          "Somateria spectabilis"        
[795] "Spatula clypeata"              "Spatula querquedula"          
[797] "Spilopelia senegalensis"       "Spinus spinus"                
[799] "Stercorarius longicaudus"      "Stercorarius parasiticus"     
[801] "Stercorarius pomarinus"        "Sterna paradisaea"            
[803] "Sternula albifrons"            "Strix nebulosa"               
[805] "Sturnus unicolor"              "Surnia ulula"                 
[807] "Sylvia balearica"              "Sylvia cantillans"            
[809] "Sylvia conspicillata"          "Sylvia crassirostris"         
[811] "Sylvia hortensis"              "Sylvia melanocephala"         
[813] "Sylvia mystacea"               "Sylvia ruppeli"               
[815] "Sylvia sarda"                  "Sylvia subalpina"             
[817] "Sylvia undata"                 "Syrmaticus reevesii"          
[819] "Tachymarptis melba"            "Tadorna ferruginea"           
[821] "Tadorna tadorna"               "Tetraogallus caspius"         
[823] "Tetraogallus caucasicus"       "Tetrax tetrax"                
[825] "Thalasseus sandvicensis"       "Tichodroma muraria"           
[827] "Tringa erythropus"             "Tringa glareola"              
[829] "Tringa nebularia"              "Tringa stagnatilis"           
[831] "Turdus atrogularis"            "Uria aalge"                   
[833] "Uria lomvia"                   "Vanellus gregarius"           
[835] "Vanellus leucurus"             "Vanellus spinosus"            
[837] "Xema sabini"                   "Xenus cinereus"               
[839] "Zapornia parva"                "Zapornia pusilla"             
[841] "Zoothera aurea"               </code></pre>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(Atlas_merged4<span class="sc">$</span>ScientificName)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] "Accipiter gentilis"            "Accipiter nisus"              
  [3] "Acrocephalus arundinaceus"     "Acrocephalus palustris"       
  [5] "Acrocephalus schoenobaenus"    "Acrocephalus scirpaceus"      
  [7] "Actitis hypoleucos"            "Aegithalos caudatus"          
  [9] "Aegolius funereus"             "Alauda arvensis"              
 [11] "Alcedo atthis"                 "Anas acuta"                   
 [13] "Anas crecca"                   "Anas platyrhynchos"           
 [15] "Anser anser"                   "Anthus campestris"            
 [17] "Anthus pratensis"              "Anthus spinoletta"            
 [19] "Anthus trivialis"              "Apus apus"                    
 [21] "Ardea cinerea"                 "Ardea purpurea"               
 [23] "Asio flammeus"                 "Asio otus"                    
 [25] "Athene noctua"                 "Aythya ferina"                
 [27] "Aythya fuligula"               "Aythya nyroca"                
 [29] "Botaurus stellaris"            "Bubo bubo"                    
 [31] "Bucephala clangula"            "Buteo buteo"                  
 [33] "Caprimulgus europaeus"         "Carduelis carduelis"          
 [35] "Carpodacus erythrinus"         "Certhia brachydactyla"        
 [37] "Certhia familiaris"            "Charadrius dubius"            
 [39] "Chlidonias niger"              "Ciconia ciconia"              
 [41] "Ciconia nigra"                 "Cinclus cinclus"              
 [43] "Circus aeruginosus"            "Circus cyaneus"               
 [45] "Circus pygargus"               "Coccothraustes coccothraustes"
 [47] "Columba livia"                 "Columba oenas"                
 [49] "Columba palumbus"              "Corvus corax"                 
 [51] "Corvus corone"                 "Corvus frugilegus"            
 [53] "Corvus monedula"               "Coturnix coturnix"            
 [55] "Crex crex"                     "Cuculus canorus"              
 [57] "Cygnus olor"                   "Dendrocopos leucotos"         
 [59] "Dendrocopos major"             "Dendrocopos syriacus"         
 [61] "Dryocopus martius"             "Egretta garzetta"             
 [63] "Emberiza citrinella"           "Emberiza hortulana"           
 [65] "Emberiza schoeniclus"          "Erithacus rubecula"           
 [67] "Falco cherrug"                 "Falco peregrinus"             
 [69] "Falco subbuteo"                "Falco tinnunculus"            
 [71] "Ficedula albicollis"           "Ficedula hypoleuca"           
 [73] "Ficedula parva"                "Fringilla coelebs"            
 [75] "Fulica atra"                   "Galerida cristata"            
 [77] "Gallinago gallinago"           "Gallinula chloropus"          
 [79] "Garrulus glandarius"           "Glaucidium passerinum"        
 [81] "Grus grus"                     "Haliaeetus albicilla"         
 [83] "Himantopus himantopus"         "Hippolais icterina"           
 [85] "Hirundo rustica"               "Ixobrychus minutus"           
 [87] "Jynx torquilla"                "Lanius collurio"              
 [89] "Lanius excubitor"              "Larus cachinnans"             
 [91] "Larus canus"                   "Larus melanocephalus"         
 [93] "Larus ridibundus"              "Limosa limosa"                
 [95] "Locustella fluviatilis"        "Locustella luscinioides"      
 [97] "Locustella naevia"             "Loxia curvirostra"            
 [99] "Lullula arborea"               "Luscinia luscinia"            
[101] "Luscinia megarhynchos"         "Luscinia svecica"             
[103] "Mergus merganser"              "Merops apiaster"              
[105] "Milvus migrans"                "Milvus milvus"                
[107] "Motacilla alba"                "Motacilla cinerea"            
[109] "Motacilla flava"               "Muscicapa striata"            
[111] "Netta rufina"                  "Nucifraga caryocatactes"      
[113] "Numenius arquata"              "Nycticorax nycticorax"        
[115] "Oenanthe oenanthe"             "Oriolus oriolus"              
[117] "Otus scops"                    "Panurus biarmicus"            
[119] "Parus major"                   "Passer domesticus"            
[121] "Passer montanus"               "Perdix perdix"                
[123] "Pernis apivorus"               "Phalacrocorax carbo"          
[125] "Phasianus colchicus"           "Phoenicurus ochruros"         
[127] "Phoenicurus phoenicurus"       "Phylloscopus collybita"       
[129] "Phylloscopus sibilatrix"       "Phylloscopus trochiloides"    
[131] "Phylloscopus trochilus"        "Pica pica"                    
[133] "Picoides tridactylus"          "Picus canus"                  
[135] "Picus viridis"                 "Platalea leucorodia"          
[137] "Podiceps cristatus"            "Podiceps grisegena"           
[139] "Podiceps nigricollis"          "Porzana porzana"              
[141] "Prunella collaris"             "Prunella modularis"           
[143] "Pyrrhula pyrrhula"             "Rallus aquaticus"             
[145] "Recurvirostra avosetta"        "Regulus regulus"              
[147] "Remiz pendulinus"              "Riparia riparia"              
[149] "Saxicola rubetra"              "Scolopax rusticola"           
[151] "Serinus serinus"               "Sitta europaea"               
[153] "Sterna hirundo"                "Streptopelia decaocto"        
[155] "Streptopelia turtur"           "Strix aluco"                  
[157] "Strix uralensis"               "Sturnus vulgaris"             
[159] "Sylvia atricapilla"            "Sylvia borin"                 
[161] "Tachybaptus ruficollis"        "Tetrao urogallus"             
[163] "Tringa ochropus"               "Tringa totanus"               
[165] "Troglodytes troglodytes"       "Turdus iliacus"               
[167] "Turdus merula"                 "Turdus philomelos"            
[169] "Turdus pilaris"                "Turdus torquatus"             
[171] "Turdus viscivorus"             "Tyto alba"                    
[173] "Upupa epops"                   "Vanellus vanellus"            
[175] "Accipiter cooperii"            "Accipiter striatus"           
[177] "Actitis macularius"            "Aegolius acadicus"            
[179] "Agelaius phoeniceus"           "Aix sponsa"                   
[181] "Ammodramus savannarum"         "Anas rubripes"                
[183] "Aquila chrysaetos"             "Archilochus colubris"         
[185] "Ardea alba"                    "Ardea herodias"               
[187] "Aythya affinis"                "Aythya americana"             
[189] "Aythya collaris"               "Aythya valisineria"           
[191] "Baeolophus bicolor"            "Bartramia longicauda"         
[193] "Bombycilla cedrorum"           "Bonasa umbellus"              
[195] "Botaurus lentiginosus"         "Branta canadensis"            
[197] "Bubo virginianus"              "Bubulcus ibis"                
[199] "Buteo jamaicensis"             "Buteo lineatus"               
[201] "Buteo platypterus"             "Cardinalis cardinalis"        
[203] "Cathartes aura"                "Catharus bicknelli"           
[205] "Catharus fuscescens"           "Catharus guttatus"            
[207] "Catharus ustulatus"            "Certhia americana"            
[209] "Chaetura pelagica"             "Charadrius melodus"           
[211] "Charadrius vociferus"          "Chordeiles minor"             
[213] "Cistothorus palustris"         "Cistothorus platensis"        
[215] "Coccyzus americanus"           "Coccyzus erythropthalmus"     
[217] "Colaptes auratus"              "Colinus virginianus"          
[219] "Contopus cooperi"              "Contopus virens"              
[221] "Corvus brachyrhynchos"         "Corvus ossifragus"            
[223] "Cyanocitta cristata"           "Dolichonyx oryzivorus"        
[225] "Dumetella carolinensis"        "Egretta caerulea"             
[227] "Egretta thula"                 "Egretta tricolor"             
[229] "Empidonax alnorum"             "Empidonax flaviventris"       
[231] "Empidonax minimus"             "Empidonax traillii"           
[233] "Empidonax virescens"           "Eremophila alpestris"         
[235] "Euphagus carolinus"            "Falco sparverius"             
[237] "Fulica americana"              "Gallinago delicata"           
[239] "Gavia immer"                   "Gelochelidon nilotica"        
[241] "Geothlypis trichas"            "Haematopus palliatus"         
[243] "Haliaeetus leucocephalus"      "Helmitheros vermivorum"       
[245] "Hylocichla mustelina"          "Icteria virens"               
[247] "Icterus galbula"               "Icterus spurius"              
[249] "Ixobrychus exilis"             "Junco hyemalis"               
[251] "Lanius ludovicianus"           "Larus argentatus"             
[253] "Larus delawarensis"            "Larus marinus"                
[255] "Laterallus jamaicensis"        "Lophodytes cucullatus"        
[257] "Loxia leucoptera"              "Megaceryle alcyon"            
[259] "Megascops asio"                "Melanerpes carolinus"         
[261] "Melanerpes erythrocephalus"    "Meleagris gallopavo"          
[263] "Melospiza georgiana"           "Melospiza lincolnii"          
[265] "Melospiza melodia"             "Mergus serrator"              
[267] "Mimus polyglottos"             "Mniotilta varia"              
[269] "Molothrus ater"                "Myiarchus crinitus"           
[271] "Myiopsitta monachus"           "Nyctanassa violacea"          
[273] "Oxyura jamaicensis"            "Pandion haliaetus"            
[275] "Passerculus sandwichensis"     "Passerina caerulea"           
[277] "Passerina cyanea"              "Perisoreus canadensis"        
[279] "Petrochelidon pyrrhonota"      "Pheucticus ludovicianus"      
[281] "Picoides arcticus"             "Pipilo erythrophthalmus"      
[283] "Piranga olivacea"              "Piranga rubra"                
[285] "Plegadis falcinellus"          "Podilymbus podiceps"          
[287] "Poecile atricapillus"          "Poecile hudsonicus"           
[289] "Polioptila caerulea"           "Pooecetes gramineus"          
[291] "Porzana carolina"              "Progne subis"                 
[293] "Protonotaria citrea"           "Quiscalus major"              
[295] "Quiscalus quiscula"            "Rallus elegans"               
[297] "Rallus limicola"               "Rallus longirostris"          
[299] "Regulus satrapa"               "Rynchops niger"               
[301] "Sayornis phoebe"               "Scolopax minor"               
[303] "Seiurus aurocapilla"           "Setophaga ruticilla"          
[305] "Sialia sialis"                 "Sitta canadensis"             
[307] "Sitta carolinensis"            "Sphyrapicus varius"           
[309] "Spinus pinus"                  "Spinus tristis"               
[311] "Spiza americana"               "Spizella pallida"             
[313] "Spizella passerina"            "Spizella pusilla"             
[315] "Stelgidopteryx serripennis"    "Sterna dougallii"             
[317] "Sterna forsteri"               "Sternula antillarum"          
[319] "Strix varia"                   "Sturnella magna"              
[321] "Sturnella neglecta"            "Tachycineta bicolor"          
[323] "Thryothorus ludovicianus"      "Toxostoma rufum"              
[325] "Tringa semipalmata"            "Troglodytes aedon"            
[327] "Turdus migratorius"            "Tyrannus tyrannus"            
[329] "Vermivora chrysoptera"         "Vireo flavifrons"             
[331] "Vireo gilvus"                  "Vireo griseus"                
[333] "Vireo olivaceus"               "Vireo philadelphicus"         
[335] "Vireo solitarius"              "Zenaida macroura"             
[337] "Zonotrichia albicollis"        "Accipiter gularis"            
[339] "Acrocephalus bistrigiceps"     "Acrocephalus orientalis"      
[341] "Agropsar philippensis"         "Aix galericulata"             
[343] "Amaurornis phoenicurus"        "Anas zonorhyncha"             
[345] "Anous stolidus"                "Anthus hodgsoni"              
[347] "Apalopteron familiare"         "Apus nipalensis"              
[349] "Apus pacificus"                "Bambusicola thoracicus"       
[351] "Butastur indicus"              "Butorides striata"            
[353] "Calonectris leucomelas"        "Caprimulgus indicus"          
[355] "Cepphus carbo"                 "Cerorhinca monocerata"        
[357] "Chalcophaps indica"            "Charadrius alexandrinus"      
[359] "Charadrius placidus"           "Chloris sinica"               
[361] "Cinclus pallasii"              "Circus spilonotus"            
[363] "Cisticola juncidis"            "Columba janthina"             
[365] "Corvus macrorhynchos"          "Cuculus micropterus"          
[367] "Cuculus optatus"               "Cuculus poliocephalus"        
[369] "Cyanopica cyanus"              "Cyanoptila cyanomelana"       
[371] "Delichon dasypus"              "Egretta sacra"                
[373] "Emberiza cioides"              "Emberiza fucata"              
[375] "Emberiza spodocephala"         "Emberiza sulphurata"          
[377] "Emberiza variabilis"           "Emberiza yessoensis"          
[379] "Eophona personata"             "Eurystomus orientalis"        
[381] "Ficedula narcissina"           "Gallinago hardwickii"         
[383] "Garrulax canorus"              "Garrulus lidthi"              
[385] "Glareola maldivarum"           "Gorsachius goisagi"           
[387] "Grus japonensis"               "Halcyon coromanda"            
[389] "Hierococcyx hyperythrus"       "Hirundapus caudacutus"        
[391] "Hirundo tahitica"              "Histrionicus histrionicus"    
[393] "Hypsipetes amaurotis"          "Ixobrychus cinnamomeus"       
[395] "Ixobrychus sinensis"           "Lagopus muta"                 
[397] "Lanius bucephalus"             "Lanius cristatus"             
[399] "Lanius tigrinus"               "Larus crassirostris"          
[401] "Larus schistisagus"            "Leiothrix lutea"              
[403] "Locustella lanceolata"         "Lonchura punctulata"          
[405] "Megaceryle lugubris"           "Monticola solitarius"         
[407] "Motacilla grandis"             "Muscicapa dauurica"           
[409] "Muscicapa sibirica"            "Ninox scutulata"              
[411] "Nisaetus nipalensis"           "Otus elegans"                 
[413] "Otus lempiji"                  "Otus sunia"                   
[415] "Pericrocotus divaricatus"      "Periparus ater"               
[417] "Pernis ptilorhynchus"          "Phalacrocorax capillatus"     
[419] "Phoenicurus auroreus"          "Phylloscopus borealoides"     
[421] "Phylloscopus coronatus"        "Phylloscopus ijimae"          
[423] "Phylloscopus xanthodryas"      "Picus awokera"                
[425] "Pinicola enucleator"           "Pitta nympha"                 
[427] "Poecile montanus"              "Poecile palustris"            
[429] "Prunella rubida"               "Pycnonotus sinensis"          
[431] "Rallina eurizonoides"          "Rostratula benghalensis"      
[433] "Saxicola torquatus"            "Spilornis cheela"             
[435] "Spodiopsar cineraceus"         "Sterna sumatrana"             
[437] "Streptopelia orientalis"       "Sula leucogaster"             
[439] "Syrmaticus soemmerringii"      "Tarsiger cyanurus"            
[441] "Terpsiphone atrocaudata"       "Tetrastes bonasia"            
[443] "Treron formosae"               "Treron sieboldii"             
[445] "Turdus cardis"                 "Turdus celaenops"             
[447] "Turdus chrysolaus"             "Turdus pallidus"              
[449] "Turnix suscitator"             "Urosphena squameiceps"        
[451] "Vanellus cinereus"             "Zoothera dauma"               
[453] "Zosterops japonicus"           "Acanthis flammea"             
[455] "Accipiter brevipes"            "Acridotheres cristatellus"    
[457] "Acrocephalus agricola"         "Acrocephalus dumetorum"       
[459] "Acrocephalus melanopogon"      "Acrocephalus paludicola"      
[461] "Aegypius monachus"             "Alauda leucoptera"            
[463] "Alaudala rufescens"            "Alca torda"                   
[465] "Alectoris barbara"             "Alectoris chukar"             
[467] "Alectoris graeca"              "Alectoris rufa"               
[469] "Alle alle"                     "Alopochen aegyptiaca"         
[471] "Amandava amandava"             "Anser albifrons"              
[473] "Anser brachyrhynchus"          "Anser erythropus"             
[475] "Anser fabalis"                 "Anthropoides virgo"           
[477] "Anthus berthelotii"            "Anthus cervinus"              
[479] "Anthus petrosus"               "Apus caffer"                  
[481] "Apus pallidus"                 "Apus unicolor"                
[483] "Aquila adalberti"              "Aquila fasciata"              
[485] "Aquila heliaca"                "Aquila nipalensis"            
[487] "Ardeola ralloides"             "Arenaria interpres"           
[489] "Aythya marila"                 "Bombycilla garrulus"          
[491] "Branta bernicla"               "Branta leucopsis"             
[493] "Bubo scandiacus"               "Bucanetes githagineus"        
[495] "Bucanetes mongolicus"          "Bucephala islandica"          
[497] "Bulweria bulwerii"             "Burhinus oedicnemus"          
[499] "Buteo lagopus"                 "Buteo rufinus"                
[501] "Calandrella brachydactyla"     "Calcarius lapponicus"         
[503] "Calidris alba"                 "Calidris alpina"              
[505] "Calidris canutus"              "Calidris falcinellus"         
[507] "Calidris maritima"             "Calidris melanotos"           
[509] "Calidris minuta"               "Calidris pugnax"              
[511] "Calidris temminckii"           "Calliope calliope"            
[513] "Callipepla californica"        "Calonectris borealis"         
[515] "Calonectris diomedea"          "Caprimulgus ruficollis"       
[517] "Carduelis citrinella"          "Carduelis corsicana"          
[519] "Carpodacus rubicilla"          "Catharacta skua"              
[521] "Cecropis daurica"              "Cepphus grylle"               
[523] "Cercotrichas galactotes"       "Cettia cetti"                 
[525] "Charadrius asiaticus"          "Charadrius hiaticula"         
[527] "Charadrius leschenaultii"      "Chersophilus duponti"         
[529] "Chlidonias hybrida"            "Chlidonias leucopterus"       
[531] "Chloris chloris"               "Chrysolophus amherstiae"      
[533] "Chrysolophus pictus"           "Circaetus gallicus"           
[535] "Circus macrourus"              "Clamator glandarius"          
[537] "Clanga clanga"                 "Clanga pomarina"              
[539] "Clangula hyemalis"             "Columba trocaz"               
[541] "Coracias garrulus"             "Cuculus saturatus"            
[543] "Cyanistes caeruleus"           "Cyanistes cyanus"             
[545] "Cyanistes teneriffae"          "Cyanopica cooki"              
[547] "Cygnus columbianus"            "Cygnus cygnus"                
[549] "Delichon urbicum"              "Dryobates minor"              
[551] "Elanus caeruleus"              "Emberiza aureola"             
[553] "Emberiza bruniceps"            "Emberiza caesia"              
[555] "Emberiza calandra"             "Emberiza cia"                 
[557] "Emberiza cineracea"            "Emberiza cirlus"              
[559] "Emberiza melanocephala"        "Emberiza pallasi"             
[561] "Emberiza pusilla"              "Emberiza rustica"             
[563] "Estrilda astrild"              "Estrilda melpoda"             
[565] "Eudromias morinellus"          "Falco biarmicus"              
[567] "Falco columbarius"             "Falco eleonorae"              
[569] "Falco naumanni"                "Falco rusticolus"             
[571] "Falco vespertinus"             "Ficedula semitorquata"        
[573] "Francolinus francolinus"       "Fratercula arctica"           
[575] "Fringilla montifringilla"      "Fulica cristata"              
[577] "Fulmarus glacialis"            "Galerida theklae"             
[579] "Gallinago media"               "Gallinago stenura"            
[581] "Gavia arctica"                 "Gavia stellata"               
[583] "Glareola nordmanni"            "Glareola pratincola"          
[585] "Gulosus aristotelis"           "Gypaetus barbatus"            
[587] "Gyps fulvus"                   "Haematopus ostralegus"        
[589] "Hieraaetus pennatus"           "Hippolais olivetorum"         
[591] "Hippolais polyglotta"          "Hydrobates castro"            
[593] "Hydrobates leucorhous"         "Hydrobates pelagicus"         
[595] "Hydrocoloeus minutus"          "Hydroprogne caspia"           
[597] "Iduna caligata"                "Iduna opaca"                  
[599] "Iduna pallida"                 "Lagopus lagopus"              
[601] "Lanius meridionalis"           "Lanius minor"                 
[603] "Lanius nubicus"                "Lanius senator"               
[605] "Larus armenicus"               "Larus audouinii"              
[607] "Larus fuscus"                  "Larus genei"                  
[609] "Larus hyperboreus"             "Larus ichthyaetus"            
[611] "Larus michahellis"             "Leiopicus medius"             
[613] "Limosa lapponica"              "Linaria cannabina"            
[615] "Linaria flavirostris"          "Lophophanes cristatus"        
[617] "Loxia pytyopsittacus"          "Loxia scotica"                
[619] "Lymnocryptes minimus"          "Lyrurus mlokosiewiczi"        
[621] "Lyrurus tetrix"                "Mareca penelope"              
[623] "Mareca strepera"               "Marmaronetta angustirostris"  
[625] "Melanitta fusca"               "Melanitta nigra"              
[627] "Melanocorypha calandra"        "Mergellus albellus"           
[629] "Merops persicus"               "Microcarbo pygmaeus"          
[631] "Monticola saxatilis"           "Montifringilla nivalis"       
[633] "Morus bassanus"                "Motacilla citreola"           
[635] "Neophron percnopterus"         "Numenius phaeopus"            
[637] "Oenanthe deserti"              "Oenanthe finschii"            
[639] "Oenanthe hispanica"            "Oenanthe isabellina"          
[641] "Oenanthe leucura"              "Oenanthe pleschanka"          
[643] "Onychoprion fuscatus"          "Otis tarda"                   
[645] "Oxyura leucocephala"           "Pagophila eburnea"            
[647] "Passer hispaniolensis"         "Passer italiae"               
[649] "Pastor roseus"                 "Pelagodroma marina"           
[651] "Pelecanus crispus"             "Pelecanus onocrotalus"        
[653] "Perisoreus infaustus"          "Petronia petronia"            
[655] "Phalaropus fulicarius"         "Phalaropus lobatus"           
[657] "Phoenicopterus roseus"         "Phylloscopus bonelli"         
[659] "Phylloscopus borealis"         "Phylloscopus ibericus"        
[661] "Phylloscopus inornatus"        "Phylloscopus nitidus"         
[663] "Phylloscopus orientalis"       "Phylloscopus sindianus"       
[665] "Picus sharpei"                 "Plectrophenax nivalis"        
[667] "Pluvialis apricaria"           "Pluvialis squatarola"         
[669] "Podiceps auritus"              "Poecile cinctus"              
[671] "Poecile lugubris"              "Polysticta stelleri"          
[673] "Porphyrio porphyrio"           "Prunella atrogularis"         
[675] "Prunella montanella"           "Pterocles alchata"            
[677] "Pterocles orientalis"          "Pterodroma deserta"           
[679] "Pterodroma madeira"            "Ptyonoprogne rupestris"       
[681] "Puffinus lherminieri"          "Puffinus mauretanicus"        
[683] "Puffinus puffinus"             "Puffinus yelkouan"            
[685] "Pyrrhocorax graculus"          "Pyrrhocorax pyrrhocorax"      
[687] "Pyrrhula murina"               "Regulus ignicapilla"          
[689] "Regulus madeirensis"           "Rissa tridactyla"             
[691] "Serinus canaria"               "Serinus pusillus"             
[693] "Sitta krueperi"                "Sitta neumayer"               
[695] "Sitta whiteheadi"              "Somateria mollissima"         
[697] "Somateria spectabilis"         "Spatula clypeata"             
[699] "Spatula querquedula"           "Spilopelia senegalensis"      
[701] "Spinus spinus"                 "Stercorarius longicaudus"     
[703] "Stercorarius parasiticus"      "Stercorarius pomarinus"       
[705] "Sterna paradisaea"             "Sternula albifrons"           
[707] "Strix nebulosa"                "Sturnus unicolor"             
[709] "Surnia ulula"                  "Syrmaticus reevesii"          
[711] "Tachymarptis melba"            "Tadorna ferruginea"           
[713] "Tadorna tadorna"               "Tetraogallus caspius"         
[715] "Tetraogallus caucasicus"       "Tetrax tetrax"                
[717] "Thalasseus sandvicensis"       "Tichodroma muraria"           
[719] "Tringa erythropus"             "Tringa glareola"              
[721] "Tringa nebularia"              "Tringa stagnatilis"           
[723] "Turdus atrogularis"            "Uria aalge"                   
[725] "Uria lomvia"                   "Vanellus gregarius"           
[727] "Vanellus leucurus"             "Vanellus spinosus"            
[729] "Xema sabini"                   "Xenus cinereus"               
[731] "Zapornia parva"                "Zapornia pusilla"             
[733] "Zoothera aurea"                "Ammospiza caudacuta"          
[735] "Passerculus henslowii"         "Mareca americana"             
[737] "Spatula discors"               "Antrostomus carolinensis"     
[739] "Antrostomus vociferus"         "Haemorhous mexicanus"         
[741] "Haemorhous purpureus"          "Setophaga caerulescens"       
[743] "Setophaga castanea"            "Setophaga cerulea"            
[745] "Setophaga coronata"            "Setophaga discolor"           
[747] "Setophaga dominica"            "Setophaga fusca"              
[749] "Setophaga magnolia"            "Setophaga palmarum"           
[751] "Setophaga pensylvanica"        "Setophaga petechia"           
[753] "Setophaga pinus"               "Setophaga striata"            
[755] "Setophaga tigrina"             "Setophaga virens"             
[757] "Hylatomus pileatus"            "Larus atricilla"              
[759] "Setophaga americana"           "Nannopterum auritus"          
[761] "Dryobates pubescens"           "Leuconotopicus villosus"      
[763] "Parkesia noveboracensis"       "Parkesia motacilla"           
[765] "Leiothlypis peregrina"         "Vermivora cyanoptera"         
[767] "Leiothlypis ruficapilla"       "Cardellina canadensis"        
[769] "Setophaga citrina"             "Cardellina pusilla"           
[771] "Mareca falcata"                "Horornis diphone"             
[773] "Picoides kizuki"               "Helopsaltes fasciolatus"      
[775] "Helopsaltes ochotensis"        "Helopsaltes pleskei"          
[777] "Larvivora cyane"               "Urile pelagicus"              
[779] "Zapornia fusca"                "Dendrocopos noguchii"         
[781] "Carpodacus sibiricus"          "Geokichla sibirica"           
[783] "Alexandrinus krameri"          "Curruca communis"             
[785] "Curruca curruca"               "Curruca nisoria"              
[787] "Ammospiza maritima"            "Hesperiphona vespertina"      
[789] "Canachites canadensis"         "Geothlypis formosa"           
[791] "Geothlypis philadelphia"       "Picoides dorsalis"            
[793] "Corthylio calendula"           "Ardea intermedia"             
[795] "Hypotaenidia okinawae"         "Helopsaltes pryeri"           
[797] "Larvivora akahige"             "Larvivora komadori"           
[799] "Parus minor"                   "Passer cinnamomeus"           
[801] "Sittiparus varius"             "Curruca balearica"            
[803] "Curruca cantillans"            "Curruca conspicillata"        
[805] "Curruca crassirostris"         "Curruca hortensis"            
[807] "Curruca melanocephala"         "Curruca mystacea"             
[809] "Curruca ruppeli"               "Curruca sarda"                
[811] "Curruca subalpina"             "Curruca undata"               </code></pre>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">intersect</span>(Atlas_merged4<span class="sc">$</span>ScientificName, Tax_red<span class="sc">$</span>AtlasSp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] "Accipiter gentilis"            "Accipiter nisus"              
  [3] "Acrocephalus arundinaceus"     "Acrocephalus palustris"       
  [5] "Acrocephalus schoenobaenus"    "Acrocephalus scirpaceus"      
  [7] "Actitis hypoleucos"            "Aegithalos caudatus"          
  [9] "Aegolius funereus"             "Alauda arvensis"              
 [11] "Alcedo atthis"                 "Anas acuta"                   
 [13] "Anas crecca"                   "Anas platyrhynchos"           
 [15] "Anser anser"                   "Anthus campestris"            
 [17] "Anthus pratensis"              "Anthus spinoletta"            
 [19] "Anthus trivialis"              "Apus apus"                    
 [21] "Ardea cinerea"                 "Ardea purpurea"               
 [23] "Asio flammeus"                 "Asio otus"                    
 [25] "Athene noctua"                 "Aythya ferina"                
 [27] "Aythya fuligula"               "Aythya nyroca"                
 [29] "Botaurus stellaris"            "Bubo bubo"                    
 [31] "Bucephala clangula"            "Buteo buteo"                  
 [33] "Caprimulgus europaeus"         "Carduelis carduelis"          
 [35] "Carpodacus erythrinus"         "Certhia brachydactyla"        
 [37] "Certhia familiaris"            "Charadrius dubius"            
 [39] "Chlidonias niger"              "Ciconia ciconia"              
 [41] "Ciconia nigra"                 "Cinclus cinclus"              
 [43] "Circus aeruginosus"            "Circus cyaneus"               
 [45] "Circus pygargus"               "Coccothraustes coccothraustes"
 [47] "Columba livia"                 "Columba oenas"                
 [49] "Columba palumbus"              "Corvus corax"                 
 [51] "Corvus corone"                 "Corvus frugilegus"            
 [53] "Corvus monedula"               "Coturnix coturnix"            
 [55] "Crex crex"                     "Cuculus canorus"              
 [57] "Cygnus olor"                   "Dendrocopos leucotos"         
 [59] "Dendrocopos major"             "Dendrocopos syriacus"         
 [61] "Dryocopus martius"             "Egretta garzetta"             
 [63] "Emberiza citrinella"           "Emberiza hortulana"           
 [65] "Emberiza schoeniclus"          "Erithacus rubecula"           
 [67] "Falco cherrug"                 "Falco peregrinus"             
 [69] "Falco subbuteo"                "Falco tinnunculus"            
 [71] "Ficedula albicollis"           "Ficedula hypoleuca"           
 [73] "Ficedula parva"                "Fringilla coelebs"            
 [75] "Fulica atra"                   "Galerida cristata"            
 [77] "Gallinago gallinago"           "Gallinula chloropus"          
 [79] "Garrulus glandarius"           "Glaucidium passerinum"        
 [81] "Grus grus"                     "Haliaeetus albicilla"         
 [83] "Himantopus himantopus"         "Hippolais icterina"           
 [85] "Hirundo rustica"               "Ixobrychus minutus"           
 [87] "Jynx torquilla"                "Lanius collurio"              
 [89] "Lanius excubitor"              "Larus cachinnans"             
 [91] "Larus canus"                   "Larus melanocephalus"         
 [93] "Larus ridibundus"              "Limosa limosa"                
 [95] "Locustella fluviatilis"        "Locustella luscinioides"      
 [97] "Locustella naevia"             "Loxia curvirostra"            
 [99] "Lullula arborea"               "Luscinia luscinia"            
[101] "Luscinia megarhynchos"         "Luscinia svecica"             
[103] "Mergus merganser"              "Merops apiaster"              
[105] "Milvus migrans"                "Milvus milvus"                
[107] "Motacilla alba"                "Motacilla cinerea"            
[109] "Motacilla flava"               "Muscicapa striata"            
[111] "Netta rufina"                  "Nucifraga caryocatactes"      
[113] "Numenius arquata"              "Nycticorax nycticorax"        
[115] "Oenanthe oenanthe"             "Oriolus oriolus"              
[117] "Otus scops"                    "Panurus biarmicus"            
[119] "Parus major"                   "Passer domesticus"            
[121] "Passer montanus"               "Perdix perdix"                
[123] "Pernis apivorus"               "Phalacrocorax carbo"          
[125] "Phasianus colchicus"           "Phoenicurus ochruros"         
[127] "Phoenicurus phoenicurus"       "Phylloscopus collybita"       
[129] "Phylloscopus sibilatrix"       "Phylloscopus trochiloides"    
[131] "Phylloscopus trochilus"        "Pica pica"                    
[133] "Picoides tridactylus"          "Picus canus"                  
[135] "Picus viridis"                 "Platalea leucorodia"          
[137] "Podiceps cristatus"            "Podiceps grisegena"           
[139] "Podiceps nigricollis"          "Porzana porzana"              
[141] "Prunella collaris"             "Prunella modularis"           
[143] "Pyrrhula pyrrhula"             "Rallus aquaticus"             
[145] "Recurvirostra avosetta"        "Regulus regulus"              
[147] "Remiz pendulinus"              "Riparia riparia"              
[149] "Saxicola rubetra"              "Scolopax rusticola"           
[151] "Serinus serinus"               "Sitta europaea"               
[153] "Sterna hirundo"                "Streptopelia decaocto"        
[155] "Streptopelia turtur"           "Strix aluco"                  
[157] "Strix uralensis"               "Sturnus vulgaris"             
[159] "Sylvia atricapilla"            "Sylvia borin"                 
[161] "Tachybaptus ruficollis"        "Tetrao urogallus"             
[163] "Tringa ochropus"               "Tringa totanus"               
[165] "Troglodytes troglodytes"       "Turdus iliacus"               
[167] "Turdus merula"                 "Turdus philomelos"            
[169] "Turdus pilaris"                "Turdus torquatus"             
[171] "Turdus viscivorus"             "Tyto alba"                    
[173] "Upupa epops"                   "Vanellus vanellus"            
[175] "Accipiter cooperii"            "Accipiter striatus"           
[177] "Actitis macularius"            "Aegolius acadicus"            
[179] "Agelaius phoeniceus"           "Aix sponsa"                   
[181] "Ammodramus savannarum"         "Anas rubripes"                
[183] "Aquila chrysaetos"             "Archilochus colubris"         
[185] "Ardea alba"                    "Ardea herodias"               
[187] "Aythya affinis"                "Aythya americana"             
[189] "Aythya collaris"               "Aythya valisineria"           
[191] "Baeolophus bicolor"            "Bartramia longicauda"         
[193] "Bombycilla cedrorum"           "Bonasa umbellus"              
[195] "Botaurus lentiginosus"         "Branta canadensis"            
[197] "Bubo virginianus"              "Bubulcus ibis"                
[199] "Buteo jamaicensis"             "Buteo lineatus"               
[201] "Buteo platypterus"             "Cardinalis cardinalis"        
[203] "Cathartes aura"                "Catharus bicknelli"           
[205] "Catharus fuscescens"           "Catharus guttatus"            
[207] "Catharus ustulatus"            "Certhia americana"            
[209] "Chaetura pelagica"             "Charadrius melodus"           
[211] "Charadrius vociferus"          "Chordeiles minor"             
[213] "Cistothorus palustris"         "Cistothorus platensis"        
[215] "Coccyzus americanus"           "Coccyzus erythropthalmus"     
[217] "Colaptes auratus"              "Colinus virginianus"          
[219] "Contopus cooperi"              "Contopus virens"              
[221] "Corvus brachyrhynchos"         "Corvus ossifragus"            
[223] "Cyanocitta cristata"           "Dolichonyx oryzivorus"        
[225] "Dumetella carolinensis"        "Egretta caerulea"             
[227] "Egretta thula"                 "Egretta tricolor"             
[229] "Empidonax alnorum"             "Empidonax flaviventris"       
[231] "Empidonax minimus"             "Empidonax traillii"           
[233] "Empidonax virescens"           "Eremophila alpestris"         
[235] "Euphagus carolinus"            "Falco sparverius"             
[237] "Fulica americana"              "Gallinago delicata"           
[239] "Gavia immer"                   "Gelochelidon nilotica"        
[241] "Geothlypis trichas"            "Haematopus palliatus"         
[243] "Haliaeetus leucocephalus"      "Helmitheros vermivorum"       
[245] "Hylocichla mustelina"          "Icteria virens"               
[247] "Icterus galbula"               "Icterus spurius"              
[249] "Ixobrychus exilis"             "Junco hyemalis"               
[251] "Lanius ludovicianus"           "Larus argentatus"             
[253] "Larus delawarensis"            "Larus marinus"                
[255] "Laterallus jamaicensis"        "Lophodytes cucullatus"        
[257] "Loxia leucoptera"              "Megaceryle alcyon"            
[259] "Megascops asio"                "Melanerpes carolinus"         
[261] "Melanerpes erythrocephalus"    "Meleagris gallopavo"          
[263] "Melospiza georgiana"           "Melospiza lincolnii"          
[265] "Melospiza melodia"             "Mergus serrator"              
[267] "Mimus polyglottos"             "Mniotilta varia"              
[269] "Molothrus ater"                "Myiarchus crinitus"           
[271] "Myiopsitta monachus"           "Nyctanassa violacea"          
[273] "Oxyura jamaicensis"            "Pandion haliaetus"            
[275] "Passerculus sandwichensis"     "Passerina caerulea"           
[277] "Passerina cyanea"              "Perisoreus canadensis"        
[279] "Petrochelidon pyrrhonota"      "Pheucticus ludovicianus"      
[281] "Picoides arcticus"             "Pipilo erythrophthalmus"      
[283] "Piranga olivacea"              "Piranga rubra"                
[285] "Plegadis falcinellus"          "Podilymbus podiceps"          
[287] "Poecile atricapillus"          "Poecile hudsonicus"           
[289] "Polioptila caerulea"           "Pooecetes gramineus"          
[291] "Porzana carolina"              "Progne subis"                 
[293] "Protonotaria citrea"           "Quiscalus major"              
[295] "Quiscalus quiscula"            "Rallus elegans"               
[297] "Rallus limicola"               "Rallus longirostris"          
[299] "Regulus satrapa"               "Rynchops niger"               
[301] "Sayornis phoebe"               "Scolopax minor"               
[303] "Seiurus aurocapilla"           "Setophaga ruticilla"          
[305] "Sialia sialis"                 "Sitta canadensis"             
[307] "Sitta carolinensis"            "Sphyrapicus varius"           
[309] "Spinus pinus"                  "Spinus tristis"               
[311] "Spiza americana"               "Spizella pallida"             
[313] "Spizella passerina"            "Spizella pusilla"             
[315] "Stelgidopteryx serripennis"    "Sterna dougallii"             
[317] "Sterna forsteri"               "Sternula antillarum"          
[319] "Strix varia"                   "Sturnella magna"              
[321] "Sturnella neglecta"            "Tachycineta bicolor"          
[323] "Thryothorus ludovicianus"      "Toxostoma rufum"              
[325] "Tringa semipalmata"            "Troglodytes aedon"            
[327] "Turdus migratorius"            "Tyrannus tyrannus"            
[329] "Vermivora chrysoptera"         "Vireo flavifrons"             
[331] "Vireo gilvus"                  "Vireo griseus"                
[333] "Vireo olivaceus"               "Vireo philadelphicus"         
[335] "Vireo solitarius"              "Zenaida macroura"             
[337] "Zonotrichia albicollis"        "Accipiter gularis"            
[339] "Acrocephalus bistrigiceps"     "Acrocephalus orientalis"      
[341] "Agropsar philippensis"         "Aix galericulata"             
[343] "Amaurornis phoenicurus"        "Anas zonorhyncha"             
[345] "Anous stolidus"                "Anthus hodgsoni"              
[347] "Apalopteron familiare"         "Apus nipalensis"              
[349] "Apus pacificus"                "Bambusicola thoracicus"       
[351] "Butastur indicus"              "Butorides striata"            
[353] "Calonectris leucomelas"        "Caprimulgus indicus"          
[355] "Cepphus carbo"                 "Cerorhinca monocerata"        
[357] "Chalcophaps indica"            "Charadrius alexandrinus"      
[359] "Charadrius placidus"           "Chloris sinica"               
[361] "Cinclus pallasii"              "Circus spilonotus"            
[363] "Cisticola juncidis"            "Columba janthina"             
[365] "Corvus macrorhynchos"          "Cuculus micropterus"          
[367] "Cuculus optatus"               "Cuculus poliocephalus"        
[369] "Cyanopica cyanus"              "Cyanoptila cyanomelana"       
[371] "Delichon dasypus"              "Egretta sacra"                
[373] "Emberiza cioides"              "Emberiza fucata"              
[375] "Emberiza spodocephala"         "Emberiza sulphurata"          
[377] "Emberiza variabilis"           "Emberiza yessoensis"          
[379] "Eophona personata"             "Eurystomus orientalis"        
[381] "Ficedula narcissina"           "Gallinago hardwickii"         
[383] "Garrulax canorus"              "Garrulus lidthi"              
[385] "Glareola maldivarum"           "Gorsachius goisagi"           
[387] "Grus japonensis"               "Halcyon coromanda"            
[389] "Hierococcyx hyperythrus"       "Hirundapus caudacutus"        
[391] "Hirundo tahitica"              "Histrionicus histrionicus"    
[393] "Hypsipetes amaurotis"          "Ixobrychus cinnamomeus"       
[395] "Ixobrychus sinensis"           "Lagopus muta"                 
[397] "Lanius bucephalus"             "Lanius cristatus"             
[399] "Lanius tigrinus"               "Larus crassirostris"          
[401] "Larus schistisagus"            "Leiothrix lutea"              
[403] "Locustella lanceolata"         "Lonchura punctulata"          
[405] "Megaceryle lugubris"           "Monticola solitarius"         
[407] "Motacilla grandis"             "Muscicapa dauurica"           
[409] "Muscicapa sibirica"            "Ninox scutulata"              
[411] "Nisaetus nipalensis"           "Otus elegans"                 
[413] "Otus lempiji"                  "Otus sunia"                   
[415] "Pericrocotus divaricatus"      "Periparus ater"               
[417] "Pernis ptilorhynchus"          "Phalacrocorax capillatus"     
[419] "Phoenicurus auroreus"          "Phylloscopus borealoides"     
[421] "Phylloscopus coronatus"        "Phylloscopus ijimae"          
[423] "Phylloscopus xanthodryas"      "Picus awokera"                
[425] "Pinicola enucleator"           "Pitta nympha"                 
[427] "Poecile montanus"              "Poecile palustris"            
[429] "Prunella rubida"               "Pycnonotus sinensis"          
[431] "Rallina eurizonoides"          "Rostratula benghalensis"      
[433] "Saxicola torquatus"            "Spilornis cheela"             
[435] "Spodiopsar cineraceus"         "Sterna sumatrana"             
[437] "Streptopelia orientalis"       "Sula leucogaster"             
[439] "Syrmaticus soemmerringii"      "Tarsiger cyanurus"            
[441] "Terpsiphone atrocaudata"       "Tetrastes bonasia"            
[443] "Treron formosae"               "Treron sieboldii"             
[445] "Turdus cardis"                 "Turdus celaenops"             
[447] "Turdus chrysolaus"             "Turdus pallidus"              
[449] "Turnix suscitator"             "Urosphena squameiceps"        
[451] "Vanellus cinereus"             "Zoothera dauma"               
[453] "Zosterops japonicus"           "Acanthis flammea"             
[455] "Accipiter brevipes"            "Acridotheres cristatellus"    
[457] "Acrocephalus agricola"         "Acrocephalus dumetorum"       
[459] "Acrocephalus melanopogon"      "Acrocephalus paludicola"      
[461] "Aegypius monachus"             "Alauda leucoptera"            
[463] "Alaudala rufescens"            "Alca torda"                   
[465] "Alectoris barbara"             "Alectoris chukar"             
[467] "Alectoris graeca"              "Alectoris rufa"               
[469] "Alle alle"                     "Alopochen aegyptiaca"         
[471] "Amandava amandava"             "Anser albifrons"              
[473] "Anser brachyrhynchus"          "Anser erythropus"             
[475] "Anser fabalis"                 "Anthropoides virgo"           
[477] "Anthus berthelotii"            "Anthus cervinus"              
[479] "Anthus petrosus"               "Apus caffer"                  
[481] "Apus pallidus"                 "Apus unicolor"                
[483] "Aquila adalberti"              "Aquila fasciata"              
[485] "Aquila heliaca"                "Aquila nipalensis"            
[487] "Ardeola ralloides"             "Arenaria interpres"           
[489] "Aythya marila"                 "Bombycilla garrulus"          
[491] "Branta bernicla"               "Branta leucopsis"             
[493] "Bubo scandiacus"               "Bucanetes githagineus"        
[495] "Bucanetes mongolicus"          "Bucephala islandica"          
[497] "Bulweria bulwerii"             "Burhinus oedicnemus"          
[499] "Buteo lagopus"                 "Buteo rufinus"                
[501] "Calandrella brachydactyla"     "Calcarius lapponicus"         
[503] "Calidris alba"                 "Calidris alpina"              
[505] "Calidris canutus"              "Calidris falcinellus"         
[507] "Calidris maritima"             "Calidris melanotos"           
[509] "Calidris minuta"               "Calidris pugnax"              
[511] "Calidris temminckii"           "Calliope calliope"            
[513] "Callipepla californica"        "Calonectris borealis"         
[515] "Calonectris diomedea"          "Caprimulgus ruficollis"       
[517] "Carduelis citrinella"          "Carduelis corsicana"          
[519] "Carpodacus rubicilla"          "Catharacta skua"              
[521] "Cecropis daurica"              "Cepphus grylle"               
[523] "Cercotrichas galactotes"       "Cettia cetti"                 
[525] "Charadrius asiaticus"          "Charadrius hiaticula"         
[527] "Charadrius leschenaultii"      "Chersophilus duponti"         
[529] "Chlidonias hybrida"            "Chlidonias leucopterus"       
[531] "Chloris chloris"               "Chrysolophus amherstiae"      
[533] "Chrysolophus pictus"           "Circaetus gallicus"           
[535] "Circus macrourus"              "Clamator glandarius"          
[537] "Clanga clanga"                 "Clanga pomarina"              
[539] "Clangula hyemalis"             "Columba trocaz"               
[541] "Coracias garrulus"             "Cuculus saturatus"            
[543] "Cyanistes caeruleus"           "Cyanistes cyanus"             
[545] "Cyanistes teneriffae"          "Cyanopica cooki"              
[547] "Cygnus columbianus"            "Cygnus cygnus"                
[549] "Delichon urbicum"              "Dryobates minor"              
[551] "Elanus caeruleus"              "Emberiza aureola"             
[553] "Emberiza bruniceps"            "Emberiza caesia"              
[555] "Emberiza calandra"             "Emberiza cia"                 
[557] "Emberiza cineracea"            "Emberiza cirlus"              
[559] "Emberiza melanocephala"        "Emberiza pallasi"             
[561] "Emberiza pusilla"              "Emberiza rustica"             
[563] "Estrilda astrild"              "Estrilda melpoda"             
[565] "Eudromias morinellus"          "Falco biarmicus"              
[567] "Falco columbarius"             "Falco eleonorae"              
[569] "Falco naumanni"                "Falco rusticolus"             
[571] "Falco vespertinus"             "Ficedula semitorquata"        
[573] "Francolinus francolinus"       "Fratercula arctica"           
[575] "Fringilla montifringilla"      "Fulica cristata"              
[577] "Fulmarus glacialis"            "Galerida theklae"             
[579] "Gallinago media"               "Gallinago stenura"            
[581] "Gavia arctica"                 "Gavia stellata"               
[583] "Glareola nordmanni"            "Glareola pratincola"          
[585] "Gulosus aristotelis"           "Gypaetus barbatus"            
[587] "Gyps fulvus"                   "Haematopus ostralegus"        
[589] "Hieraaetus pennatus"           "Hippolais olivetorum"         
[591] "Hippolais polyglotta"          "Hydrobates castro"            
[593] "Hydrobates leucorhous"         "Hydrobates pelagicus"         
[595] "Hydrocoloeus minutus"          "Hydroprogne caspia"           
[597] "Iduna caligata"                "Iduna opaca"                  
[599] "Iduna pallida"                 "Lagopus lagopus"              
[601] "Lanius meridionalis"           "Lanius minor"                 
[603] "Lanius nubicus"                "Lanius senator"               
[605] "Larus armenicus"               "Larus audouinii"              
[607] "Larus fuscus"                  "Larus genei"                  
[609] "Larus hyperboreus"             "Larus ichthyaetus"            
[611] "Larus michahellis"             "Leiopicus medius"             
[613] "Limosa lapponica"              "Linaria cannabina"            
[615] "Linaria flavirostris"          "Lophophanes cristatus"        
[617] "Loxia pytyopsittacus"          "Loxia scotica"                
[619] "Lymnocryptes minimus"          "Lyrurus mlokosiewiczi"        
[621] "Lyrurus tetrix"                "Mareca penelope"              
[623] "Mareca strepera"               "Marmaronetta angustirostris"  
[625] "Melanitta fusca"               "Melanitta nigra"              
[627] "Melanocorypha calandra"        "Mergellus albellus"           
[629] "Merops persicus"               "Microcarbo pygmaeus"          
[631] "Monticola saxatilis"           "Montifringilla nivalis"       
[633] "Morus bassanus"                "Motacilla citreola"           
[635] "Neophron percnopterus"         "Numenius phaeopus"            
[637] "Oenanthe deserti"              "Oenanthe finschii"            
[639] "Oenanthe hispanica"            "Oenanthe isabellina"          
[641] "Oenanthe leucura"              "Oenanthe pleschanka"          
[643] "Onychoprion fuscatus"          "Otis tarda"                   
[645] "Oxyura leucocephala"           "Pagophila eburnea"            
[647] "Passer hispaniolensis"         "Passer italiae"               
[649] "Pastor roseus"                 "Pelagodroma marina"           
[651] "Pelecanus crispus"             "Pelecanus onocrotalus"        
[653] "Perisoreus infaustus"          "Petronia petronia"            
[655] "Phalaropus fulicarius"         "Phalaropus lobatus"           
[657] "Phoenicopterus roseus"         "Phylloscopus bonelli"         
[659] "Phylloscopus borealis"         "Phylloscopus ibericus"        
[661] "Phylloscopus inornatus"        "Phylloscopus nitidus"         
[663] "Phylloscopus orientalis"       "Phylloscopus sindianus"       
[665] "Picus sharpei"                 "Plectrophenax nivalis"        
[667] "Pluvialis apricaria"           "Pluvialis squatarola"         
[669] "Podiceps auritus"              "Poecile cinctus"              
[671] "Poecile lugubris"              "Polysticta stelleri"          
[673] "Porphyrio porphyrio"           "Prunella atrogularis"         
[675] "Prunella montanella"           "Pterocles alchata"            
[677] "Pterocles orientalis"          "Pterodroma deserta"           
[679] "Pterodroma madeira"            "Ptyonoprogne rupestris"       
[681] "Puffinus lherminieri"          "Puffinus mauretanicus"        
[683] "Puffinus puffinus"             "Puffinus yelkouan"            
[685] "Pyrrhocorax graculus"          "Pyrrhocorax pyrrhocorax"      
[687] "Pyrrhula murina"               "Regulus ignicapilla"          
[689] "Regulus madeirensis"           "Rissa tridactyla"             
[691] "Serinus canaria"               "Serinus pusillus"             
[693] "Sitta krueperi"                "Sitta neumayer"               
[695] "Sitta whiteheadi"              "Somateria mollissima"         
[697] "Somateria spectabilis"         "Spatula clypeata"             
[699] "Spatula querquedula"           "Spilopelia senegalensis"      
[701] "Spinus spinus"                 "Stercorarius longicaudus"     
[703] "Stercorarius parasiticus"      "Stercorarius pomarinus"       
[705] "Sterna paradisaea"             "Sternula albifrons"           
[707] "Strix nebulosa"                "Sturnus unicolor"             
[709] "Surnia ulula"                  "Syrmaticus reevesii"          
[711] "Tachymarptis melba"            "Tadorna ferruginea"           
[713] "Tadorna tadorna"               "Tetraogallus caspius"         
[715] "Tetraogallus caucasicus"       "Tetrax tetrax"                
[717] "Thalasseus sandvicensis"       "Tichodroma muraria"           
[719] "Tringa erythropus"             "Tringa glareola"              
[721] "Tringa nebularia"              "Tringa stagnatilis"           
[723] "Turdus atrogularis"            "Uria aalge"                   
[725] "Uria lomvia"                   "Vanellus gregarius"           
[727] "Vanellus leucurus"             "Vanellus spinosus"            
[729] "Xema sabini"                   "Xenus cinereus"               
[731] "Zapornia parva"                "Zapornia pusilla"             
[733] "Zoothera aurea"                "Ammospiza caudacuta"          
[735] "Passerculus henslowii"         "Mareca americana"             
[737] "Spatula discors"               "Antrostomus carolinensis"     
[739] "Antrostomus vociferus"         "Haemorhous mexicanus"         
[741] "Haemorhous purpureus"          "Setophaga caerulescens"       
[743] "Setophaga castanea"            "Setophaga cerulea"            
[745] "Setophaga coronata"            "Setophaga discolor"           
[747] "Setophaga dominica"            "Setophaga fusca"              
[749] "Setophaga magnolia"            "Setophaga palmarum"           
[751] "Setophaga pensylvanica"        "Setophaga petechia"           
[753] "Setophaga pinus"               "Setophaga striata"            
[755] "Setophaga tigrina"             "Setophaga virens"             
[757] "Hylatomus pileatus"            "Larus atricilla"              
[759] "Setophaga americana"           "Nannopterum auritus"          
[761] "Dryobates pubescens"           "Leuconotopicus villosus"      
[763] "Parkesia noveboracensis"       "Parkesia motacilla"           
[765] "Leiothlypis peregrina"         "Vermivora cyanoptera"         
[767] "Leiothlypis ruficapilla"       "Cardellina canadensis"        
[769] "Setophaga citrina"             "Cardellina pusilla"           
[771] "Mareca falcata"                "Horornis diphone"             
[773] "Picoides kizuki"               "Helopsaltes fasciolatus"      
[775] "Helopsaltes ochotensis"        "Helopsaltes pleskei"          
[777] "Larvivora cyane"               "Urile pelagicus"              
[779] "Zapornia fusca"                "Dendrocopos noguchii"         
[781] "Carpodacus sibiricus"          "Geokichla sibirica"           
[783] "Alexandrinus krameri"          "Curruca communis"             
[785] "Curruca curruca"               "Curruca nisoria"              
[787] "Ammospiza maritima"            "Hesperiphona vespertina"      
[789] "Canachites canadensis"         "Geothlypis formosa"           
[791] "Geothlypis philadelphia"       "Corthylio calendula"          
[793] "Ardea intermedia"              "Hypotaenidia okinawae"        
[795] "Helopsaltes pryeri"            "Larvivora akahige"            
[797] "Larvivora komadori"            "Passer cinnamomeus"           
[799] "Sittiparus varius"             "Curruca balearica"            
[801] "Curruca cantillans"            "Curruca conspicillata"        
[803] "Curruca crassirostris"         "Curruca hortensis"            
[805] "Curruca melanocephala"         "Curruca mystacea"             
[807] "Curruca ruppeli"               "Curruca sarda"                
[809] "Curruca subalpina"             "Curruca undata"               </code></pre>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>dups <span class="ot">&lt;-</span> Atlas_merged4<span class="sc">$</span>ScientificName[<span class="fu">duplicated</span>(Atlas_merged4<span class="sc">$</span>ScientificName)] <span class="co"># 30 duplicates</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>name_vector <span class="ot">&lt;-</span> Atlas_merged4 <span class="sc">%&gt;%</span> <span class="fu">pull</span>(ScientificName)</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>Tax_LookUp <span class="ot">&lt;-</span> Atlas_merged4 <span class="sc">%&gt;%</span> <span class="fu">distinct</span>(AtlasSp, ScientificName)</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(Tax_LookUp<span class="sc">$</span>ScientificName)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] "Accipiter gentilis"            "Accipiter nisus"              
  [3] "Acrocephalus arundinaceus"     "Acrocephalus palustris"       
  [5] "Acrocephalus schoenobaenus"    "Acrocephalus scirpaceus"      
  [7] "Actitis hypoleucos"            "Aegithalos caudatus"          
  [9] "Aegolius funereus"             "Alauda arvensis"              
 [11] "Alcedo atthis"                 "Anas acuta"                   
 [13] "Anas crecca"                   "Anas platyrhynchos"           
 [15] "Anser anser"                   "Anthus campestris"            
 [17] "Anthus pratensis"              "Anthus spinoletta"            
 [19] "Anthus trivialis"              "Apus apus"                    
 [21] "Ardea cinerea"                 "Ardea purpurea"               
 [23] "Asio flammeus"                 "Asio otus"                    
 [25] "Athene noctua"                 "Aythya ferina"                
 [27] "Aythya fuligula"               "Aythya nyroca"                
 [29] "Botaurus stellaris"            "Bubo bubo"                    
 [31] "Bucephala clangula"            "Buteo buteo"                  
 [33] "Caprimulgus europaeus"         "Carduelis carduelis"          
 [35] "Carpodacus erythrinus"         "Certhia brachydactyla"        
 [37] "Certhia familiaris"            "Charadrius dubius"            
 [39] "Chlidonias niger"              "Ciconia ciconia"              
 [41] "Ciconia nigra"                 "Cinclus cinclus"              
 [43] "Circus aeruginosus"            "Circus cyaneus"               
 [45] "Circus pygargus"               "Coccothraustes coccothraustes"
 [47] "Columba livia"                 "Columba oenas"                
 [49] "Columba palumbus"              "Corvus corax"                 
 [51] "Corvus corone"                 "Corvus frugilegus"            
 [53] "Corvus monedula"               "Coturnix coturnix"            
 [55] "Crex crex"                     "Cuculus canorus"              
 [57] "Cygnus olor"                   "Dendrocopos leucotos"         
 [59] "Dendrocopos major"             "Dendrocopos syriacus"         
 [61] "Dryocopus martius"             "Egretta garzetta"             
 [63] "Emberiza citrinella"           "Emberiza hortulana"           
 [65] "Emberiza schoeniclus"          "Erithacus rubecula"           
 [67] "Falco cherrug"                 "Falco peregrinus"             
 [69] "Falco subbuteo"                "Falco tinnunculus"            
 [71] "Ficedula albicollis"           "Ficedula hypoleuca"           
 [73] "Ficedula parva"                "Fringilla coelebs"            
 [75] "Fulica atra"                   "Galerida cristata"            
 [77] "Gallinago gallinago"           "Gallinula chloropus"          
 [79] "Garrulus glandarius"           "Glaucidium passerinum"        
 [81] "Grus grus"                     "Haliaeetus albicilla"         
 [83] "Himantopus himantopus"         "Hippolais icterina"           
 [85] "Hirundo rustica"               "Ixobrychus minutus"           
 [87] "Jynx torquilla"                "Lanius collurio"              
 [89] "Lanius excubitor"              "Larus cachinnans"             
 [91] "Larus canus"                   "Larus melanocephalus"         
 [93] "Larus ridibundus"              "Limosa limosa"                
 [95] "Locustella fluviatilis"        "Locustella luscinioides"      
 [97] "Locustella naevia"             "Loxia curvirostra"            
 [99] "Lullula arborea"               "Luscinia luscinia"            
[101] "Luscinia megarhynchos"         "Luscinia svecica"             
[103] "Mergus merganser"              "Merops apiaster"              
[105] "Milvus migrans"                "Milvus milvus"                
[107] "Motacilla alba"                "Motacilla cinerea"            
[109] "Motacilla flava"               "Muscicapa striata"            
[111] "Netta rufina"                  "Nucifraga caryocatactes"      
[113] "Numenius arquata"              "Nycticorax nycticorax"        
[115] "Oenanthe oenanthe"             "Oriolus oriolus"              
[117] "Otus scops"                    "Panurus biarmicus"            
[119] "Parus major"                   "Passer domesticus"            
[121] "Passer montanus"               "Perdix perdix"                
[123] "Pernis apivorus"               "Phalacrocorax carbo"          
[125] "Phasianus colchicus"           "Phoenicurus ochruros"         
[127] "Phoenicurus phoenicurus"       "Phylloscopus collybita"       
[129] "Phylloscopus sibilatrix"       "Phylloscopus trochiloides"    
[131] "Phylloscopus trochilus"        "Pica pica"                    
[133] "Picoides tridactylus"          "Picus canus"                  
[135] "Picus viridis"                 "Platalea leucorodia"          
[137] "Podiceps cristatus"            "Podiceps grisegena"           
[139] "Podiceps nigricollis"          "Porzana porzana"              
[141] "Prunella collaris"             "Prunella modularis"           
[143] "Pyrrhula pyrrhula"             "Rallus aquaticus"             
[145] "Recurvirostra avosetta"        "Regulus regulus"              
[147] "Remiz pendulinus"              "Riparia riparia"              
[149] "Saxicola rubetra"              "Scolopax rusticola"           
[151] "Serinus serinus"               "Sitta europaea"               
[153] "Sterna hirundo"                "Streptopelia decaocto"        
[155] "Streptopelia turtur"           "Strix aluco"                  
[157] "Strix uralensis"               "Sturnus vulgaris"             
[159] "Sylvia atricapilla"            "Sylvia borin"                 
[161] "Tachybaptus ruficollis"        "Tetrao urogallus"             
[163] "Tringa ochropus"               "Tringa totanus"               
[165] "Troglodytes troglodytes"       "Turdus iliacus"               
[167] "Turdus merula"                 "Turdus philomelos"            
[169] "Turdus pilaris"                "Turdus torquatus"             
[171] "Turdus viscivorus"             "Tyto alba"                    
[173] "Upupa epops"                   "Vanellus vanellus"            
[175] "Accipiter cooperii"            "Accipiter striatus"           
[177] "Actitis macularius"            "Aegolius acadicus"            
[179] "Agelaius phoeniceus"           "Aix sponsa"                   
[181] "Ammodramus savannarum"         "Anas rubripes"                
[183] "Aquila chrysaetos"             "Archilochus colubris"         
[185] "Ardea alba"                    "Ardea herodias"               
[187] "Aythya affinis"                "Aythya americana"             
[189] "Aythya collaris"               "Aythya valisineria"           
[191] "Baeolophus bicolor"            "Bartramia longicauda"         
[193] "Bombycilla cedrorum"           "Bonasa umbellus"              
[195] "Botaurus lentiginosus"         "Branta canadensis"            
[197] "Bubo virginianus"              "Bubulcus ibis"                
[199] "Buteo jamaicensis"             "Buteo lineatus"               
[201] "Buteo platypterus"             "Cardinalis cardinalis"        
[203] "Cathartes aura"                "Catharus bicknelli"           
[205] "Catharus fuscescens"           "Catharus guttatus"            
[207] "Catharus ustulatus"            "Certhia americana"            
[209] "Chaetura pelagica"             "Charadrius melodus"           
[211] "Charadrius vociferus"          "Chordeiles minor"             
[213] "Cistothorus palustris"         "Cistothorus platensis"        
[215] "Coccyzus americanus"           "Coccyzus erythropthalmus"     
[217] "Colaptes auratus"              "Colinus virginianus"          
[219] "Contopus cooperi"              "Contopus virens"              
[221] "Corvus brachyrhynchos"         "Corvus ossifragus"            
[223] "Cyanocitta cristata"           "Dolichonyx oryzivorus"        
[225] "Dumetella carolinensis"        "Egretta caerulea"             
[227] "Egretta thula"                 "Egretta tricolor"             
[229] "Empidonax alnorum"             "Empidonax flaviventris"       
[231] "Empidonax minimus"             "Empidonax traillii"           
[233] "Empidonax virescens"           "Eremophila alpestris"         
[235] "Euphagus carolinus"            "Falco sparverius"             
[237] "Fulica americana"              "Gallinago delicata"           
[239] "Gavia immer"                   "Gelochelidon nilotica"        
[241] "Geothlypis trichas"            "Haematopus palliatus"         
[243] "Haliaeetus leucocephalus"      "Helmitheros vermivorum"       
[245] "Hylocichla mustelina"          "Icteria virens"               
[247] "Icterus galbula"               "Icterus spurius"              
[249] "Ixobrychus exilis"             "Junco hyemalis"               
[251] "Lanius ludovicianus"           "Larus argentatus"             
[253] "Larus delawarensis"            "Larus marinus"                
[255] "Laterallus jamaicensis"        "Lophodytes cucullatus"        
[257] "Loxia leucoptera"              "Megaceryle alcyon"            
[259] "Megascops asio"                "Melanerpes carolinus"         
[261] "Melanerpes erythrocephalus"    "Meleagris gallopavo"          
[263] "Melospiza georgiana"           "Melospiza lincolnii"          
[265] "Melospiza melodia"             "Mergus serrator"              
[267] "Mimus polyglottos"             "Mniotilta varia"              
[269] "Molothrus ater"                "Myiarchus crinitus"           
[271] "Myiopsitta monachus"           "Nyctanassa violacea"          
[273] "Oxyura jamaicensis"            "Pandion haliaetus"            
[275] "Passerculus sandwichensis"     "Passerina caerulea"           
[277] "Passerina cyanea"              "Perisoreus canadensis"        
[279] "Petrochelidon pyrrhonota"      "Pheucticus ludovicianus"      
[281] "Picoides arcticus"             "Pipilo erythrophthalmus"      
[283] "Piranga olivacea"              "Piranga rubra"                
[285] "Plegadis falcinellus"          "Podilymbus podiceps"          
[287] "Poecile atricapillus"          "Poecile hudsonicus"           
[289] "Polioptila caerulea"           "Pooecetes gramineus"          
[291] "Porzana carolina"              "Progne subis"                 
[293] "Protonotaria citrea"           "Quiscalus major"              
[295] "Quiscalus quiscula"            "Rallus elegans"               
[297] "Rallus limicola"               "Rallus longirostris"          
[299] "Regulus satrapa"               "Rynchops niger"               
[301] "Sayornis phoebe"               "Scolopax minor"               
[303] "Seiurus aurocapilla"           "Setophaga ruticilla"          
[305] "Sialia sialis"                 "Sitta canadensis"             
[307] "Sitta carolinensis"            "Sphyrapicus varius"           
[309] "Spinus pinus"                  "Spinus tristis"               
[311] "Spiza americana"               "Spizella pallida"             
[313] "Spizella passerina"            "Spizella pusilla"             
[315] "Stelgidopteryx serripennis"    "Sterna dougallii"             
[317] "Sterna forsteri"               "Sternula antillarum"          
[319] "Strix varia"                   "Sturnella magna"              
[321] "Sturnella neglecta"            "Tachycineta bicolor"          
[323] "Thryothorus ludovicianus"      "Toxostoma rufum"              
[325] "Tringa semipalmata"            "Troglodytes aedon"            
[327] "Turdus migratorius"            "Tyrannus tyrannus"            
[329] "Vermivora chrysoptera"         "Vireo flavifrons"             
[331] "Vireo gilvus"                  "Vireo griseus"                
[333] "Vireo olivaceus"               "Vireo philadelphicus"         
[335] "Vireo solitarius"              "Zenaida macroura"             
[337] "Zonotrichia albicollis"        "Accipiter gularis"            
[339] "Acrocephalus bistrigiceps"     "Acrocephalus orientalis"      
[341] "Agropsar philippensis"         "Aix galericulata"             
[343] "Amaurornis phoenicurus"        "Anas zonorhyncha"             
[345] "Anous stolidus"                "Anthus hodgsoni"              
[347] "Apalopteron familiare"         "Apus nipalensis"              
[349] "Apus pacificus"                "Bambusicola thoracicus"       
[351] "Butastur indicus"              "Butorides striata"            
[353] "Calonectris leucomelas"        "Caprimulgus indicus"          
[355] "Cepphus carbo"                 "Cerorhinca monocerata"        
[357] "Chalcophaps indica"            "Charadrius alexandrinus"      
[359] "Charadrius placidus"           "Chloris sinica"               
[361] "Cinclus pallasii"              "Circus spilonotus"            
[363] "Cisticola juncidis"            "Columba janthina"             
[365] "Corvus macrorhynchos"          "Cuculus micropterus"          
[367] "Cuculus optatus"               "Cuculus poliocephalus"        
[369] "Cyanopica cyanus"              "Cyanoptila cyanomelana"       
[371] "Delichon dasypus"              "Egretta sacra"                
[373] "Emberiza cioides"              "Emberiza fucata"              
[375] "Emberiza spodocephala"         "Emberiza sulphurata"          
[377] "Emberiza variabilis"           "Emberiza yessoensis"          
[379] "Eophona personata"             "Eurystomus orientalis"        
[381] "Ficedula narcissina"           "Gallinago hardwickii"         
[383] "Garrulax canorus"              "Garrulus lidthi"              
[385] "Glareola maldivarum"           "Gorsachius goisagi"           
[387] "Grus japonensis"               "Halcyon coromanda"            
[389] "Hierococcyx hyperythrus"       "Hirundapus caudacutus"        
[391] "Hirundo tahitica"              "Histrionicus histrionicus"    
[393] "Hypsipetes amaurotis"          "Ixobrychus cinnamomeus"       
[395] "Ixobrychus sinensis"           "Lagopus muta"                 
[397] "Lanius bucephalus"             "Lanius cristatus"             
[399] "Lanius tigrinus"               "Larus crassirostris"          
[401] "Larus schistisagus"            "Leiothrix lutea"              
[403] "Locustella lanceolata"         "Lonchura punctulata"          
[405] "Megaceryle lugubris"           "Monticola solitarius"         
[407] "Motacilla grandis"             "Muscicapa dauurica"           
[409] "Muscicapa sibirica"            "Ninox scutulata"              
[411] "Nisaetus nipalensis"           "Otus elegans"                 
[413] "Otus lempiji"                  "Otus sunia"                   
[415] "Pericrocotus divaricatus"      "Periparus ater"               
[417] "Pernis ptilorhynchus"          "Phalacrocorax capillatus"     
[419] "Phoenicurus auroreus"          "Phylloscopus borealoides"     
[421] "Phylloscopus coronatus"        "Phylloscopus ijimae"          
[423] "Phylloscopus xanthodryas"      "Picus awokera"                
[425] "Pinicola enucleator"           "Pitta nympha"                 
[427] "Poecile montanus"              "Poecile palustris"            
[429] "Prunella rubida"               "Pycnonotus sinensis"          
[431] "Rallina eurizonoides"          "Rostratula benghalensis"      
[433] "Saxicola torquatus"            "Spilornis cheela"             
[435] "Spodiopsar cineraceus"         "Sterna sumatrana"             
[437] "Streptopelia orientalis"       "Sula leucogaster"             
[439] "Syrmaticus soemmerringii"      "Tarsiger cyanurus"            
[441] "Terpsiphone atrocaudata"       "Tetrastes bonasia"            
[443] "Treron formosae"               "Treron sieboldii"             
[445] "Turdus cardis"                 "Turdus celaenops"             
[447] "Turdus chrysolaus"             "Turdus pallidus"              
[449] "Turnix suscitator"             "Urosphena squameiceps"        
[451] "Vanellus cinereus"             "Zoothera dauma"               
[453] "Zosterops japonicus"           "Acanthis flammea"             
[455] "Accipiter brevipes"            "Acridotheres cristatellus"    
[457] "Acrocephalus agricola"         "Acrocephalus dumetorum"       
[459] "Acrocephalus melanopogon"      "Acrocephalus paludicola"      
[461] "Aegypius monachus"             "Alauda leucoptera"            
[463] "Alaudala rufescens"            "Alca torda"                   
[465] "Alectoris barbara"             "Alectoris chukar"             
[467] "Alectoris graeca"              "Alectoris rufa"               
[469] "Alle alle"                     "Alopochen aegyptiaca"         
[471] "Amandava amandava"             "Anser albifrons"              
[473] "Anser brachyrhynchus"          "Anser erythropus"             
[475] "Anser fabalis"                 "Anthropoides virgo"           
[477] "Anthus berthelotii"            "Anthus cervinus"              
[479] "Anthus petrosus"               "Apus caffer"                  
[481] "Apus pallidus"                 "Apus unicolor"                
[483] "Aquila adalberti"              "Aquila fasciata"              
[485] "Aquila heliaca"                "Aquila nipalensis"            
[487] "Ardeola ralloides"             "Arenaria interpres"           
[489] "Aythya marila"                 "Bombycilla garrulus"          
[491] "Branta bernicla"               "Branta leucopsis"             
[493] "Bubo scandiacus"               "Bucanetes githagineus"        
[495] "Bucanetes mongolicus"          "Bucephala islandica"          
[497] "Bulweria bulwerii"             "Burhinus oedicnemus"          
[499] "Buteo lagopus"                 "Buteo rufinus"                
[501] "Calandrella brachydactyla"     "Calcarius lapponicus"         
[503] "Calidris alba"                 "Calidris alpina"              
[505] "Calidris canutus"              "Calidris falcinellus"         
[507] "Calidris maritima"             "Calidris melanotos"           
[509] "Calidris minuta"               "Calidris pugnax"              
[511] "Calidris temminckii"           "Calliope calliope"            
[513] "Callipepla californica"        "Calonectris borealis"         
[515] "Calonectris diomedea"          "Caprimulgus ruficollis"       
[517] "Carduelis citrinella"          "Carduelis corsicana"          
[519] "Carpodacus rubicilla"          "Catharacta skua"              
[521] "Cecropis daurica"              "Cepphus grylle"               
[523] "Cercotrichas galactotes"       "Cettia cetti"                 
[525] "Charadrius asiaticus"          "Charadrius hiaticula"         
[527] "Charadrius leschenaultii"      "Chersophilus duponti"         
[529] "Chlidonias hybrida"            "Chlidonias leucopterus"       
[531] "Chloris chloris"               "Chrysolophus amherstiae"      
[533] "Chrysolophus pictus"           "Circaetus gallicus"           
[535] "Circus macrourus"              "Clamator glandarius"          
[537] "Clanga clanga"                 "Clanga pomarina"              
[539] "Clangula hyemalis"             "Columba trocaz"               
[541] "Coracias garrulus"             "Cuculus saturatus"            
[543] "Cyanistes caeruleus"           "Cyanistes cyanus"             
[545] "Cyanistes teneriffae"          "Cyanopica cooki"              
[547] "Cygnus columbianus"            "Cygnus cygnus"                
[549] "Delichon urbicum"              "Dryobates minor"              
[551] "Elanus caeruleus"              "Emberiza aureola"             
[553] "Emberiza bruniceps"            "Emberiza caesia"              
[555] "Emberiza calandra"             "Emberiza cia"                 
[557] "Emberiza cineracea"            "Emberiza cirlus"              
[559] "Emberiza melanocephala"        "Emberiza pallasi"             
[561] "Emberiza pusilla"              "Emberiza rustica"             
[563] "Estrilda astrild"              "Estrilda melpoda"             
[565] "Eudromias morinellus"          "Falco biarmicus"              
[567] "Falco columbarius"             "Falco eleonorae"              
[569] "Falco naumanni"                "Falco rusticolus"             
[571] "Falco vespertinus"             "Ficedula semitorquata"        
[573] "Francolinus francolinus"       "Fratercula arctica"           
[575] "Fringilla montifringilla"      "Fulica cristata"              
[577] "Fulmarus glacialis"            "Galerida theklae"             
[579] "Gallinago media"               "Gallinago stenura"            
[581] "Gavia arctica"                 "Gavia stellata"               
[583] "Glareola nordmanni"            "Glareola pratincola"          
[585] "Gulosus aristotelis"           "Gypaetus barbatus"            
[587] "Gyps fulvus"                   "Haematopus ostralegus"        
[589] "Hieraaetus pennatus"           "Hippolais olivetorum"         
[591] "Hippolais polyglotta"          "Hydrobates castro"            
[593] "Hydrobates leucorhous"         "Hydrobates pelagicus"         
[595] "Hydrocoloeus minutus"          "Hydroprogne caspia"           
[597] "Iduna caligata"                "Iduna opaca"                  
[599] "Iduna pallida"                 "Lagopus lagopus"              
[601] "Lanius meridionalis"           "Lanius minor"                 
[603] "Lanius nubicus"                "Lanius senator"               
[605] "Larus armenicus"               "Larus audouinii"              
[607] "Larus fuscus"                  "Larus genei"                  
[609] "Larus hyperboreus"             "Larus ichthyaetus"            
[611] "Larus michahellis"             "Leiopicus medius"             
[613] "Limosa lapponica"              "Linaria cannabina"            
[615] "Linaria flavirostris"          "Lophophanes cristatus"        
[617] "Loxia pytyopsittacus"          "Loxia scotica"                
[619] "Lymnocryptes minimus"          "Lyrurus mlokosiewiczi"        
[621] "Lyrurus tetrix"                "Mareca penelope"              
[623] "Mareca strepera"               "Marmaronetta angustirostris"  
[625] "Melanitta fusca"               "Melanitta nigra"              
[627] "Melanocorypha calandra"        "Mergellus albellus"           
[629] "Merops persicus"               "Microcarbo pygmaeus"          
[631] "Monticola saxatilis"           "Montifringilla nivalis"       
[633] "Morus bassanus"                "Motacilla citreola"           
[635] "Neophron percnopterus"         "Numenius phaeopus"            
[637] "Oenanthe deserti"              "Oenanthe finschii"            
[639] "Oenanthe hispanica"            "Oenanthe isabellina"          
[641] "Oenanthe leucura"              "Oenanthe pleschanka"          
[643] "Onychoprion fuscatus"          "Otis tarda"                   
[645] "Oxyura leucocephala"           "Pagophila eburnea"            
[647] "Passer hispaniolensis"         "Passer italiae"               
[649] "Pastor roseus"                 "Pelagodroma marina"           
[651] "Pelecanus crispus"             "Pelecanus onocrotalus"        
[653] "Perisoreus infaustus"          "Petronia petronia"            
[655] "Phalaropus fulicarius"         "Phalaropus lobatus"           
[657] "Phoenicopterus roseus"         "Phylloscopus bonelli"         
[659] "Phylloscopus borealis"         "Phylloscopus ibericus"        
[661] "Phylloscopus inornatus"        "Phylloscopus nitidus"         
[663] "Phylloscopus orientalis"       "Phylloscopus sindianus"       
[665] "Picus sharpei"                 "Plectrophenax nivalis"        
[667] "Pluvialis apricaria"           "Pluvialis squatarola"         
[669] "Podiceps auritus"              "Poecile cinctus"              
[671] "Poecile lugubris"              "Polysticta stelleri"          
[673] "Porphyrio porphyrio"           "Prunella atrogularis"         
[675] "Prunella montanella"           "Pterocles alchata"            
[677] "Pterocles orientalis"          "Pterodroma deserta"           
[679] "Pterodroma madeira"            "Ptyonoprogne rupestris"       
[681] "Puffinus lherminieri"          "Puffinus mauretanicus"        
[683] "Puffinus puffinus"             "Puffinus yelkouan"            
[685] "Pyrrhocorax graculus"          "Pyrrhocorax pyrrhocorax"      
[687] "Pyrrhula murina"               "Regulus ignicapilla"          
[689] "Regulus madeirensis"           "Rissa tridactyla"             
[691] "Serinus canaria"               "Serinus pusillus"             
[693] "Sitta krueperi"                "Sitta neumayer"               
[695] "Sitta whiteheadi"              "Somateria mollissima"         
[697] "Somateria spectabilis"         "Spatula clypeata"             
[699] "Spatula querquedula"           "Spilopelia senegalensis"      
[701] "Spinus spinus"                 "Stercorarius longicaudus"     
[703] "Stercorarius parasiticus"      "Stercorarius pomarinus"       
[705] "Sterna paradisaea"             "Sternula albifrons"           
[707] "Strix nebulosa"                "Sturnus unicolor"             
[709] "Surnia ulula"                  "Syrmaticus reevesii"          
[711] "Tachymarptis melba"            "Tadorna ferruginea"           
[713] "Tadorna tadorna"               "Tetraogallus caspius"         
[715] "Tetraogallus caucasicus"       "Tetrax tetrax"                
[717] "Thalasseus sandvicensis"       "Tichodroma muraria"           
[719] "Tringa erythropus"             "Tringa glareola"              
[721] "Tringa nebularia"              "Tringa stagnatilis"           
[723] "Turdus atrogularis"            "Uria aalge"                   
[725] "Uria lomvia"                   "Vanellus gregarius"           
[727] "Vanellus leucurus"             "Vanellus spinosus"            
[729] "Xema sabini"                   "Xenus cinereus"               
[731] "Zapornia parva"                "Zapornia pusilla"             
[733] "Zoothera aurea"                "Ammospiza caudacuta"          
[735] "Passerculus henslowii"         "Mareca americana"             
[737] "Spatula discors"               "Antrostomus carolinensis"     
[739] "Antrostomus vociferus"         "Haemorhous mexicanus"         
[741] "Haemorhous purpureus"          "Setophaga caerulescens"       
[743] "Setophaga castanea"            "Setophaga cerulea"            
[745] "Setophaga coronata"            "Setophaga discolor"           
[747] "Setophaga dominica"            "Setophaga fusca"              
[749] "Setophaga magnolia"            "Setophaga palmarum"           
[751] "Setophaga pensylvanica"        "Setophaga petechia"           
[753] "Setophaga pinus"               "Setophaga striata"            
[755] "Setophaga tigrina"             "Setophaga virens"             
[757] "Hylatomus pileatus"            "Larus atricilla"              
[759] "Setophaga americana"           "Nannopterum auritus"          
[761] "Dryobates pubescens"           "Leuconotopicus villosus"      
[763] "Parkesia noveboracensis"       "Parkesia motacilla"           
[765] "Leiothlypis peregrina"         "Vermivora cyanoptera"         
[767] "Leiothlypis ruficapilla"       "Cardellina canadensis"        
[769] "Setophaga citrina"             "Cardellina pusilla"           
[771] "Mareca falcata"                "Horornis diphone"             
[773] "Picoides kizuki"               "Helopsaltes fasciolatus"      
[775] "Helopsaltes ochotensis"        "Helopsaltes pleskei"          
[777] "Larvivora cyane"               "Urile pelagicus"              
[779] "Zapornia fusca"                "Dendrocopos noguchii"         
[781] "Carpodacus sibiricus"          "Geokichla sibirica"           
[783] "Alexandrinus krameri"          "Curruca communis"             
[785] "Curruca curruca"               "Curruca nisoria"              
[787] "Ammospiza maritima"            "Hesperiphona vespertina"      
[789] "Canachites canadensis"         "Geothlypis formosa"           
[791] "Geothlypis philadelphia"       "Picoides dorsalis"            
[793] "Corthylio calendula"           "Ardea intermedia"             
[795] "Hypotaenidia okinawae"         "Helopsaltes pryeri"           
[797] "Larvivora akahige"             "Larvivora komadori"           
[799] "Parus minor"                   "Passer cinnamomeus"           
[801] "Sittiparus varius"             "Curruca balearica"            
[803] "Curruca cantillans"            "Curruca conspicillata"        
[805] "Curruca crassirostris"         "Curruca hortensis"            
[807] "Curruca melanocephala"         "Curruca mystacea"             
[809] "Curruca ruppeli"               "Curruca sarda"                
[811] "Curruca subalpina"             "Curruca undata"               </code></pre>
</div>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Save Output:</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>Atlas_merged4 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(ScientificName <span class="sc">%in%</span> dups) <span class="sc">%&gt;%</span> <span class="fu">write.csv</span>(<span class="st">"../../Documents/documentation_methods/SynonymsAtlasData.csv"</span>)</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(Atlas_merged4, <span class="st">"../../out/csv/full_BirdLife2018_TaxonomicLookup.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="get-rl-status-from-birdlife" class="level3" data-number="3.1.2">
<h3 data-number="3.1.2" class="anchored" data-anchor-id="get-rl-status-from-birdlife"><span class="header-section-number">3.1.2</span> Get RL Status from BirdLife</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>RedListCat <span class="ot">&lt;-</span> Tax <span class="sc">%&gt;%</span> <span class="fu">filter</span>(ScientificName <span class="sc">%in%</span> Tax_LookUp<span class="sc">$</span>ScientificName) <span class="sc">%&gt;%</span> <span class="fu">select</span>(ScientificName, RL_Category) <span class="sc">%&gt;%</span> <span class="fu">left_join</span>(Tax_LookUp) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>ScientificName)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(ScientificName)`</code></pre>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(RedListCat<span class="sc">$</span>AtlasSp) <span class="sc">%&gt;%</span> <span class="fu">length</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 839</code></pre>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">is.na</span>(RedListCat))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>RL_Category     AtlasSp 
          0           0 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(RedListCat, <span class="st">"../../out/predictors/RedListCatBL.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="rasterize-birdlife-rangemaps" class="level3" data-number="3.1.3">
<h3 data-number="3.1.3" class="anchored" data-anchor-id="rasterize-birdlife-rangemaps"><span class="header-section-number">3.1.3</span> Rasterize BirdLife rangemaps</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># save Bird Life rangemaps as rds which is faster to read in:</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="co"># All_sp &lt;- st_read(fgdb, layer = "All_Species") </span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a><span class="co"># saveRDS(All_sp, "out/rds/BOTW_All_species.rds") </span></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Read &amp; Filter BirdLife International (all Birds) =======================================</span></span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>tictoc<span class="sc">::</span><span class="fu">tic</span>()</span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>All_sp <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"out/rds/BOTW_All_species.rds"</span>) <span class="co"># takes ca. 1.5 min to read in</span></span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>tictoc<span class="sc">::</span><span class="fu">toc</span>()</span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a>BirdLife <span class="ot">&lt;-</span> All_sp <span class="sc">%&gt;%</span> </span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(sci_name <span class="sc">%in%</span> name_vector) <span class="sc">%&gt;%</span> </span>
<span id="cb65-13"><a href="#cb65-13" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(sci_name, presence, origin, seasonal, Shape_Length, Shape_Area, Shape) <span class="sc">%&gt;%</span></span>
<span id="cb65-14"><a href="#cb65-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(seasonal <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>) <span class="sc">&amp;</span> <span class="co"># Resident &amp; Breeding Season (not non-breeding or passage)</span></span>
<span id="cb65-15"><a href="#cb65-15" aria-hidden="true" tabindex="-1"></a>           origin <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>) <span class="sc">&amp;</span> <span class="co"># Native or reintroduced (not introduced or vagrant)</span></span>
<span id="cb65-16"><a href="#cb65-16" aria-hidden="true" tabindex="-1"></a>           presence <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>))  <span class="co"># Extant, probably extant, possibly extant (not possibly extinct or extinct)</span></span>
<span id="cb65-17"><a href="#cb65-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-18"><a href="#cb65-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Save Reduced Version as Shapefile (takes a while)</span></span>
<span id="cb65-19"><a href="#cb65-19" aria-hidden="true" tabindex="-1"></a> <span class="fu">st_write</span>(BirdLife, <span class="st">"out/shp/BirdLife_810sp.shp"</span>, <span class="at">append=</span>F)</span>
<span id="cb65-20"><a href="#cb65-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-21"><a href="#cb65-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Rasterize species range polygons  ======================================================</span></span>
<span id="cb65-22"><a href="#cb65-22" aria-hidden="true" tabindex="-1"></a>tictoc<span class="sc">::</span><span class="fu">tic</span>() <span class="do">## Takes about 18 minutes on my local machine</span></span>
<span id="cb65-23"><a href="#cb65-23" aria-hidden="true" tabindex="-1"></a>r_birds <span class="ot">&lt;-</span> <span class="fu">rasterizeRange</span>(<span class="at">dsn=</span> <span class="st">"out/shp/BirdLife_810sp.shp"</span>,</span>
<span id="cb65-24"><a href="#cb65-24" aria-hidden="true" tabindex="-1"></a>                          <span class="at">id=</span><span class="st">"sci_nam"</span>, <span class="at">touches=</span><span class="cn">TRUE</span>, <span class="at">save =</span> <span class="cn">TRUE</span>, <span class="at">resolution =</span> <span class="dv">1</span>,</span>
<span id="cb65-25"><a href="#cb65-25" aria-hidden="true" tabindex="-1"></a>                          <span class="at">path =</span> <span class="st">"data/species_rasters/"</span>)</span>
<span id="cb65-26"><a href="#cb65-26" aria-hidden="true" tabindex="-1"></a>tictoc<span class="sc">::</span><span class="fu">toc</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="calculate-global-range-size" class="level3" data-number="3.1.4">
<h3 data-number="3.1.4" class="anchored" data-anchor-id="calculate-global-range-size"><span class="header-section-number">3.1.4</span> Calculate Global Range Size</h3>
<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Quote from st_area() function:
</div>
</div>
<div class="callout-body-container callout-body">
<p>if ‘sf_use_s2()’ is ‘FALSE’, ellipsoidal distances are computed using st_geod_distance which uses function ‘geod_inverse’ from GeographicLib (part of PROJ); see Karney, Charles FF, 2013, Algorithms for geodesics, Journal of Geodesy 87(1), 43-55</p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>tictoc<span class="sc">::</span><span class="fu">tic</span>()</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Requires BirdLife object from above</span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate global range size for each species ## Takes about 11:07 - </span></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>sp <span class="ot">&lt;-</span> <span class="fu">unique</span>(BirdLife<span class="sc">$</span>sci_name)</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>RangeSizeList <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (s <span class="cf">in</span> <span class="fu">seq_along</span>(sp)){</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>  temp <span class="ot">&lt;-</span> BirdLife <span class="sc">%&gt;%</span> <span class="fu">filter</span>(sci_name <span class="sc">==</span> sp[s]) <span class="sc">%&gt;%</span> <span class="fu">select</span>(sci_name)</span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>  temp<span class="sc">$</span>GlobRangeSize_m2 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">st_area</span>(temp))</span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>  temp<span class="sc">$</span>GlobRangeSize_km2 <span class="ot">&lt;-</span> temp<span class="sc">$</span>GlobRangeSize_m2<span class="sc">/</span><span class="dv">1000</span></span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>  temp2 <span class="ot">&lt;-</span> temp <span class="sc">%&gt;%</span> <span class="fu">st_drop_geometry</span>()</span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a>  temp2 <span class="ot">&lt;-</span> temp2 <span class="sc">%&gt;%</span> </span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(sci_name) <span class="sc">%&gt;%</span> </span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">GlobRangeSize_m2 =</span> <span class="fu">case_when</span>(</span>
<span id="cb66-16"><a href="#cb66-16" aria-hidden="true" tabindex="-1"></a>        <span class="fu">nrow</span>(temp2) <span class="sc">&gt;</span> <span class="dv">1</span> <span class="sc">~</span> <span class="fu">sum</span>(GlobRangeSize_m2),</span>
<span id="cb66-17"><a href="#cb66-17" aria-hidden="true" tabindex="-1"></a>        <span class="fu">nrow</span>(temp) <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> GlobRangeSize_m2),</span>
<span id="cb66-18"><a href="#cb66-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">GlobRangeSize_km2 =</span> <span class="fu">case_when</span>(</span>
<span id="cb66-19"><a href="#cb66-19" aria-hidden="true" tabindex="-1"></a>        <span class="fu">nrow</span>(temp2) <span class="sc">&gt;</span> <span class="dv">1</span> <span class="sc">~</span> <span class="fu">sum</span>(GlobRangeSize_km2),</span>
<span id="cb66-20"><a href="#cb66-20" aria-hidden="true" tabindex="-1"></a>        <span class="fu">nrow</span>(temp) <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> GlobRangeSize_km2))</span>
<span id="cb66-21"><a href="#cb66-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb66-22"><a href="#cb66-22" aria-hidden="true" tabindex="-1"></a>  RangeSizeList[[s]] <span class="ot">&lt;-</span> temp2[<span class="dv">1</span>,]</span>
<span id="cb66-23"><a href="#cb66-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb66-24"><a href="#cb66-24" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb66-25"><a href="#cb66-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-26"><a href="#cb66-26" aria-hidden="true" tabindex="-1"></a>RangeSizeBOTW <span class="ot">&lt;-</span> plyr<span class="sc">::</span><span class="fu">rbind.fill</span>(RangeSizeList) <span class="sc">%&gt;%</span> </span>
<span id="cb66-27"><a href="#cb66-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"ScientificName"</span> <span class="ot">=</span> <span class="st">"sci_name"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb66-28"><a href="#cb66-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(Tax_LookUp) <span class="sc">%&gt;%</span> </span>
<span id="cb66-29"><a href="#cb66-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>ScientificName)</span>
<span id="cb66-30"><a href="#cb66-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-31"><a href="#cb66-31" aria-hidden="true" tabindex="-1"></a>RangeSizeBOTW<span class="sc">$</span>GlobRangeSize_km2 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(RangeSizeBOTW<span class="sc">$</span>GlobRangeSize_km2 )</span>
<span id="cb66-32"><a href="#cb66-32" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(RangeSizeBOTW)</span>
<span id="cb66-33"><a href="#cb66-33" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(RangeSizeBOTW<span class="sc">$</span>AtlasSp) <span class="sc">%&gt;%</span> <span class="fu">length</span>()</span>
<span id="cb66-34"><a href="#cb66-34" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">is.na</span>(RangeSizeBOTW))</span>
<span id="cb66-35"><a href="#cb66-35" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(RangeSizeBOTW, <span class="st">"../../out/predictors/RangeSizeBOTW_df.rds"</span>)</span>
<span id="cb66-36"><a href="#cb66-36" aria-hidden="true" tabindex="-1"></a>tictoc<span class="sc">::</span><span class="fu">toc</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Read bird shapefiles back in ===========================================================</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>sp_v <span class="ot">&lt;-</span> stringr<span class="sc">::</span><span class="fu">str_split_i</span>(<span class="fu">list.files</span>(<span class="st">"../../data/species_rasters/"</span>), </span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">pattern =</span> <span class="st">".tif"</span>, <span class="dv">1</span>)</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>sp_v <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"_1"</span>, <span class="st">""</span>, sp_v) <span class="co"># remove 1 (1 degree resolution)</span></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>sp_v <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"_"</span>, <span class="st">" "</span>, sp_v)</span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>r_birds <span class="ot">&lt;-</span> <span class="fu">rast</span>(<span class="fu">paste0</span>(<span class="st">"../../data/species_rasters/"</span>, <span class="fu">list.files</span>(<span class="st">"../../data/species_rasters/"</span>, <span class="at">pattern =</span><span class="st">".tif"</span>)))</span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(r_birds) <span class="ot">&lt;-</span> sp_v</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="climate-data" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="climate-data"><span class="header-section-number">3.2</span> Climate Data</h2>
<section id="aggregate-chelsa-to-1-resolution" class="level3" data-number="3.2.1">
<h3 data-number="3.2.1" class="anchored" data-anchor-id="aggregate-chelsa-to-1-resolution"><span class="header-section-number">3.2.1</span> Aggregate CHELSA to 1° resolution</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># read shapefiles:</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>climate_stack <span class="ot">&lt;-</span> <span class="fu">rast</span>(<span class="fu">paste0</span>(CHELSA_path, tif_files))</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Aggregate to 1 degree cells</span></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>target_resolution <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">120</span>)  <span class="co"># Factor 120 to get from  0.008333° to 1° (110km)</span></span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate the raster stack to the target resolution</span></span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>climate_stack_agg <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(climate_stack, <span class="do">## This takes ca. 4 minutes on my local machine</span></span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>                               <span class="at">fact =</span> target_resolution, </span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>                               <span class="at">fun =</span> mean,</span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>                               <span class="at">na.rm=</span>T)</span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(climate_stack_agg, <span class="st">"../../out/rds/ClimateStack.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="extract-bird-coordinates" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="extract-bird-coordinates"><span class="header-section-number">3.3</span> Extract Bird Coordinates</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>climate_stack_agg <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"../../out/rds/ClimateStack.rds"</span>)</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(climate_stack_agg) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"MAT"</span>, <span class="st">"AnnualPrec"</span>, <span class="st">"PrecWettestMonth"</span>, <span class="st">"PrecDriestMonth"</span>, <span class="st">"PrecSeas"</span>, <span class="st">"MeanDiurnalTempRange"</span>, <span class="st">"Isotherm"</span>, <span class="st">"TempSeas"</span>, <span class="st">"MeanDailyTempWarmestMonth"</span>, <span class="st">"MeanDailyTempColdestMonth"</span>, <span class="st">"AnnualTempRange"</span>)</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract species coordinates ===========================================================</span></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a><span class="fu">try</span>({</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>coords_sp <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">seq_along</span>(sp_v)){</span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>  r_b <span class="ot">&lt;-</span> r_birds[[i]]</span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Match resolution, extent, and projection of climate raster to species raster</span></span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a>  r_b_matched <span class="ot">&lt;-</span> <span class="fu">project</span>(r_b, climate_stack_agg,  <span class="at">method =</span> <span class="st">"average"</span>)</span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true" tabindex="-1"></a>  r_b2 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(r_b_matched, <span class="at">xy=</span>T)</span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true" tabindex="-1"></a>  r_b2<span class="sc">$</span>species <span class="ot">&lt;-</span> sp_v[i]</span>
<span id="cb69-15"><a href="#cb69-15" aria-hidden="true" tabindex="-1"></a>  r_b3 <span class="ot">&lt;-</span> r_b2 <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="st">"Presence"</span> <span class="ot">=</span> sp_v[i])</span>
<span id="cb69-16"><a href="#cb69-16" aria-hidden="true" tabindex="-1"></a>  coords_sp[[i]] <span class="ot">&lt;-</span> r_b3</span>
<span id="cb69-17"><a href="#cb69-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb69-18"><a href="#cb69-18" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb69-19"><a href="#cb69-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-20"><a href="#cb69-20" aria-hidden="true" tabindex="-1"></a>coords_df <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind,coords_sp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="climate-pca" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="climate-pca"><span class="header-section-number">3.4</span> Climate PCA</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Run PCA to build climate space</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>pca_res <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(climate_stack_agg, <span class="at">scale. =</span> T)</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pca_res)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Importance of components:
                          PC1    PC2    PC3     PC4     PC5    PC6     PC7
Standard deviation     2.3815 1.5551 1.1556 0.81672 0.77489 0.4034 0.35827
Proportion of Variance 0.5156 0.2198 0.1214 0.06064 0.05459 0.0148 0.01167
Cumulative Proportion  0.5156 0.7354 0.8568 0.91748 0.97206 0.9869 0.99853
                           PC8     PC9    PC10      PC11
Standard deviation     0.11211 0.04513 0.03968 1.065e-13
Proportion of Variance 0.00114 0.00019 0.00014 0.000e+00
Cumulative Proportion  0.99967 0.99986 1.00000 1.000e+00</code></pre>
</div>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># extract loadings from PCA for documentation</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>pca_res<span class="sc">$</span>rotation <span class="sc">%&gt;%</span> <span class="fu">write.csv</span>(<span class="st">"../../Documents/documentation_methods/PCA_loadings_climNiche.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="project-birds-to-climmate-space" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Project Birds to climmate space</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop through species to extract climate values  ======================================</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>sp_v <span class="ot">&lt;-</span> <span class="fu">unique</span>(coords_df<span class="sc">$</span>species)</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>clim_vals_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>pca_all <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(sp_v)){</span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>  sp <span class="ot">&lt;-</span> coords_df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(species <span class="sc">==</span> sp_v[i]) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>species, <span class="sc">-</span>Presence)</span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>  clim_vals <span class="ot">&lt;-</span> <span class="fu">extract</span>(climate_stack_agg, sp, <span class="at">xy=</span>T, <span class="at">df=</span>T) <span class="sc">%&gt;%</span> <span class="fu">data.frame</span>()</span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a>  clim_vals<span class="sc">$</span>species <span class="ot">=</span> sp_v[i]</span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a>  clim_vals_list[[i]] <span class="ot">&lt;-</span> clim_vals</span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># PCA predictions:  ===========================================================</span></span>
<span id="cb73-13"><a href="#cb73-13" aria-hidden="true" tabindex="-1"></a>  sp_pca <span class="ot">&lt;-</span> <span class="fu">predict</span>(pca_res, clim_vals[,<span class="dv">2</span><span class="sc">:</span><span class="dv">14</span>])[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>] <span class="sc">%&gt;%</span> <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">species =</span> sp_v[i])</span>
<span id="cb73-14"><a href="#cb73-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-15"><a href="#cb73-15" aria-hidden="true" tabindex="-1"></a>  pca_all[[i]] <span class="ot">&lt;-</span> sp_pca</span>
<span id="cb73-16"><a href="#cb73-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb73-17"><a href="#cb73-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb73-18"><a href="#cb73-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-19"><a href="#cb73-19" aria-hidden="true" tabindex="-1"></a>clim_vals_all <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, clim_vals_list) </span>
<span id="cb73-20"><a href="#cb73-20" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">is.na</span>(clim_vals_all))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                       ID                       MAT                AnnualPrec 
                        0                         0                         0 
         PrecWettestMonth           PrecDriestMonth                  PrecSeas 
                        0                         0                         0 
     MeanDiurnalTempRange                  Isotherm                  TempSeas 
                        0                         0                         0 
MeanDailyTempWarmestMonth MeanDailyTempColdestMonth           AnnualTempRange 
                        0                         0                         0 
                        x                         y                   species 
                        0                         0                         0 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(pca_all, <span class="st">"../../out/rds/pca_all.rds"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="plot-birds-in-climate-space" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="plot-birds-in-climate-space"><span class="header-section-number">4.1</span> Plot Birds in Climate Space</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot Climate Space for a couple of species # </span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2); <span class="fu">library</span>(ggfortify)</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span>PC1, <span class="at">y=</span>PC2), <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">data=</span> pca_res)<span class="sc">+</span></span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span>PC1, <span class="at">y=</span>PC2), <span class="at">col =</span> <span class="st">"#fde725"</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">data =</span> pca_all[[<span class="dv">1</span>]])<span class="sc">+</span></span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span>PC1, <span class="at">y=</span>PC2), <span class="at">col =</span> <span class="st">"#5ec962"</span>, <span class="at">alpha =</span> <span class="fl">0.4</span>, <span class="at">data =</span> pca_all[[<span class="dv">2</span>]])<span class="sc">+</span></span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span>PC1, <span class="at">y=</span>PC2), <span class="at">col =</span> <span class="st">"#21918c"</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>, <span class="at">data =</span> pca_all[[<span class="dv">3</span>]])<span class="sc">+</span></span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span>PC1, <span class="at">y=</span>PC2), <span class="at">col =</span> <span class="st">"#3b528b"</span>, <span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">data =</span> pca_all[[<span class="dv">4</span>]])<span class="sc">+</span></span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span>PC1, <span class="at">y=</span>PC2), <span class="at">col =</span> <span class="st">"#440154"</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>, <span class="at">data =</span> pca_all[[<span class="dv">5</span>]])<span class="sc">+</span></span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="3d_ClimateNicheBreadth_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"../../out/figures/BirdsClimateSpace.pdf"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
</div>
</section>
</section>
<section id="calculate-niche-breadth" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Calculate Niche Breadth</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>pca_all <span class="ot">&lt;-</span>  <span class="fu">readRDS</span>(<span class="st">"../../out/rds/pca_all.rds"</span>) <span class="co"># Predicted values in PCA for species</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>all_niches <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate niche breadth</span></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(pca_all)){</span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>  niche_breadth2 <span class="ot">&lt;-</span> <span class="fu">apply</span>(pca_all[[i]][,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="dv">2</span>, sd, <span class="at">na.rm=</span>T) </span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create a data frame with species and corresponding variance and standard deviation</span></span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a>  niche_breadth <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">species =</span> <span class="fu">unique</span>(pca_all[[i]]<span class="sc">$</span>species),</span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd_PC1 =</span> niche_breadth2[<span class="dv">1</span>],</span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd_PC2 =</span> niche_breadth2[<span class="dv">2</span>])</span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a>  all_niches[[i]] <span class="ot">&lt;-</span> niche_breadth</span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb79-13"><a href="#cb79-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-14"><a href="#cb79-14" aria-hidden="true" tabindex="-1"></a>Niches_df <span class="ot">&lt;-</span> plyr<span class="sc">::</span><span class="fu">rbind.fill</span>(all_niches)[,<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>] <span class="sc">%&gt;%</span> </span>
<span id="cb79-15"><a href="#cb79-15" aria-hidden="true" tabindex="-1"></a><span class="fu">rename</span>(<span class="st">"ScientificName"</span> <span class="ot">=</span> <span class="st">"species"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb79-16"><a href="#cb79-16" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(<span class="at">ScientificName =</span> <span class="fu">case_when</span>(</span>
<span id="cb79-17"><a href="#cb79-17" aria-hidden="true" tabindex="-1"></a>  ScientificName <span class="sc">==</span> <span class="st">"Mo"</span> <span class="sc">~</span> <span class="st">"Montifringilla nivalis"</span>,</span>
<span id="cb79-18"><a href="#cb79-18" aria-hidden="true" tabindex="-1"></a>  ScientificName <span class="sc">==</span> <span class="st">"Fringilla mo"</span> <span class="sc">~</span> <span class="st">"Fringilla montifringilla"</span>,</span>
<span id="cb79-19"><a href="#cb79-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">.default =</span> ScientificName)) <span class="sc">%&gt;%</span> </span>
<span id="cb79-20"><a href="#cb79-20" aria-hidden="true" tabindex="-1"></a><span class="fu">left_join</span>(Tax_LookUp) <span class="sc">%&gt;%</span> </span>
<span id="cb79-21"><a href="#cb79-21" aria-hidden="true" tabindex="-1"></a><span class="fu">group_by</span>(ScientificName) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(ScientificName)`</code></pre>
</div>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(Niches_df, <span class="st">"../../out/rds/Niches_df.rds"</span>)</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">is.na</span>(Niches_df))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ScientificName         sd_PC1         sd_PC2        AtlasSp 
             0              0              0              0 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Niches_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
# Groups:   ScientificName [5]
  ScientificName     sd_PC1 sd_PC2 AtlasSp           
  &lt;chr&gt;               &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;             
1 Acanthis flammea    1.23   0.976 Acanthis flammea  
2 Acanthis flammea    1.23   0.976 Carduelis flammea 
3 Accipiter brevipes  0.658  1.01  Accipiter brevipes
4 Accipiter cooperii  0.949  1.01  Accipiter cooperii
5 Accipiter gentilis  1.32   1.08  Accipiter gentilis
6 Accipiter gularis   1.31   1.32  Accipiter gularis </code></pre>
</div>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>RangeSizeBOTW <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"../../out/rds/RangeSizeBOTW_df.rds"</span>)</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>BirdLife_Predictors <span class="ot">&lt;-</span> Niches_df <span class="sc">%&gt;%</span> <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>ScientificName) <span class="sc">%&gt;%</span></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(RangeSizeBOTW) <span class="sc">%&gt;%</span></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(RedListCat) <span class="sc">%&gt;%</span></span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">distinct</span>(AtlasSp, <span class="at">.keep_all =</span>T) <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="st">"verbatim_name"</span> <span class="ot">=</span> <span class="st">"AtlasSp"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(AtlasSp)`</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in left_join(., RangeSizeBOTW): Detected an unexpected many-to-many relationship between `x` and `y`.
ℹ Row 557 of `x` matches multiple rows in `y`.
ℹ Row 69 of `y` matches multiple rows in `x`.
ℹ If a many-to-many relationship is expected, set `relationship =
  "many-to-many"` to silence this warning.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(AtlasSp)`</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in left_join(., RedListCat): Detected an unexpected many-to-many relationship between `x` and `y`.
ℹ Row 557 of `x` matches multiple rows in `y`.
ℹ Row 653 of `y` matches multiple rows in `x`.
ℹ If a many-to-many relationship is expected, set `relationship =
  "many-to-many"` to silence this warning.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Data Check: </span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>BirdLife_Predictors <span class="sc">%&gt;%</span> <span class="fu">distinct</span>(verbatim_name) <span class="sc">%&gt;%</span> <span class="fu">nrow</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 839</code></pre>
</div>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">is.na</span>(BirdLife_Predictors))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           sd_PC1            sd_PC2     verbatim_name  GlobRangeSize_m2 
                0                 0                 0                 0 
GlobRangeSize_km2       RL_Category 
                0                 0 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(BirdLife_Predictors, <span class="st">"../../out/predictors/BirdLife2018_Predictors.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="plot-niche-breadth" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="plot-niche-breadth"><span class="header-section-number">5.1</span> Plot Niche Breadth</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> Niches_df, <span class="fu">aes</span>(<span class="at">x =</span> sd_PC1, <span class="at">y =</span> sd_PC2))<span class="sc">+</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> Niches_df, <span class="fu">aes</span>(<span class="at">x =</span> sd_PC1, <span class="at">y =</span> sd_PC2, <span class="at">col =</span> AtlasSp), <span class="at">show.legend =</span> F) <span class="sc">+</span></span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>()<span class="sc">+</span></span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using method = 'loess' and formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="3d_ClimateNicheBreadth_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>